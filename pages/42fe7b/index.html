<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>虚拟机栈 | 晨光向的编码之旅</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png">
    <link rel="mask-icon" href="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png" color="#3eaf7c">
    <meta name="description" content="一个基于VuePress的 知识管理&amp;博客 主题">
    <meta property="article:published_time" content="2023-02-25T14:09:08.000Z">
    <meta property="article:modified_time" content="2023-04-09T00:32:37.000Z">
    <meta property="og:site_name" content="晨光向的编程之旅">
    <meta property="og:title" content="虚拟机栈">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ts.cnlxc.cn//pages/42fe7b/">
    <meta property="og:image" content="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png">
    <meta name="twitter:title" content="虚拟机栈">
    <meta name="twitter:url" content="https://ts.cnlxc.cn//pages/42fe7b/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="keywords" content="晨光向的编程之旅,晨光向,java,mysql,nginx,redis,spring,blog">
    <meta name="theme-color" content="#11a8cd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.2603d9eb.css" as="style"><link rel="preload" href="/assets/js/app.77de9afe.js" as="script"><link rel="preload" href="/assets/js/2.7f8741fb.js" as="script"><link rel="preload" href="/assets/js/35.c6d5f3b6.js" as="script"><link rel="preload" href="/assets/js/3.7b4d6574.js" as="script"><link rel="prefetch" href="/assets/js/10.cceedcc4.js"><link rel="prefetch" href="/assets/js/100.33dbfed1.js"><link rel="prefetch" href="/assets/js/101.5d92e7e2.js"><link rel="prefetch" href="/assets/js/102.925c7eeb.js"><link rel="prefetch" href="/assets/js/103.45e062c5.js"><link rel="prefetch" href="/assets/js/104.d9eb387c.js"><link rel="prefetch" href="/assets/js/105.8cc51722.js"><link rel="prefetch" href="/assets/js/106.5fb56861.js"><link rel="prefetch" href="/assets/js/107.4fbee58b.js"><link rel="prefetch" href="/assets/js/108.a84e56f6.js"><link rel="prefetch" href="/assets/js/109.1e780252.js"><link rel="prefetch" href="/assets/js/11.be66679b.js"><link rel="prefetch" href="/assets/js/110.c0622e6b.js"><link rel="prefetch" href="/assets/js/111.681835e1.js"><link rel="prefetch" href="/assets/js/112.9e0ed42b.js"><link rel="prefetch" href="/assets/js/113.05a9e47c.js"><link rel="prefetch" href="/assets/js/114.4776d2eb.js"><link rel="prefetch" href="/assets/js/115.01b98f56.js"><link rel="prefetch" href="/assets/js/116.d0340d7b.js"><link rel="prefetch" href="/assets/js/117.6bdbcf50.js"><link rel="prefetch" href="/assets/js/118.b2f8d544.js"><link rel="prefetch" href="/assets/js/119.0c9ed9ce.js"><link rel="prefetch" href="/assets/js/12.6a2bdc8e.js"><link rel="prefetch" href="/assets/js/120.fdbd87a4.js"><link rel="prefetch" href="/assets/js/121.ac05c2d8.js"><link rel="prefetch" href="/assets/js/122.4d1e1faa.js"><link rel="prefetch" href="/assets/js/123.65d8d6da.js"><link rel="prefetch" href="/assets/js/124.cce0fdb0.js"><link rel="prefetch" href="/assets/js/125.6dad49bf.js"><link rel="prefetch" href="/assets/js/126.1e532944.js"><link rel="prefetch" href="/assets/js/127.dd62f7e8.js"><link rel="prefetch" href="/assets/js/128.9afe8209.js"><link rel="prefetch" href="/assets/js/129.0c854151.js"><link rel="prefetch" href="/assets/js/13.46c8c941.js"><link rel="prefetch" href="/assets/js/130.05213bf7.js"><link rel="prefetch" href="/assets/js/131.ec63ccf8.js"><link rel="prefetch" href="/assets/js/132.ed2d0697.js"><link rel="prefetch" href="/assets/js/133.b058adf8.js"><link rel="prefetch" href="/assets/js/134.9d50e512.js"><link rel="prefetch" href="/assets/js/135.f19cf169.js"><link rel="prefetch" href="/assets/js/136.7217f3e7.js"><link rel="prefetch" href="/assets/js/137.5aa7aa01.js"><link rel="prefetch" href="/assets/js/138.a66a2b44.js"><link rel="prefetch" href="/assets/js/139.a8677020.js"><link rel="prefetch" href="/assets/js/14.e42cf609.js"><link rel="prefetch" href="/assets/js/140.7fd5ba3b.js"><link rel="prefetch" href="/assets/js/141.540b5745.js"><link rel="prefetch" href="/assets/js/142.89e651ea.js"><link rel="prefetch" href="/assets/js/143.acd1b80e.js"><link rel="prefetch" href="/assets/js/144.150b08db.js"><link rel="prefetch" href="/assets/js/145.103a7d05.js"><link rel="prefetch" href="/assets/js/146.ab2150f9.js"><link rel="prefetch" href="/assets/js/147.d472eb3e.js"><link rel="prefetch" href="/assets/js/148.016bda67.js"><link rel="prefetch" href="/assets/js/149.be0e84aa.js"><link rel="prefetch" href="/assets/js/15.dc2cedd5.js"><link rel="prefetch" href="/assets/js/150.981cfbaa.js"><link rel="prefetch" href="/assets/js/151.e1a6eb15.js"><link rel="prefetch" href="/assets/js/152.3e864ebc.js"><link rel="prefetch" href="/assets/js/153.2cfdc42a.js"><link rel="prefetch" href="/assets/js/154.3fc56daf.js"><link rel="prefetch" href="/assets/js/155.8650d114.js"><link rel="prefetch" href="/assets/js/156.d8acbfce.js"><link rel="prefetch" href="/assets/js/157.81086824.js"><link rel="prefetch" href="/assets/js/158.3f0a0eb2.js"><link rel="prefetch" href="/assets/js/159.7979a346.js"><link rel="prefetch" href="/assets/js/16.0911008e.js"><link rel="prefetch" href="/assets/js/160.0377903e.js"><link rel="prefetch" href="/assets/js/161.14c72aa0.js"><link rel="prefetch" href="/assets/js/162.a90e9e5d.js"><link rel="prefetch" href="/assets/js/163.c0aee519.js"><link rel="prefetch" href="/assets/js/164.68fdb80b.js"><link rel="prefetch" href="/assets/js/165.0fb54685.js"><link rel="prefetch" href="/assets/js/166.1c01303e.js"><link rel="prefetch" href="/assets/js/167.c5393b91.js"><link rel="prefetch" href="/assets/js/168.46199e90.js"><link rel="prefetch" href="/assets/js/169.6e2adbae.js"><link rel="prefetch" href="/assets/js/17.7330df05.js"><link rel="prefetch" href="/assets/js/170.03dafd77.js"><link rel="prefetch" href="/assets/js/171.b43f4e55.js"><link rel="prefetch" href="/assets/js/172.f0d319d5.js"><link rel="prefetch" href="/assets/js/173.259c598a.js"><link rel="prefetch" href="/assets/js/174.dff08bed.js"><link rel="prefetch" href="/assets/js/175.f7b03d32.js"><link rel="prefetch" href="/assets/js/176.753d3070.js"><link rel="prefetch" href="/assets/js/177.c2de3643.js"><link rel="prefetch" href="/assets/js/178.79b99cad.js"><link rel="prefetch" href="/assets/js/179.c1b60cca.js"><link rel="prefetch" href="/assets/js/18.6e22d15a.js"><link rel="prefetch" href="/assets/js/180.5f666787.js"><link rel="prefetch" href="/assets/js/181.faa8709a.js"><link rel="prefetch" href="/assets/js/182.eeb4cfb0.js"><link rel="prefetch" href="/assets/js/183.7144cda0.js"><link rel="prefetch" href="/assets/js/184.ac4d4798.js"><link rel="prefetch" href="/assets/js/185.599bb167.js"><link rel="prefetch" href="/assets/js/186.dee9be1a.js"><link rel="prefetch" href="/assets/js/187.8956b575.js"><link rel="prefetch" href="/assets/js/188.da117cf8.js"><link rel="prefetch" href="/assets/js/189.62278389.js"><link rel="prefetch" href="/assets/js/19.42c153f5.js"><link rel="prefetch" href="/assets/js/20.f2a75171.js"><link rel="prefetch" href="/assets/js/21.00af4b96.js"><link rel="prefetch" href="/assets/js/22.73399e47.js"><link rel="prefetch" href="/assets/js/23.0810ee21.js"><link rel="prefetch" href="/assets/js/24.690ef6e6.js"><link rel="prefetch" href="/assets/js/25.76eb9b6c.js"><link rel="prefetch" href="/assets/js/26.3b87ec87.js"><link rel="prefetch" href="/assets/js/27.2840b941.js"><link rel="prefetch" href="/assets/js/28.6fd60aca.js"><link rel="prefetch" href="/assets/js/29.257138aa.js"><link rel="prefetch" href="/assets/js/30.23798c01.js"><link rel="prefetch" href="/assets/js/31.1a0bc365.js"><link rel="prefetch" href="/assets/js/32.b7050b1c.js"><link rel="prefetch" href="/assets/js/33.41777682.js"><link rel="prefetch" href="/assets/js/34.a8b2617d.js"><link rel="prefetch" href="/assets/js/36.3029eff6.js"><link rel="prefetch" href="/assets/js/37.77ee012a.js"><link rel="prefetch" href="/assets/js/38.71fcd0f4.js"><link rel="prefetch" href="/assets/js/39.32ea3b43.js"><link rel="prefetch" href="/assets/js/4.3db72c55.js"><link rel="prefetch" href="/assets/js/40.15c5b412.js"><link rel="prefetch" href="/assets/js/41.57ef6926.js"><link rel="prefetch" href="/assets/js/42.b3d35f05.js"><link rel="prefetch" href="/assets/js/43.551dca08.js"><link rel="prefetch" href="/assets/js/44.d9280916.js"><link rel="prefetch" href="/assets/js/45.9766d1ac.js"><link rel="prefetch" href="/assets/js/46.a1dd8560.js"><link rel="prefetch" href="/assets/js/47.234ba5cb.js"><link rel="prefetch" href="/assets/js/48.41bd3e50.js"><link rel="prefetch" href="/assets/js/49.31474dd6.js"><link rel="prefetch" href="/assets/js/5.0b6a42ae.js"><link rel="prefetch" href="/assets/js/50.d6fd2939.js"><link rel="prefetch" href="/assets/js/51.707ef622.js"><link rel="prefetch" href="/assets/js/52.416c9db2.js"><link rel="prefetch" href="/assets/js/53.584294fc.js"><link rel="prefetch" href="/assets/js/54.577121c1.js"><link rel="prefetch" href="/assets/js/55.a30e1b0f.js"><link rel="prefetch" href="/assets/js/56.4ed70bed.js"><link rel="prefetch" href="/assets/js/57.46e13066.js"><link rel="prefetch" href="/assets/js/58.7f403bc5.js"><link rel="prefetch" href="/assets/js/59.6e1eccee.js"><link rel="prefetch" href="/assets/js/6.df184162.js"><link rel="prefetch" href="/assets/js/60.bd12878c.js"><link rel="prefetch" href="/assets/js/61.2e4d6dfb.js"><link rel="prefetch" href="/assets/js/62.610615dd.js"><link rel="prefetch" href="/assets/js/63.1f946d7a.js"><link rel="prefetch" href="/assets/js/64.1604c5de.js"><link rel="prefetch" href="/assets/js/65.dff53e31.js"><link rel="prefetch" href="/assets/js/66.4e7b7328.js"><link rel="prefetch" href="/assets/js/67.5ef5082c.js"><link rel="prefetch" href="/assets/js/68.59c91aaa.js"><link rel="prefetch" href="/assets/js/69.9095825c.js"><link rel="prefetch" href="/assets/js/7.b6c53fe0.js"><link rel="prefetch" href="/assets/js/70.32784578.js"><link rel="prefetch" href="/assets/js/71.d3e69d00.js"><link rel="prefetch" href="/assets/js/72.45c37b47.js"><link rel="prefetch" href="/assets/js/73.1310a2d2.js"><link rel="prefetch" href="/assets/js/74.5a5f17df.js"><link rel="prefetch" href="/assets/js/75.52e40b76.js"><link rel="prefetch" href="/assets/js/76.3e6ab951.js"><link rel="prefetch" href="/assets/js/77.4f04c7c8.js"><link rel="prefetch" href="/assets/js/78.baccc7e3.js"><link rel="prefetch" href="/assets/js/79.ddcb792b.js"><link rel="prefetch" href="/assets/js/8.1d51f70c.js"><link rel="prefetch" href="/assets/js/80.ae8e822b.js"><link rel="prefetch" href="/assets/js/81.d31d9e55.js"><link rel="prefetch" href="/assets/js/82.96a59627.js"><link rel="prefetch" href="/assets/js/83.8c4e2ad4.js"><link rel="prefetch" href="/assets/js/84.0cb2e998.js"><link rel="prefetch" href="/assets/js/85.15dc98f3.js"><link rel="prefetch" href="/assets/js/86.c6e3fd71.js"><link rel="prefetch" href="/assets/js/87.252af8c6.js"><link rel="prefetch" href="/assets/js/88.4fafea89.js"><link rel="prefetch" href="/assets/js/89.0e948ac8.js"><link rel="prefetch" href="/assets/js/9.87e39e13.js"><link rel="prefetch" href="/assets/js/90.1871253c.js"><link rel="prefetch" href="/assets/js/91.6a369220.js"><link rel="prefetch" href="/assets/js/92.41fe39b0.js"><link rel="prefetch" href="/assets/js/93.f67c5ff9.js"><link rel="prefetch" href="/assets/js/94.9ac39122.js"><link rel="prefetch" href="/assets/js/95.4190a7af.js"><link rel="prefetch" href="/assets/js/96.87c7a503.js"><link rel="prefetch" href="/assets/js/97.051d996c.js"><link rel="prefetch" href="/assets/js/98.3d8c6a69.js"><link rel="prefetch" href="/assets/js/99.0bad65c3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2603d9eb.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303170016613.png" alt="晨光向的编码之旅" class="logo"> <span class="site-name can-hide">晨光向的编码之旅</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><a href="/pages/ec1391/" class="link-title">语言</a> <span class="title" style="display:none;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JAVA语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ec1391/" class="nav-link">语言基础</a></li><li class="dropdown-subitem"><a href="/pages/9faa36/" class="nav-link">JVM</a></li><li class="dropdown-subitem"><a href="/pages/3e9c3c/" class="nav-link">多线程</a></li><li class="dropdown-subitem"><a href="/pages/a142ba/" class="nav-link">并发编程基础</a></li><li class="dropdown-subitem"><a href="/pages/818132/" class="nav-link">并发编程进阶</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/29740f/" class="nav-link">MySQL基础</a></li><li class="dropdown-subitem"><a href="https://note.youdao.com/s/dXUGd7xa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MySQL基础-常用工具
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/pages/" class="nav-link router-link-active">MySQL高级</a></li><li class="dropdown-subitem"><a href="/pages/ff9a50/" class="nav-link">Influxdb</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/febdf1/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/febdf1/" class="nav-link">数据结构和算法</a></li><li class="dropdown-item"><!----> <a href="https://www.r2coding.com/#/?id=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机网络
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.r2coding.com/#/?id=%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  操作系统
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/pages/391852/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><a href="/pages/6ad6ad/" class="link-title">开发工具</a> <span class="title" style="display:none;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>集成开发环境</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6ad6ad/" class="nav-link">IDEA</a></li><li class="dropdown-subitem"><a href="/pages/d486f7/" class="nav-link">VSCode</a></li><li class="dropdown-subitem"><a href="/pages/17afa5/" class="nav-link">数据库工具</a></li><li class="dropdown-subitem"><a href="/pages/5082de/" class="nav-link">接口测试工具</a></li><li class="dropdown-subitem"><a href="/pages/883ecf/" class="nav-link">Markdown</a></li></ul></li><li class="dropdown-item"><h4>Linux系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1056fc/" class="nav-link">Linux基础</a></li><li class="dropdown-subitem"><a href="/pages/dfd34f/" class="nav-link">CentOS</a></li><li class="dropdown-subitem"><a href="/pages/27c228/" class="nav-link">Docker</a></li></ul></li><li class="dropdown-item"><h4>代码管理工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/00b1bb/" class="nav-link">Svn</a></li><li class="dropdown-subitem"><a href="/pages/d486f7/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>项目管理&amp;构建工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/020d30/" class="nav-link">Maven</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/e8fc76/" class="nav-link">代码质量检查</a></li><li class="dropdown-item"><!----> <a href="/pages/b353b1/" class="nav-link">开发部署文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="应用框架" class="dropdown-title"><a href="/pages/0705f0/" class="link-title">应用框架</a> <span class="title" style="display:none;">应用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring家族</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0705f0/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/pages/d04a9e/" class="nav-link">SpringMVC</a></li><li class="dropdown-subitem"><a href="/pages/c71dea/" class="nav-link">SpringBoot</a></li><li class="dropdown-subitem"><a href="/pages/376f90/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>服务器软件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/9e3fdb/" class="nav-link">Web服务器</a></li><li class="dropdown-subitem"><a href="/pages/62479e/" class="nav-link">应用服务器</a></li></ul></li><li class="dropdown-item"><h4>中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1db5d1/" class="nav-link">缓存</a></li><li class="dropdown-subitem"><a href="/pages/19fb99/" class="nav-link">消息队列</a></li><li class="dropdown-subitem"><a href="/pages/52168a/" class="nav-link">RPC架构</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/adffbc/" class="nav-link">ORM层框架</a></li><li class="dropdown-subitem"><a href="/pages/1e130e/" class="nav-link">连接池</a></li><li class="dropdown-subitem"><a href="/pages/a37c17/" class="nav-link">分库分表</a></li></ul></li><li class="dropdown-item"><h4>搜索引擎</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6a898f/" class="nav-link">ElasticSearch</a></li></ul></li><li class="dropdown-item"><h4>前端组件化框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/abd7cf/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/42fe7b/404" class="nav-link">VUE</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/d2c6a1/" class="nav-link">问题汇总</a></div><div class="nav-item"><a href="/pages/b0e900/" class="nav-link">在线文档</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><a href="/pages/ec1391/" class="link-title">语言</a> <span class="title" style="display:none;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JAVA语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ec1391/" class="nav-link">语言基础</a></li><li class="dropdown-subitem"><a href="/pages/9faa36/" class="nav-link">JVM</a></li><li class="dropdown-subitem"><a href="/pages/3e9c3c/" class="nav-link">多线程</a></li><li class="dropdown-subitem"><a href="/pages/a142ba/" class="nav-link">并发编程基础</a></li><li class="dropdown-subitem"><a href="/pages/818132/" class="nav-link">并发编程进阶</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/29740f/" class="nav-link">MySQL基础</a></li><li class="dropdown-subitem"><a href="https://note.youdao.com/s/dXUGd7xa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MySQL基础-常用工具
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/pages/" class="nav-link router-link-active">MySQL高级</a></li><li class="dropdown-subitem"><a href="/pages/ff9a50/" class="nav-link">Influxdb</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/febdf1/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/febdf1/" class="nav-link">数据结构和算法</a></li><li class="dropdown-item"><!----> <a href="https://www.r2coding.com/#/?id=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机网络
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.r2coding.com/#/?id=%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  操作系统
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/pages/391852/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><a href="/pages/6ad6ad/" class="link-title">开发工具</a> <span class="title" style="display:none;">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>集成开发环境</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6ad6ad/" class="nav-link">IDEA</a></li><li class="dropdown-subitem"><a href="/pages/d486f7/" class="nav-link">VSCode</a></li><li class="dropdown-subitem"><a href="/pages/17afa5/" class="nav-link">数据库工具</a></li><li class="dropdown-subitem"><a href="/pages/5082de/" class="nav-link">接口测试工具</a></li><li class="dropdown-subitem"><a href="/pages/883ecf/" class="nav-link">Markdown</a></li></ul></li><li class="dropdown-item"><h4>Linux系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1056fc/" class="nav-link">Linux基础</a></li><li class="dropdown-subitem"><a href="/pages/dfd34f/" class="nav-link">CentOS</a></li><li class="dropdown-subitem"><a href="/pages/27c228/" class="nav-link">Docker</a></li></ul></li><li class="dropdown-item"><h4>代码管理工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/00b1bb/" class="nav-link">Svn</a></li><li class="dropdown-subitem"><a href="/pages/d486f7/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>项目管理&amp;构建工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/020d30/" class="nav-link">Maven</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/e8fc76/" class="nav-link">代码质量检查</a></li><li class="dropdown-item"><!----> <a href="/pages/b353b1/" class="nav-link">开发部署文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="应用框架" class="dropdown-title"><a href="/pages/0705f0/" class="link-title">应用框架</a> <span class="title" style="display:none;">应用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring家族</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0705f0/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/pages/d04a9e/" class="nav-link">SpringMVC</a></li><li class="dropdown-subitem"><a href="/pages/c71dea/" class="nav-link">SpringBoot</a></li><li class="dropdown-subitem"><a href="/pages/376f90/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>服务器软件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/9e3fdb/" class="nav-link">Web服务器</a></li><li class="dropdown-subitem"><a href="/pages/62479e/" class="nav-link">应用服务器</a></li></ul></li><li class="dropdown-item"><h4>中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1db5d1/" class="nav-link">缓存</a></li><li class="dropdown-subitem"><a href="/pages/19fb99/" class="nav-link">消息队列</a></li><li class="dropdown-subitem"><a href="/pages/52168a/" class="nav-link">RPC架构</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/adffbc/" class="nav-link">ORM层框架</a></li><li class="dropdown-subitem"><a href="/pages/1e130e/" class="nav-link">连接池</a></li><li class="dropdown-subitem"><a href="/pages/a37c17/" class="nav-link">分库分表</a></li></ul></li><li class="dropdown-item"><h4>搜索引擎</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6a898f/" class="nav-link">ElasticSearch</a></li></ul></li><li class="dropdown-item"><h4>前端组件化框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/abd7cf/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/42fe7b/404" class="nav-link">VUE</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/d2c6a1/" class="nav-link">问题汇总</a></div><div class="nav-item"><a href="/pages/b0e900/" class="nav-link">在线文档</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JAVA语言</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>语言基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>JVM</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9faa36/" class="sidebar-link">JVM与Java体系结构</a></li><li><a href="/pages/bac2fa/" class="sidebar-link">类加载子系统</a></li><li><a href="/pages/c15e11/" class="sidebar-link">运行时数据区概述及线程</a></li><li><a href="/pages/797fac/" class="sidebar-link">程序计数器(PC寄存器)</a></li><li><a href="/pages/42fe7b/" aria-current="page" class="active sidebar-link">虚拟机栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_1-虚拟机栈概述" class="sidebar-link">1. 虚拟机栈概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#java虚拟机栈是什么" class="sidebar-link">Java虚拟机栈是什么？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#生命周期" class="sidebar-link">生命周期</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#作用" class="sidebar-link">作用</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#栈的特点" class="sidebar-link">栈的特点</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#开发中遇到哪些异常" class="sidebar-link">开发中遇到哪些异常？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#设置栈的内存大小" class="sidebar-link">设置栈的内存大小</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_2-栈的存储单位" class="sidebar-link">2. 栈的存储单位</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#栈中存储什么" class="sidebar-link">栈中存储什么？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#栈运行原理" class="sidebar-link">栈运行原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#栈帧的内部结构" class="sidebar-link">栈帧的内部结构</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_3-局部变量表-local-variables-table" class="sidebar-link">3. 局部变量表（Local Variables Table）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#局部变量表初识" class="sidebar-link">局部变量表初识</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#关于slot理解" class="sidebar-link">关于Slot理解</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#slot的重复利用" class="sidebar-link">Slot的重复利用</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#静态变量与局部变量的对比" class="sidebar-link">静态变量与局部变量的对比</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_4-操作数栈-operand-stack" class="sidebar-link">4. 操作数栈（Operand Stack）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#概念" class="sidebar-link">概念</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_5-代码追踪" class="sidebar-link">5. 代码追踪</a></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_6-栈顶缓存技术" class="sidebar-link">6. 栈顶缓存技术</a></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_7-动态链接-dynamic-linking" class="sidebar-link">7. 动态链接（Dynamic Linking）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#执行流程图" class="sidebar-link">执行流程图</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#为什么需要常量池" class="sidebar-link">为什么需要常量池？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_8-方法的调用-解析与分派" class="sidebar-link">8. 方法的调用: 解析与分派</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#静态链接和动态链接" class="sidebar-link">静态链接和动态链接</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#静态链接" class="sidebar-link">静态链接：</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#动态链接" class="sidebar-link">动态链接：</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#早起绑定和晚期绑定" class="sidebar-link">早起绑定和晚期绑定</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#早期绑定" class="sidebar-link">早期绑定</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#晚期绑定" class="sidebar-link">晚期绑定</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#示例-2" class="sidebar-link">示例</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#虚方法和非虚方法" class="sidebar-link">虚方法和非虚方法</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#非虚方法" class="sidebar-link">非虚方法</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#虚拟机中提供了以下几条方法调用指令" class="sidebar-link">虚拟机中提供了以下几条方法调用指令</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#invokedynamic指令" class="sidebar-link">invokedynamic指令</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#方法的重写" class="sidebar-link">方法的重写</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#java语言中方法重写的本质" class="sidebar-link">Java语言中方法重写的本质</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#illegalaccesserror-介绍" class="sidebar-link">IllegalAccessError 介绍</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#虚方法表" class="sidebar-link">虚方法表</a></li><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#示例-3" class="sidebar-link">示例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_9-方法返回地址-return-address" class="sidebar-link">9. 方法返回地址（Return Address）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/42fe7b/#当一个方法开始执行后-只有两种方式可以退出这个方法" class="sidebar-link">当一个方法开始执行后，只有两种方式可以退出这个方法：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_10-一些附加信息" class="sidebar-link">10. 一些附加信息</a></li><li class="sidebar-sub-header level2"><a href="/pages/42fe7b/#_11-栈的相关面试题" class="sidebar-link">11. 栈的相关面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#_1-举例栈溢出的情况" class="sidebar-link">1. 举例栈溢出的情况？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#_2-调整栈大小-就能保证不出现溢出吗" class="sidebar-link">2. 调整栈大小，就能保证不出现溢出吗？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#_3-分配的占内存越大越好吗" class="sidebar-link">3. 分配的占内存越大越好吗？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#_4-垃圾回收是否会涉及到虚拟机栈" class="sidebar-link">4. 垃圾回收是否会涉及到虚拟机栈？</a></li><li class="sidebar-sub-header level3"><a href="/pages/42fe7b/#_5-方法中定义的局部变量是否线程安全" class="sidebar-link">5. 方法中定义的局部变量是否线程安全？</a></li></ul></li></ul></li><li><a href="/pages/38174c/" class="sidebar-link">本地方法接口</a></li><li><a href="/pages/ba6197/" class="sidebar-link">本地方法栈</a></li><li><a href="/pages/32d7be/" class="sidebar-link">堆</a></li><li><a href="/pages/2f74c5/" class="sidebar-link">方法区</a></li><li><a href="/pages/9fa953/" class="sidebar-link">对象的实例化内存布局与访问定位</a></li><li><a href="/pages/64de09/" class="sidebar-link">执行引擎</a></li><li><a href="/pages/6cfffc/" class="sidebar-link">StringTable</a></li><li><a href="/pages/a75cf5/" class="sidebar-link">垃圾回收概述</a></li><li><a href="/pages/c0a9b6/" class="sidebar-link">垃圾回收相关算法</a></li><li><a href="/pages/e20df8/" class="sidebar-link">垃圾回收相关概念</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>多线程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>并发编程基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>并发编程进阶</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>语言</span></li><li data-v-06225672><span data-v-06225672>JAVA语言</span></li><li data-v-06225672><span data-v-06225672>JVM</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/afreebird" target="_blank" title="作者" class="beLink" data-v-06225672>晨光-向</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-02-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">虚拟机栈<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="jvm-虚拟机栈-java-virtual-machine-stacks"><a href="#jvm-虚拟机栈-java-virtual-machine-stacks" class="header-anchor">#</a> JVM-虚拟机栈（Java Virtual Machine Stacks）</h1> <h2 id="_1-虚拟机栈概述"><a href="#_1-虚拟机栈概述" class="header-anchor">#</a> 1. 虚拟机栈概述</h2> <p>由于跨平台性的设计，Java的指令都是根据栈来设计的。不同平台CPU架构不同，所以不能设计为基于寄存器的。</p> <p><code>优点是跨平台，指令集小，编译器容易实现，缺点是性能下降，实现同样的功能需要更多的指令。</code></p> <p>有不少Java开发人员一提到Java内存结构，就会非常粗粒度地将JVM中的内存区理解为仅有Java堆（heap）和Java栈（stack）？为什么？</p> <p>首先<code>栈是运行时的单位，而堆是存储的单位</code></p> <ul><li>栈解决程序的运行问题，即程序如何执行，或者说如何处理数据。</li> <li>堆解决的是数据存储的问题，即数据怎么放，放哪里。</li></ul> <h3 id="java虚拟机栈是什么"><a href="#java虚拟机栈是什么" class="header-anchor">#</a> Java虚拟机栈是什么？</h3> <p>Java虚拟机栈（Java Virtual Machine Stacks），早期也叫Java栈。每个线程在创建时都会创建一个虚拟机栈，其内部保存一个个的栈帧（Stack Frame），对应一次次的Java方法调用。</p> <blockquote><p>线程是私有的</p></blockquote> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171224-46870.png" alt=""></p> <h3 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h3> <p>生命周期和线程一直</p> <h3 id="作用"><a href="#作用" class="header-anchor">#</a> 作用</h3> <p>主管Java程序的运行，它保存方法的<code>局部变量(8种基本数据类型、对象的引用地址)、部分变量，并参与方法的调用和返回</code>。</p> <ul><li>局部变量：相较于成员变量（属性）</li> <li>基本数据变量：相较于引用类型变量（类、数组、接口）</li></ul> <h3 id="栈的特点"><a href="#栈的特点" class="header-anchor">#</a> 栈的特点</h3> <ul><li><p>栈是一种快速有效的分配存储方式，访问速度仅次于程序计数器。</p></li> <li><p>JVM直接对Java栈的操作只用两个：</p> <p>1）每个方法执行，伴随着进栈（入栈、压栈）</p> <p>2）执行结束后的出战工作</p></li> <li><p><code>对于栈来说不存在垃圾回收(GC)问题（栈存在溢出OOM的情况）</code></p></li></ul> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171230-724708.png" alt=""></p> <h3 id="开发中遇到哪些异常"><a href="#开发中遇到哪些异常" class="header-anchor">#</a> 开发中遇到哪些异常？</h3> <p>栈中可能出现的异常</p> <p>Java 虚拟机规范允许<code>Java栈的大小是动态的或者是固定不变的</code>。</p> <ol><li>如果采用固定大小的Java虚拟机栈，那每一个线程的Java虚拟机栈容量可以在线程创建的时候独立选定。如果线程请求分配的栈容量超过Java虚拟机栈允许的最大容量，Java虚拟机将会抛出一个<code>StackoverflowError</code>异常。</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/09/06 11:48
 * @Description: &lt;h1&gt; 栈中可能出现的异常 &lt;/h1&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackError</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 演示栈中的异常：StackOverflowError
     * @param args
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>抛出异常</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Exception <span class="token keyword">in</span> thread <span class="token string">&quot;main&quot;</span> java.lang.StackOverflowError
	at com.chggx.jvm.chapter05.StackError.main<span class="token punctuation">(</span>StackError.java:11<span class="token punctuation">)</span>
	at com.chggx.jvm.chapter05.StackError.main<span class="token punctuation">(</span>StackError.java:11<span class="token punctuation">)</span>
	at com.chggx.jvm.chapter05.StackError.main<span class="token punctuation">(</span>StackError.java:11<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>如果Java虚拟机栈可以动态扩展，并且在尝试扩展的时候无法申请到足够的内存，或者在创建新的线程时没有足够的内存去创建对应的虚拟机栈，那Java虚拟机将会抛出一个 <code>outofMemoryError</code>异常。</li></ol> <h3 id="设置栈的内存大小"><a href="#设置栈的内存大小" class="header-anchor">#</a> <a href="https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE" target="_blank" rel="noopener noreferrer">设置栈的内存大小<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>我们可以使用参数 <code>-Xss</code> 选项来设置线程的最大站空间，栈的大小直接决定了函数的最大可达深度。</p> <p>设置线程堆栈大小(以字节为单位)。附加字母k或k表示KB, m或m表示MB, g或g表示GB。默认值取决于平台:</p> <ul><li><p>Linux/x64(64位):1024 KB</p></li> <li><p>macOS(64位):1024 KB</p></li> <li><p>Oracle Solaris/x64(64位):1024 KB</p></li> <li><p>Windows:默认值取决于虚拟内存</p></li></ul> <p>下面的例子将线程栈大小设置为1024 KB，单位为不同:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token parameter variable">-Xss1m</span>
<span class="token parameter variable">-Xss1024k</span>
<span class="token parameter variable">-Xss1048576</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>示例</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/09/06 11:48
 * @Description: &lt;h1&gt; 设置栈的大小 &lt;/h1&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackError2</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 默认情况下： count： 11413
     * 设置栈的大小：-Xss256k count：2468
     * @param args
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count<span class="token operator">++</span><span class="token punctuation">;</span>
       <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_2-栈的存储单位"><a href="#_2-栈的存储单位" class="header-anchor">#</a> 2. 栈的存储单位</h2> <h3 id="栈中存储什么"><a href="#栈中存储什么" class="header-anchor">#</a> 栈中存储什么？</h3> <ul><li><p>每个线程都有自己的栈，栈中的数据都是以<code>栈帧（Stack Frame）的格式存在</code>。</p></li> <li><p>在这个线程正在执行的每个<code>方法</code>都有各自对应一个<code>栈帧（Stack Frame）</code>。</p></li> <li><p>栈帧是一个内存区块，是一个数据集，维系着方法执行过程中的各种数据信息。</p></li></ul> <blockquote><p>OOP的基本概念：类和对象</p> <p>类中基本结构：field（属性、字段、域）、method</p></blockquote> <h3 id="栈运行原理"><a href="#栈运行原理" class="header-anchor">#</a> 栈运行原理</h3> <ol><li><p>JVM直接对Java栈的操作只有两个，就是对栈帧的<code>压栈</code>和<code>出栈</code>，遵循“<code>先进后出</code>” 或 “<code>后进先出</code>”原则。</p></li> <li><p>在一条活动线程中，一个时间点上，只会有一个活跃的栈帧。即只有当前正在执行的方法的栈帧（栈顶栈帧）是有效的，这个栈帧被称为<code>当前栈帧（Current Frame）</code>，与当前栈帧相对应的方法就是当<code>前方法（Current Method）</code>, 定义这个方法的类就是<code>当前类（Current Class）</code>。</p></li></ol> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171236-600309.png" alt=""></p> <ol start="3"><li><p>执行引擎运行的所有字节码指令只针对当前栈帧进行操作。</p></li> <li><p>如果在该方法中调用了其他方法，对应的新的栈帧会被创建出来，放在栈的顶部，称为新的当前栈帧。</p></li> <li><p>不同线程中所包含的栈帧是不允许存在相互引用的，既不能在一个栈帧之中引用另一个线程的栈帧。</p></li> <li><p>如果当前方法调用了其他方法，方法返回之际，当前栈帧会传回来此方法的执行结果给前一个栈帧，接着，虚拟机会丢弃当前栈帧，使得前一个栈帧重新成为当前栈帧。</p></li> <li><p>Java方法有两种返回函数的方式：</p> <ul><li>一种是正常的函数返回，使用return指令。</li> <li>一种是抛出异常。</li></ul> <blockquote><p>不管使用哪种方式，都会导致栈帧被弹出</p></blockquote></li></ol> <p>示例代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/09/06 14:42
 * @Description: &lt;h1&gt; 栈帧运行原理示例 &lt;/h1&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackFrameTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StackFrameTest</span> stackFrameTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StackFrameTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stackFrameTest<span class="token punctuation">.</span><span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method1()开始执行。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method1()执行结束。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method2()开始执行。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">method3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method2()即将结束。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> i <span class="token operator">+</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">method3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method3()开始执行。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> j <span class="token operator">=</span> <span class="token number">20.0</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;method3()即将结束。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>运行结果</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>method1<span class="token punctuation">(</span><span class="token punctuation">)</span>开始执行。。。
method2<span class="token punctuation">(</span><span class="token punctuation">)</span>开始执行。。。
method3<span class="token punctuation">(</span><span class="token punctuation">)</span>开始执行。。。
method3<span class="token punctuation">(</span><span class="token punctuation">)</span>即将结束。。。
method2<span class="token punctuation">(</span><span class="token punctuation">)</span>即将结束。。。
method1<span class="token punctuation">(</span><span class="token punctuation">)</span>执行结束。。。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>通过<code>DEGUB模式</code>查看栈信息（满足 先进后出/后进先出原则）</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171242-733300.png" alt=""></p> <p>反编译</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>javap <span class="token parameter variable">-v</span> StackFrameTest.class
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
  public com.chggx.jvm.chapter05.stackframe.StackFrameTest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: aload_0
         <span class="token number">1</span>: invokespecial <span class="token comment">#1                  // Method java/lang/Object.&quot;&lt;ini</span>
t<span class="token operator">&gt;</span><span class="token string">&quot;:()V
         4: return
      LineNumberTable:
        line 8: 0
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       5     0  this   Lcom/chggx/jvm/chapter05/stackframe/StackF
rameTest;

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=2, args_size=1
         0: new           #2                  // class com/chggx/jvm/chapter05
/stackframe/StackFrameTest
         3: dup
         4: invokespecial #3                  // Method &quot;</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span>&quot;:<span class="token punctuation">(</span><span class="token punctuation">)</span>V
         <span class="token number">7</span>: astore_1
         <span class="token number">8</span>: aload_1
         <span class="token number">9</span>: invokevirtual <span class="token comment">#4                  // Method method1:()V</span>
        <span class="token number">12</span>: goto          <span class="token number">20</span>
        <span class="token number">15</span>: astore_1
        <span class="token number">16</span>: aload_1
        <span class="token number">17</span>: invokevirtual <span class="token comment">#6                  // Method java/lang/Exception.pr</span>
intStackTrace:<span class="token punctuation">(</span><span class="token punctuation">)</span>V
        <span class="token number">20</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
        <span class="token number">23</span>: ldc           <span class="token comment">#8                  // String main()正常结束</span>
        <span class="token number">25</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
        <span class="token number">28</span>: <span class="token builtin class-name">return</span>
      Exception table:
         from    to  target <span class="token builtin class-name">type</span>
             <span class="token number">0</span>    <span class="token number">12</span>    <span class="token number">15</span>   Class java/lang/Exception
      LineNumberTable:
        line <span class="token number">18</span>: <span class="token number">0</span>
        line <span class="token number">19</span>: <span class="token number">8</span>
        line <span class="token number">22</span>: <span class="token number">12</span>
        line <span class="token number">20</span>: <span class="token number">15</span>
        line <span class="token number">21</span>: <span class="token number">16</span>
        line <span class="token number">23</span>: <span class="token number">20</span>
        line <span class="token number">24</span>: <span class="token number">28</span>
      LocalVariableTable: // 局部变量表
        Start  Length  Slot  Name   Signature
            <span class="token number">8</span>       <span class="token number">4</span>     <span class="token number">1</span> stackFrameTest   Lcom/chggx/jvm/chapter05/stackfra
me/StackFrameTest<span class="token punctuation">;</span>
           <span class="token number">16</span>       <span class="token number">4</span>     <span class="token number">1</span>     e   Ljava/lang/Exception<span class="token punctuation">;</span>
            <span class="token number">0</span>      <span class="token number">29</span>     <span class="token number">0</span>  args   <span class="token punctuation">[</span>Ljava/lang/String<span class="token punctuation">;</span>
      StackMapTable: number_of_entries <span class="token operator">=</span> <span class="token number">2</span>
        frame_type <span class="token operator">=</span> <span class="token number">79</span> /* same_locals_1_stack_item */
          stack <span class="token operator">=</span> <span class="token punctuation">[</span> class java/lang/Exception <span class="token punctuation">]</span>
        frame_type <span class="token operator">=</span> <span class="token number">4</span> /* same */

  public void method1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
         <span class="token number">3</span>: ldc           <span class="token comment">#10                 // String method1()开始执行。。</span>
。
         <span class="token number">5</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
         <span class="token number">8</span>: aload_0
         <span class="token number">9</span>: invokevirtual <span class="token comment">#11                 // Method method2:()I</span>
        <span class="token number">12</span>: pop
        <span class="token number">13</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
        <span class="token number">16</span>: ldc           <span class="token comment">#12                 // String method1()执行结束。。</span>
。
        <span class="token number">18</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
        <span class="token number">21</span>: <span class="token builtin class-name">return</span>
      LineNumberTable:
        line <span class="token number">27</span>: <span class="token number">0</span>
        line <span class="token number">28</span>: <span class="token number">8</span>
        line <span class="token number">29</span>: <span class="token number">13</span>
        line <span class="token number">31</span>: <span class="token number">21</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>      <span class="token number">22</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/stackframe/StackF
rameTest<span class="token punctuation">;</span>

  public int method2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>I
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">3</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
         <span class="token number">3</span>: ldc           <span class="token comment">#13                 // String method2()开始执行。。</span>
。
         <span class="token number">5</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
         <span class="token number">8</span>: bipush        <span class="token number">10</span>
        <span class="token number">10</span>: istore_1
        <span class="token number">11</span>: aload_0
        <span class="token number">12</span>: invokevirtual <span class="token comment">#14                 // Method method3:()D</span>
        <span class="token number">15</span>: d2i
        <span class="token number">16</span>: istore_2
        <span class="token number">17</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
        <span class="token number">20</span>: ldc           <span class="token comment">#15                 // String method2()即将结束。。</span>
。
        <span class="token number">22</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
        <span class="token number">25</span>: iload_1
        <span class="token number">26</span>: iload_2
        <span class="token number">27</span>: iadd
        <span class="token number">28</span>: ireturn
      LineNumberTable:
        line <span class="token number">34</span>: <span class="token number">0</span>
        line <span class="token number">35</span>: <span class="token number">8</span>
        line <span class="token number">36</span>: <span class="token number">11</span>
        line <span class="token number">37</span>: <span class="token number">17</span>
        line <span class="token number">38</span>: <span class="token number">25</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>      <span class="token number">29</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/stackframe/StackF
rameTest<span class="token punctuation">;</span>
           <span class="token number">11</span>      <span class="token number">18</span>     <span class="token number">1</span>     i   I
           <span class="token number">17</span>      <span class="token number">12</span>     <span class="token number">2</span>     m   I

  public double method3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>D
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">3</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
         <span class="token number">3</span>: ldc           <span class="token comment">#16                 // String method3()开始执行。。</span>
。
         <span class="token number">5</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
         <span class="token number">8</span>: ldc2_w        <span class="token comment">#17                 // double 20.0d</span>
        <span class="token number">11</span>: dstore_1
        <span class="token number">12</span>: getstatic     <span class="token comment">#7                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
        <span class="token number">15</span>: ldc           <span class="token comment">#19                 // String method3()即将结束。。</span>
。
        <span class="token number">17</span>: invokevirtual <span class="token comment">#9                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
        <span class="token number">20</span>: dload_1
        <span class="token number">21</span>: dreturn
      LineNumberTable:
        line <span class="token number">42</span>: <span class="token number">0</span>
        line <span class="token number">43</span>: <span class="token number">8</span>
        line <span class="token number">44</span>: <span class="token number">12</span>
        line <span class="token number">45</span>: <span class="token number">20</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>      <span class="token number">22</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/stackframe/StackF
rameTest<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br></div></div><h3 id="栈帧的内部结构"><a href="#栈帧的内部结构" class="header-anchor">#</a> 栈帧的内部结构</h3> <p>每个栈帧中存储着：</p> <ul><li>局部变量表（Local Variables）</li> <li>操作数栈（operand Stack）（或表达式栈）</li> <li>动态链接（Dynamic Linking）（或指向运行时常量池的方法引用）</li> <li>方法返回地址（Return Address）（或方法正常退出或者异常退出的定义）</li> <li>一些附加信息</li></ul> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171252-251794.png" alt=""></p> <p>并行每个线程下的栈都是私有的，因此每个线程都有自己各自的栈，并且每个栈里面都有很多栈帧，栈帧的大小主要由局部变量表 和 操作数栈决定的</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171256-74809.png" alt=""></p> <h2 id="_3-局部变量表-local-variables-table"><a href="#_3-局部变量表-local-variables-table" class="header-anchor">#</a> 3. 局部变量表（Local Variables Table）</h2> <h3 id="局部变量表初识"><a href="#局部变量表初识" class="header-anchor">#</a> 局部变量表初识</h3> <ol><li><p>局部变量表也被称之为局部变量数组或本地变量表</p></li> <li><p><code>定义为一个数字数组，主要用于存储方法参数和定义在方法体内的局部变量</code>，这些数据类型包括各类基本数据类型、对象引用（reference），以及returnAddress类型。</p></li> <li><p>由于局部变量表是建立在线程的栈上，是线程的私有数据，因此<code>不存在数据安全问题</code>。</p></li> <li><p>局部变量表所需的容量大小是在编译期确定下来的，并保存在方法的Code属性的maximum local variables数据项中。在方法运行期间是不会改变局部变量表的大小的。</p></li></ol> <p>通过 <code>javap -v xxx.class</code> 解析查看局部变量表</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171259-406168.png" alt=""></p> <p>通过<code>jclasslib</code> 查看</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171300-427029.png" alt=""></p> <ol start="5"><li><code>方法嵌套调用的次数由栈的大小决定</code>。一般来说，栈越大，方法嵌套调用次数越多。对一个函数而言，它的参数和局部变量越多，使得局部变量表膨胀，它的栈帧就越大，以满足方法调用所需传递的信息增大的需求。进而函数调用就会占用更多的栈空间，导致其嵌套调用次数就会减少。</li> <li><code>局部变量表中的变量只在当前方法调用中有效</code>。在方法执行时，虚拟机通过使用局部变量表完成参数值到参数变量列表的传递过程。<code>当方法调用结束后，随着方法栈帧的销毁，局部变量表也会随之销毁</code>。</li></ol> <h3 id="关于slot理解"><a href="#关于slot理解" class="header-anchor">#</a> 关于Slot理解</h3> <ol><li><p>参数值的存放总是在局部变量数组的index0开始，到数组长度-1的索引结束 (0,-1)。</p></li> <li><p>局部变量表，最基本的存储单位<code>Slot(变量槽)</code>。</p></li> <li><p>局部变量表中存放编译期可知的各种<code>基本数据类型（8种）</code>、<code>引用类型（reference）</code>、<code>returnAddress类型</code>的变量</p></li> <li><p>在局部变量表里，32位以内的类型只占用一个Slot（包括引用类型（reference）、returnAddress类型），64的类型（long和double）占用两个slot。</p> <ul><li>byte、short、char在存储前被转换为int，boolean也被转换为int，0表示false，非0表示true。</li> <li>long和double则占两个slot。</li></ul></li> <li><p>JVM会为局部变量中的每一个Slot都分配一个访问索引，通过这个索引即可成功访问到局部变量中指定的局部变量值。</p></li> <li><p>当一个实例方法被调用的时候，它的方法参数和方法体内部定义的局部变量将会按照顺序被复制到局部变量表中的每一个Slot上。</p></li> <li><p>如果需要访问局部变量表中的一个6bit的局部变量值时，只需要使用前一个索引即可。（比如：访问long或double类型变量）</p></li> <li><p>如果当前帧是由构造方法或者实例方法创建的，那么<code>该对象引用的this将会存放在index为0的slot处</code>，其余的参数按照参数表顺序继续排列</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
     * 如果当前帧是由构造方法或者实例方法创建的，那么`该对象引用的this将会存放在index为0的slot处`，其余的参数按照参数表顺序继续排列
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">LocalVariablesTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">LocalVariablesTest</span> localVariablesTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LocalVariablesTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 静态方法中，不能使用 this</span>
        <span class="token comment">// 原因： this变量不存在于当前方法的局部变量表中</span>
        <span class="token comment">// System.out.println(this.count);</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ol> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171306-31406.png" alt=""></p> <p>示例代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/** 关于Slot的使用理解
 * 如果当前帧是由构造方法或者实例方法创建的，那么`该对象引用的this将会存放在index为0的slot处`，其余的参数按照参数表顺序继续排列
 */</span>

<span class="token keyword">public</span> <span class="token class-name">LocalVariablesTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> name1 <span class="token operator">=</span> <span class="token string">&quot;chggx&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> info <span class="token operator">=</span> <span class="token function">test2</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span>name1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date<span class="token operator">+</span>name1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token class-name">Date</span> dateP<span class="token punctuation">,</span> <span class="token class-name">String</span> name2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dateP <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    name2 <span class="token operator">=</span> <span class="token string">&quot;xiaoming&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> wight <span class="token operator">=</span> <span class="token number">130.5</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> gender <span class="token operator">=</span> <span class="token char">'男'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dateP <span class="token operator">+</span> name2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>构造函数</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171312-748792.png" alt=""></p> <p>test1</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171315-729765.png" alt=""></p> <p>test2 （long/double）</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171316-164417.png" alt=""></p> <p>test3</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171318-460458.png" alt=""></p> <h3 id="slot的重复利用"><a href="#slot的重复利用" class="header-anchor">#</a> Slot的重复利用</h3> <p>栈帧中的局部变量表中的槽位是可以重复利用的，如果一个局部变量过了其作用域，那么在其作用域之后申明的新的局部变量就很有可能会复用过期局部变量的槽位，从而达到节省资源的目的。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        b <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//变量c使用之前已经销毁的变量b占据的slot的位置</span>
    <span class="token keyword">int</span> c <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171320-477374.png" alt=""></p> <h3 id="静态变量与局部变量的对比"><a href="#静态变量与局部变量的对比" class="header-anchor">#</a> 静态变量与局部变量的对比</h3> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code>变量的分类：
<span class="token key attr-name">   1.</span> <span class="token value attr-value">按照数据类型分：① 基本数据类型  ② 引用数据类型</span>
<span class="token key attr-name">   2.</span> <span class="token value attr-value">按照在类中声明的位置分：</span>
<span class="token key attr-name">        ①</span> <span class="token value attr-value">成员变量：在使用前，都经历过默认初始化赋值</span>
<span class="token key attr-name">                类变量：</span> <span class="token value attr-value">linking的prepare阶段：给类变量默认赋值  ---&gt; initial阶段：给类变量显式赋值即静态代码块赋值</span>
                实例变量：随着对象的创建，会在堆空间中分配实例变量空间，并进行默认赋值
<span class="token key attr-name">        ②</span> <span class="token value attr-value">局部变量：在使用前，必须要进行显式赋值的！否则，编译不通过</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol><li><p>参数表分配完毕之后，再根据方法体内定义的变量的顺序和作用域分配。</p></li> <li><p>我们知道类变量表有两次初始化的机会，第一次是在“准备阶段”，执行系统初始化，对类变量设置零值，另一次则是在“初始化”阶段，赋予程序员在代码中定义的初始值。</p></li> <li><p>和类变量初始化不同的是，局部变量表不存在系统初始化的过程，这意味着一旦定义了局部变量则必须人为的初始化，否则无法使用。</p></li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test5Temp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> num<span class="token punctuation">;</span>
<span class="token comment">//        System.out.println(num);//错误信息：变量num未进行初始化 Variable 'num' might not have been initialized</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="4"><li><p>在栈帧中，与性能调优关系最为密切的部分就是前面提到的局部变量表。在方法执行时，虚拟机使用局部变量表完成方法的传递。</p></li> <li><p><code>局部变量表中的变量也是重要的垃圾回收根节点，只要被局部变量表中直接或间接引用的对象都不会被回收</code>。</p></li></ol> <h2 id="_4-操作数栈-operand-stack"><a href="#_4-操作数栈-operand-stack" class="header-anchor">#</a> 4. 操作数栈（Operand Stack）</h2> <ul><li>栈： <code>可以使用数组或链表。</code></li></ul> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <ol><li><p>每一个独立的栈帧除了包含局部变量表以外，还包含一个后进先出（Last - In - First -Out）的 <code>操作数栈</code>，也可以称之为 <code>表达式栈</code>（Expression Stack）</p></li> <li><p>操作数栈，在方法执行过程中，根据字节码指令，往栈中写入数据或提取数据，即入栈（push）和 出栈（pop）</p> <ul><li>某些字节码指令将值压入操作数栈，其余的字节码指令将操作数取出栈。使用它们后再把结果压入栈</li> <li>比如：执行复制、交换、求和等操作</li></ul></li></ol> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171325-284892.png" alt=""></p> <p>示例代码</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202009/26/171327-968940.png" alt=""></p> <ol start="3"><li><p>操作数栈，主要用于保存计算过程的中间结果，同时作为计算过程中变量临时的存储空间。</p></li> <li><p>操作数栈就是JVM执行引擎的一个工作区，当一个方法刚开始执行的时候，一个新的栈帧也会随之被创建出来，这个方法的操作数栈是空的。</p> <blockquote><p>这个时候数组是有长度的，因为数组一旦创建，那么就是不可变的</p></blockquote></li> <li><p>每一个操作数栈都会拥有一个明确的栈深度用于存储数值，其所需的最大深度在编译期就定义好了，保存在方法的Code属性中，为maxstack的值。</p></li> <li><p>栈中的任何一个元素都是可以任意的Java数据类型</p> <ul><li>32bit的类型占用一个栈单位深度</li> <li>64bit的类型占用两个栈单位深度</li></ul> <blockquote><p>同<code>局部变量表</code></p></blockquote></li> <li><p>操作数栈<code>并非采用访问索引的方式来进行数据访问</code>的，而是只能通过标准的入栈和出栈操作来完成一次数据访问</p></li> <li><p><code>如果被调用的方法带有返回值的话，其返回值将会被压入当前栈帧的操作数栈中，并更新PC寄存器中下一条需要执行的字节码指令。</code></p></li> <li><p>操作数栈中元素的数据类型必须与字节码指令的序列严格匹配，这由编译器在编译器期间进行验证，同时在类加载过程中的类检验阶段的数据流分析阶段要再次验证。|</p></li> <li><p>另外，我们说<code>Java虚拟机的解释引擎是基于栈的执行引擎</code>，其中的栈指的就是操作数栈。</p></li></ol> <h2 id="_5-代码追踪"><a href="#_5-代码追踪" class="header-anchor">#</a> 5. 代码追踪</h2> <ol><li>代码</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OperandStackTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAddOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">byte</span> i <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> k <span class="token operator">=</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>使用 <code>javap</code> 命令编译class文件：javap -v 类名.class</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
  public com.chggx.jvm.chapter05.operandstack.OperandStackTest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: aload_0
         <span class="token number">1</span>: invokespecial <span class="token comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
         <span class="token number">4</span>: <span class="token builtin class-name">return</span>
      LineNumberTable:
        line <span class="token number">8</span>: <span class="token number">0</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>       <span class="token number">5</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/operandstack/OperandStackTest<span class="token punctuation">;</span>

  public void testAddOperation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">4</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: bipush        <span class="token number">15</span>
         <span class="token number">2</span>: istore_1
         <span class="token number">3</span>: bipush        <span class="token number">8</span>
         <span class="token number">5</span>: istore_2
         <span class="token number">6</span>: iload_1
         <span class="token number">7</span>: iload_2
         <span class="token number">8</span>: iadd
         <span class="token number">9</span>: istore_3
        <span class="token number">10</span>: <span class="token builtin class-name">return</span>
      LineNumberTable:
        line <span class="token number">11</span>: <span class="token number">0</span>
        line <span class="token number">12</span>: <span class="token number">3</span>
        line <span class="token number">13</span>: <span class="token number">6</span>
        line <span class="token number">14</span>: <span class="token number">10</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>      <span class="token number">11</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/operandstack/OperandStackTest<span class="token punctuation">;</span>
            <span class="token number">3</span>       <span class="token number">8</span>     <span class="token number">1</span>     i   B
            <span class="token number">6</span>       <span class="token number">5</span>     <span class="token number">2</span>     j   I
           <span class="token number">10</span>       <span class="token number">1</span>     <span class="token number">3</span>     k   I
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><ol start="3"><li>jclasslib</li></ol> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080449-854977.png" alt=""></p> <p>局部变量表 （Local Variables Table）</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080619-452197.png" alt=""></p> <ol start="4"><li>执行流程</li></ol> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080246-851119.png" alt=""></p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080806-94586.png" alt=""></p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080808-956046.png" alt=""></p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/080826-822962.png" alt=""></p> <h2 id="_6-栈顶缓存技术"><a href="#_6-栈顶缓存技术" class="header-anchor">#</a> 6. 栈顶缓存技术</h2> <p>前面提过，基于栈式架构的虚拟机所使用的零地址指令更加紧凑，但完成一项操作的时候必然需要使用更多的入栈和出栈指令，这同时也就意味着将需要个更多的指令分派次数和内存读、写次数。</p> <p>由于操作数时存储在内存中的，因此频繁地执行内存读、写操作必然会影响执行速度。为了解决这个问题，HotSpot JVM的设计者们提出了栈顶缓存技术，将栈顶元素全部缓存在物理CPU的寄存器中，以此降低对内存的读、写次数，提升执行引擎的执行效率。</p> <blockquote><p>寄存器：指令少，执行速度快。</p></blockquote> <h2 id="_7-动态链接-dynamic-linking"><a href="#_7-动态链接-dynamic-linking" class="header-anchor">#</a> 7. 动态链接（Dynamic Linking）</h2> <p>动态链接（或指向运行时常量池的方法引用）</p> <ul><li>每一个栈帧内部都包含一个指向<code>运行时常量池</code>中该栈帧所属方法的引用。包含这个引用的目的就是为了支持当前方法的代码能够实现动态链接（Dynamic Linking）。比如：invoedynamic指令。</li> <li>在Java源文件被编译到字节码文件中时，所有的变量和方法引用都作为符号引用（Symbolic Reference）保存在class文件的常量池里。比如：描述一个方法调动了另外的其他方法时，就是通过常量池中指向方法的符号引用来表示的，那么<code>动态链接的作用就是为了将这些符号引用转换为调用方法的直接引用</code>。</li></ul> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/10/02 8:30
 * @Description: &lt;h1&gt; 动态链接 （Dynamic Linking） &lt;/h1&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicLinkingTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;methodA...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">methodB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;methodB...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        num<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>字节码</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>D:<span class="token punctuation">\</span>java-code<span class="token punctuation">\</span>java<span class="token punctuation">\</span>jvm<span class="token punctuation">\</span>target<span class="token punctuation">\</span>classes<span class="token punctuation">\</span>com<span class="token punctuation">\</span>chggx<span class="token punctuation">\</span>jvm<span class="token punctuation">\</span>chapter05<span class="token punctuation">\</span>dynamiclink<span class="token operator">&gt;</span>javap
 <span class="token parameter variable">-v</span> DynamicLinkingTest.class
Classfile /D:/java-code/java/jvm/target/classes/com/chggx/jvm/chapter05/dynami
clink/DynamicLinkingTest.class
  Last modified <span class="token number">2020</span>-10-2<span class="token punctuation">;</span> size <span class="token number">742</span> bytes
  MD5 checksum e156713fd6bff7d2a0bb8902bdfc7995
  Compiled from <span class="token string">&quot;DynamicLinkingTest.java&quot;</span>
public class com.chggx.jvm.chapter05.dynamiclink.DynamicLinkingTest
  minor version: <span class="token number">0</span>
  major version: <span class="token number">52</span>
  flags: ACC_PUBLIC, ACC_SUPER
Constant pool: // 常量池
   <span class="token comment">#1 = Methodref          #9.#23         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
   <span class="token comment">#2 = Fieldref           #8.#24         // com/chggx/jvm/chapter05/dynamicli</span>
nk/DynamicLinkingTest.num:I
   <span class="token comment">#3 = Fieldref           #25.#26        // java/lang/System.out:Ljava/io/Pri</span>
ntStream<span class="token punctuation">;</span>
   <span class="token comment">#4 = String             #27            // methodA...</span>
   <span class="token comment">#5 = Methodref          #28.#29        // java/io/PrintStream.println:(Ljav</span>
a/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
   <span class="token comment">#6 = String             #30            // methodB...</span>
   <span class="token comment">#7 = Methodref          #8.#31         // com/chggx/jvm/chapter05/dynamicli</span>
nk/DynamicLinkingTest.methodA:<span class="token punctuation">(</span><span class="token punctuation">)</span>V
   <span class="token comment">#8 = Class              #32            // com/chggx/jvm/chapter05/dynamicli</span>
nk/DynamicLinkingTest
   <span class="token comment">#9 = Class              #33            // java/lang/Object</span>
  <span class="token comment">#10 = Utf8               num</span>
  <span class="token comment">#11 = Utf8               I</span>
  <span class="token comment">#12 = Utf8               &lt;init&gt;</span>
  <span class="token comment">#13 = Utf8               ()V</span>
  <span class="token comment">#14 = Utf8               Code</span>
  <span class="token comment">#15 = Utf8               LineNumberTable</span>
  <span class="token comment">#16 = Utf8               LocalVariableTable</span>
  <span class="token comment">#17 = Utf8               this</span>
  <span class="token comment">#18 = Utf8               Lcom/chggx/jvm/chapter05/dynamiclink/DynamicLinking</span>
Test<span class="token punctuation">;</span>
  <span class="token comment">#19 = Utf8               methodA</span>
  <span class="token comment">#20 = Utf8               methodB</span>
  <span class="token comment">#21 = Utf8               SourceFile</span>
  <span class="token comment">#22 = Utf8               DynamicLinkingTest.java</span>
  <span class="token comment">#23 = NameAndType        #12:#13        // &quot;&lt;init&gt;&quot;:()V</span>
  <span class="token comment">#24 = NameAndType        #10:#11        // num:I</span>
  <span class="token comment">#25 = Class              #34            // java/lang/System</span>
  <span class="token comment">#26 = NameAndType        #35:#36        // out:Ljava/io/PrintStream;</span>
  <span class="token comment">#27 = Utf8               methodA...</span>
  <span class="token comment">#28 = Class              #37            // java/io/PrintStream</span>
  <span class="token comment">#29 = NameAndType        #38:#39        // println:(Ljava/lang/String;)V</span>
  <span class="token comment">#30 = Utf8               methodB...</span>
  <span class="token comment">#31 = NameAndType        #19:#13        // methodA:()V</span>
  <span class="token comment">#32 = Utf8               com/chggx/jvm/chapter05/dynamiclink/DynamicLinkingT</span>
est
  <span class="token comment">#33 = Utf8               java/lang/Object</span>
  <span class="token comment">#34 = Utf8               java/lang/System</span>
  <span class="token comment">#35 = Utf8               out</span>
  <span class="token comment">#36 = Utf8               Ljava/io/PrintStream;</span>
  <span class="token comment">#37 = Utf8               java/io/PrintStream</span>
  <span class="token comment">#38 = Utf8               println</span>
  <span class="token comment">#39 = Utf8               (Ljava/lang/String;)V</span>
<span class="token punctuation">{</span>
  int num<span class="token punctuation">;</span>
    descriptor: I
    flags:

  public com.chggx.jvm.chapter05.dynamiclink.DynamicLinkingTest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: aload_0
         <span class="token number">1</span>: invokespecial <span class="token comment">#1                  // Method java/lang/Object.&quot;&lt;ini</span>
t<span class="token operator">&gt;</span>&quot;:<span class="token punctuation">(</span><span class="token punctuation">)</span>V
         <span class="token number">4</span>: aload_0
         <span class="token number">5</span>: bipush        <span class="token number">10</span>
         <span class="token number">7</span>: putfield      <span class="token comment">#2                  // Field num:I</span>
        <span class="token number">10</span>: <span class="token builtin class-name">return</span>
      LineNumberTable:
        line <span class="token number">8</span>: <span class="token number">0</span>
        line <span class="token number">10</span>: <span class="token number">4</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>      <span class="token number">11</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/dynamiclink/Dynam
icLinkingTest<span class="token punctuation">;</span>

  public void methodA<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: getstatic     <span class="token comment">#3                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
         <span class="token number">3</span>: ldc           <span class="token comment">#4                  // String methodA...</span>
         <span class="token number">5</span>: invokevirtual <span class="token comment">#5                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
         <span class="token number">8</span>: <span class="token builtin class-name">return</span>
      LineNumberTable:
        line <span class="token number">13</span>: <span class="token number">0</span>
        line <span class="token number">14</span>: <span class="token number">8</span>
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            <span class="token number">0</span>       <span class="token number">9</span>     <span class="token number">0</span>  this   Lcom/chggx/jvm/chapter05/dynamiclink/Dynam
icLinkingTest<span class="token punctuation">;</span>

  public void methodB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor: <span class="token punctuation">(</span><span class="token punctuation">)</span>V
    flags: ACC_PUBLIC
    Code:
      <span class="token assign-left variable">stack</span><span class="token operator">=</span><span class="token number">3</span>, <span class="token assign-left variable">locals</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">args_size</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span>: getstatic     <span class="token comment">#3                  // Field java/lang/System.out:Lj</span>
ava/io/PrintStream<span class="token punctuation">;</span>
         <span class="token number">3</span>: ldc           <span class="token comment">#6                  // String methodB...</span>
         <span class="token number">5</span>: invokevirtual <span class="token comment">#5                  // Method java/io/PrintStream.pr</span>
intln:<span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>V
         <span class="token number">8</span>: aload_0
         <span class="token number">9</span>: invokevirtual <span class="token comment">#7                  // Method methodA:()V</span>
        <span class="token number">12</span>: aload_0
        <span class="token number">13</span>: dup
        <span class="token number">14</span>: getfield      <span class="token comment">#2                  // Field num:I</span>
        <span class="token number">17</span>: iconst_1
        <span class="token number">18</span>: iadd
        <span class="token number">19</span>: putfield      <span class="token comment">#2                  // Field num:I</span>
        <span class="token number">22</span>: <span class="token builtin class-name">return</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br></div></div><blockquote><p>Methodref: 方法引用</p></blockquote> <h3 id="执行流程图"><a href="#执行流程图" class="header-anchor">#</a> 执行流程图</h3> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/02/084647-510500.png" alt=""></p> <h3 id="为什么需要常量池"><a href="#为什么需要常量池" class="header-anchor">#</a> 为什么需要常量池？</h3> <p>常量池的作用：就是为了提供一些符号和常量，便于指令的识别。</p> <h2 id="_8-方法的调用-解析与分派"><a href="#_8-方法的调用-解析与分派" class="header-anchor">#</a> 8. 方法的调用: 解析与分派</h2> <h3 id="静态链接和动态链接"><a href="#静态链接和动态链接" class="header-anchor">#</a> 静态链接和动态链接</h3> <ol><li>在JVM中，将符号引用转换为调用方法的直接引用与方法的绑定机制相关。</li></ol> <h4 id="静态链接"><a href="#静态链接" class="header-anchor">#</a> 静态链接：</h4> <p>当一个字节码文件被转装进JVM内部时，如果被调用的目标方法在<code>编译期</code>可知，且运行期保持不变时。这种情况下将调用方法的符号引用转换为直接引用的过程称之为静态链接。</p> <h4 id="动态链接"><a href="#动态链接" class="header-anchor">#</a> 动态链接：</h4> <p>如果被调用的方法在编译期无法被确定下来，也就是说，只能够在程序<code>运行期</code>将调用方法的符号引用转换为直接引用，由于这种引用转换过程具备动态性，因此也就被称之为动态链接。</p> <h3 id="早起绑定和晚期绑定"><a href="#早起绑定和晚期绑定" class="header-anchor">#</a> 早起绑定和晚期绑定</h3> <ol start="2"><li>对应的方法的绑定机制为：早起绑定和晚期绑定，绑定是一个字段、方法或者类在符号引用被替换为直接引用的过程，这仅仅发生一次。</li></ol> <h4 id="早期绑定"><a href="#早期绑定" class="header-anchor">#</a> 早期绑定</h4> <p>早期绑定就是指被调用的<code>目标方法如果在编译期可知，且运行期保持不变</code>时，级即可将这个方法与所述的类型进行绑定，这样一来，由于明确了被调用的目标方法究竟是哪一个，因此也就可以使用静态链接的方法将符号引用转换为直接引用。</p> <h4 id="晚期绑定"><a href="#晚期绑定" class="header-anchor">#</a> 晚期绑定</h4> <p>如果被调用的方法在<code>编译期无法被确定下来</code>，只能够在程序运行期根据实际的类型绑定相关的方法，这种绑定方式也就被称之为晚期绑定。</p> <h4 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/10/03 9:19
 * @Description: &lt;h1&gt; 早期绑定和晚期绑定 &lt;/h1&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;动物进食&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HuntAble</span><span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">hunt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token keyword">implements</span> <span class="token class-name">HuntAble</span><span class="token punctuation">{</span>

    <span class="token comment">// @Override</span>
    <span class="token comment">// public void hunt() {</span>
    <span class="token comment">//     System.out.println(&quot;狗吃骨头&quot;);</span>
    <span class="token comment">// }</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;捕食耗子，多管闲事&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token keyword">implements</span> <span class="token class-name">HuntAble</span><span class="token punctuation">{</span>

    <span class="token comment">/**
     * 表现为： 早期绑定
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 表现为： 早期绑定
     * @param name
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hunt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;猫吃鱼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 早期绑定</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;猫捉老鼠，天经地义&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 多态
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnimalTest</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 表现为： 晚期绑定
     * @param animal
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showAnimal</span><span class="token punctuation">(</span><span class="token class-name">Animal</span> animal<span class="token punctuation">)</span><span class="token punctuation">{</span>
        animal<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 表现为： 晚期绑定
     * @param huntAble
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showHunt</span><span class="token punctuation">(</span><span class="token class-name">HuntAble</span> huntAble<span class="token punctuation">)</span><span class="token punctuation">{</span>
        huntAble<span class="token punctuation">.</span><span class="token function">hunt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><blockquote><p>使用 jclasslib</p></blockquote> <p>随着高级语言的横空出世，蕾丝Java一样的基于面向对象的编程语言如今越来越多，尽管这类编程语言在语法风格上存在一定的差别，但是它们彼此之间始终保持着一个共性，那就是都支持<code>封装、继承和多态</code>等面向对象特性既然<code>这一类的编程语言具备多态特性，那么自然也就具备早期绑定和晚期绑定两种方式。</code></p> <p>Java中的任何一个普通的方法其实都具备虚函数的特性，它们相当于C++语言中的虚函数（C++则需要使用关键字virtual老显示定义）。如果在Java程序中不希望某个方法拥有虚函数的特征时，则可以使用关键字final来表标记这个方法。（final标记的方法不能被重写，无多态性）</p> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/03/095054-272314.png" alt=""></p> <blockquote><p>virtual: 对应上图标记处</p></blockquote> <h3 id="虚方法和非虚方法"><a href="#虚方法和非虚方法" class="header-anchor">#</a> 虚方法和非虚方法</h3> <h4 id="非虚方法"><a href="#非虚方法" class="header-anchor">#</a> 非虚方法</h4> <ul><li>如果方法在<code>编译期就确定了具体的调用版本，这个版本在运行时是不可变的</code>。这样的方法称为<code>非虚方法</code>。</li> <li><code>静态方法、私有方法、final方法、实例构造器、父类方法</code>都是废墟方法。</li> <li>其他方法称为虚方法。</li></ul> <blockquote><p>子类对象的多态性使用前提：</p> <p>​	① <code>类的继承关系</code></p> <p>​	② <code>方法的重写</code></p> <p>​	③ 与非虚方法相抵触</p></blockquote> <h4 id="虚拟机中提供了以下几条方法调用指令"><a href="#虚拟机中提供了以下几条方法调用指令" class="header-anchor">#</a> 虚拟机中提供了以下几条方法调用指令</h4> <ol><li>普通调用指令
<ul><li>invokestatic：调用静态方法，解析阶段确定唯一方法版本</li> <li>invokespecial：调用<code>&lt;init&gt;</code>方法、私有及父类方法，解析阶段确定唯一方法版本</li> <li>invokevirtual：调用所有虚方法</li> <li>invokeinterface：调用所接口</li></ul></li> <li>动态调用指令
<ul><li>invokedynamic：动态解析出需要调用的方法，然后执行</li></ul></li></ol> <blockquote><p>前四条指令固化在虚拟机内部，方法的调用执行不可人为干预，而invoedynamic指令则支持由用户确定方法版。其中<code>invokestatic指令和invoespecial指令调用的方法称为非虚方法，其余的（final修饰的除外）称为虚方法。</code></p></blockquote> <h5 id="普通调用指令示例"><a href="#普通调用指令示例" class="header-anchor">#</a> 普通调用指令示例</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/10/03 10:45
 * @Description: &lt;h1&gt; 虚拟机中提供了以下几条方法调用指令 &lt;/h1&gt;
 *  非虚方法
 *  - invokestatic：调用静态方法，解析阶段确定唯一方法版本
 *  - invokespecial：调用&lt;init&gt;方法、私有及父类方法，解析阶段确定唯一方法版本
 *  虚方法
 *  - invokevirtual：调用所有虚方法
 *  - invokeinterface：调用所接口
 */</span>
<span class="token keyword">class</span> <span class="token class-name">Father</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;father的构造器&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">showStatic</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;father &quot;</span> <span class="token operator">+</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">showFinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;father show final&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showCommon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;father 普通方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">Father</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// invokestatic</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// invokestatic</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 不是重写父类的静态方法，因为静态方法不能被重写
     * @param str
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">showStatic</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;son &quot;</span> <span class="token operator">+</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">showPrivate</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;son private &quot;</span> <span class="token operator">+</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/*非虚方法*/</span>
        <span class="token comment">// invokestatic</span>
        <span class="token function">showStatic</span><span class="token punctuation">(</span><span class="token string">&quot;chggx.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// invokestatic</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">showStatic</span><span class="token punctuation">(</span><span class="token string">&quot;good!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// invokespecial</span>
        <span class="token function">showPrivate</span><span class="token punctuation">(</span><span class="token string">&quot;hello！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// invokespecial</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">showCommon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// invokespecial</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">showFinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// invokevirtual 因为此方法声明有final，不能被子类重写，所以也被认为此方法是非虚方法。</span>
        <span class="token function">showFinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/*虚方法*/</span>
        <span class="token comment">// invokevirtual</span>
        <span class="token function">showCommon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// invokevirtual 自定义的方法</span>
        <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">MethodInterface</span> in <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// invokeinterface</span>
        in<span class="token punctuation">.</span><span class="token function">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">MethodInterface</span><span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br></div></div><h4 id="invokedynamic指令"><a href="#invokedynamic指令" class="header-anchor">#</a> invokedynamic指令</h4> <ol><li>JVM字节码指令集一直比较稳定，一直到Java7中才增加了一个invokedynamic指令，这是<code>Java为了实现 【动态类型语言】支持而做的一种改进。</code></li> <li>但是在Java7中并没有提供直接生成invokedynamic指令的方法，需要借助ASM这种底层字节码工具来产生invokedynamic指令。<code>直到Java8的Lambda表达式的出现，invokedynamic指令的生成，在Java中才有了直接的生成方式。</code></li> <li>Java7中增加的动态语言类型支持的本质是对Java虚拟机规范的修改。而不是对Java语言规则的修改，这一块相对来讲比较复杂，增加了虚拟机中的方法调用，最直接的受益者就是运行在Java平台的动态语言的编译器。</li></ol> <h5 id="动态类型语言和静态类型语言"><a href="#动态类型语言和静态类型语言" class="header-anchor">#</a> 动态类型语言和静态类型语言</h5> <p>动态类型语言和静态类型语言两者的区别就在于对类型的检查是在编译期还是在运行期，满足前者就是静态类型语言，反之是动态类型语言。</p> <p>说的再直白一点就是，<code>静态类型语言是判断变量自身的类型信息，动态类型语言是判断变量值的类型信息，变量没有类型信，变量值才有类型信息</code>，这是动态语言的一个重要特性。</p> <blockquote><p>Java：静态类型语言</p> <p>Python： 动态类型语言</p></blockquote> <p><strong>示例</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/10/03 15:49
 * @Description: &lt;h1&gt; 静态类型语言和动态类型语言 &lt;/h1&gt;
 * 体会 invokedynamic
 */</span>
<span class="token keyword">interface</span> <span class="token class-name">Func</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Lambda</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">lambda</span><span class="token punctuation">(</span><span class="token class-name">Func</span> func<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Lambda</span> lambda <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Func</span> func <span class="token operator">=</span> s<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        lambda<span class="token punctuation">.</span><span class="token function">lambda</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">;</span>

        lambda<span class="token punctuation">.</span><span class="token function">lambda</span><span class="token punctuation">(</span>s<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/03/155714-332610.png" alt=""></p> <blockquote><p>调用lambda表达式出现 invokedynamic 关键字</p></blockquote> <h3 id="方法的重写"><a href="#方法的重写" class="header-anchor">#</a> 方法的重写</h3> <h4 id="java语言中方法重写的本质"><a href="#java语言中方法重写的本质" class="header-anchor">#</a> Java语言中方法重写的本质</h4> <ol><li>找到操作数栈的第一个元素多执行的对象的实际类型，记作C。</li> <li>如果在类型C中找到与常量中的描述符合简单名称都相符的方法，则进行访问权限校验，如果通过则返回这个方法的直接引用，查找过程结束；如果不通过，则返回 <code>java.lang.IllegalAccessError 异常。</code></li> <li>否则，按照继承关系从下往上依次往C的各个弗雷进行第2步的搜索和验证过程。</li> <li>如果始终没有找到合适的方法，则抛出 <code>java.lang.AbstractMethodError 异常。</code></li></ol> <h4 id="illegalaccesserror-介绍"><a href="#illegalaccesserror-介绍" class="header-anchor">#</a> IllegalAccessError 介绍</h4> <p>程序试图访问或修改一个属性或调用一个方法，这个属性或方法，你没有权限访问。一般的，这个会引起编译器异常。这个错误如果发生在运行时，就说明一个了发生了不兼容的改变。</p> <h3 id="虚方法表"><a href="#虚方法表" class="header-anchor">#</a> 虚方法表</h3> <ul><li><p>在面向对象的编程中，会很频繁的使用到动态分派，如果在每次动态分派的过程中都要重新在类的方法元数据中搜索合适的目标的话就可能印象到执行效率。因此，为了提高程序性能，JVM采用在类的方法区建立一个虚方法表（virtual method table）(非虚方法不会出现在表中)来实现。使用索引表来代替查找。</p></li> <li><p>每个类中都有一个虚方法表，表中存放着各个方法的实际入口。</p></li> <li><p>那么虚方法表什么时候被创建？</p> <p><code>虚方法表会在类加载的链接阶段被创建并开始初始化，</code>类的变量初始值准备完成之后，JVM会把该类的方法表也初始化完毕。</p></li></ul> <h4 id="示例-3"><a href="#示例-3" class="header-anchor">#</a> 示例</h4> <p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202010/03/162101-587531.png" alt=""></p> <h2 id="_9-方法返回地址-return-address"><a href="#_9-方法返回地址-return-address" class="header-anchor">#</a> 9. 方法返回地址（Return Address）</h2> <ul><li><p>存放调用该方法的PC寄存器的值。</p></li> <li><p>一个方法的结束，用两种方式：</p> <p>正常执行 完成</p> <p>出现未处理的异常，非正常退出</p></li> <li><p>无论通过那种方式退出，在方法退出后都返回到该方法被调用的位置。方法正常退出时，调用者的pc计数器的值作为返回地址，即调用该方法的指令的下一条指令的地址。而通过异常退出的，返回地址是要通过异常表来确定，栈帧中一般不会保存这部分信息。</p></li> <li><p>本质上，方法的退出就是当前栈帧出栈的过程。此时，需要恢复上层方法的局部变量表、操作数栈、将返回值压入调用者栈帧的操作数栈、设置PC寄存器值等，让调用者方法继续执行下去。</p></li> <li><p><code>正常完成出口和异常完成出口的区别在于：通过异常完成出口退出的不会给他的上层调用者产生任何的返回值。</code></p></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReturnAddressTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">methodBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span> <span class="token function">methodByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">short</span> <span class="token function">methodShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">methodInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">methodLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0L</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">float</span> <span class="token function">methodFloat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0.0f</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">methodDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">methodString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">methodDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">methodVoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileReader</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">&quot;chggx.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chars <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><h4 id="当一个方法开始执行后-只有两种方式可以退出这个方法"><a href="#当一个方法开始执行后-只有两种方式可以退出这个方法" class="header-anchor">#</a> 当一个方法开始执行后，只有两种方式可以退出这个方法：</h4> <p>执行引擎遇到任意一个方法返回的字节码指令（return），会有返回值传递给上层的方法调用者，简称正产完成出口。</p> <ul><li>一个方法在正常调用完成之后究竟是用哪一种返回指令还需要根据方法返回值的实际数据类型而定。</li> <li>在字节码指令中，返回指令包含itrturn（方返回值是boolean、byte、char、short和int类型时使用）、lreturn（long）、freturn（float）、dreturn（double）、以及areturn（引用类型），另外还有一个return指令供声明为void的方法、实例初始化方法、类和接口的初始化方法使用。</li></ul> <p>在方法执行的过程中遇到了异常（Exception），并且这个异常没有在方法内进行处理，也就是只要在笨方法的异常表中没有搜索到匹配的异常处理器，就会导致方法退出。简称<code>异常完成出口。</code></p> <p>方法执行过程中抛出异常时的异常处理，存储在一个异常处理表，方便在发生异常的时候找到处理异常的代码。</p> <h2 id="_10-一些附加信息"><a href="#_10-一些附加信息" class="header-anchor">#</a> 10. 一些附加信息</h2> <p>栈帧中还允许携带与Java虚拟机实现相关的一些附加信息。例如，对程序调试提供支持的信息。</p> <h2 id="_11-栈的相关面试题"><a href="#_11-栈的相关面试题" class="header-anchor">#</a> 11. 栈的相关面试题</h2> <h3 id="_1-举例栈溢出的情况"><a href="#_1-举例栈溢出的情况" class="header-anchor">#</a> 1. 举例栈溢出的情况？</h3> <p>StackOverflowError</p> <ul><li>通过-Xss设置栈的大小；OOM</li></ul> <h3 id="_2-调整栈大小-就能保证不出现溢出吗"><a href="#_2-调整栈大小-就能保证不出现溢出吗" class="header-anchor">#</a> 2. 调整栈大小，就能保证不出现溢出吗？</h3> <p>不能</p> <h3 id="_3-分配的占内存越大越好吗"><a href="#_3-分配的占内存越大越好吗" class="header-anchor">#</a> 3. 分配的占内存越大越好吗？</h3> <p>不是</p> <h3 id="_4-垃圾回收是否会涉及到虚拟机栈"><a href="#_4-垃圾回收是否会涉及到虚拟机栈" class="header-anchor">#</a> 4. 垃圾回收是否会涉及到虚拟机栈？</h3> <p>不会的</p> <table><thead><tr><th></th> <th></th> <th>Gc</th></tr></thead> <tbody><tr><td></td> <td>×</td> <td>×</td></tr> <tr><td>虚拟机栈</td> <td>√</td> <td>×</td></tr> <tr><td>本地方法栈</td> <td>√</td> <td>×</td></tr> <tr><td>堆</td> <td>√</td> <td>√</td></tr> <tr><td>方法区</td> <td>√</td> <td>√</td></tr></tbody></table> <h3 id="_5-方法中定义的局部变量是否线程安全"><a href="#_5-方法中定义的局部变量是否线程安全" class="header-anchor">#</a> 5. 方法中定义的局部变量是否线程安全？</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @Author: CHGGX
 * @Date: 2020/10/03 22:16
 * @Description: &lt;h1&gt; 方法中定义的局部变量是否线程安全？  &lt;/h1&gt;
 *  何为线程安全？
 *      如果只有一个线程才可以操作此数据，则笔试线程安全的。
 *      如果有多个线程操作此数据，则此数据是共享数据。如果不考虑同步机制的话，会存在线程安全问题。
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringBuilderTest</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * s1的声明方式是线程安全的
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// StringBuilder：线程不安全</span>
        <span class="token class-name">StringBuilder</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * sb的操作过程：是线程不安全的
     * @param sb
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token class-name">StringBuilder</span> sb<span class="token punctuation">)</span><span class="token punctuation">{</span>
        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * builder的操作： 是线程不安全的
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">StringBuilder</span> <span class="token function">method3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * builder的操作： 是线程安全的 (类似于method1)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">method4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">method2</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/04/09, 08:32:37</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/797fac/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">程序计数器(PC寄存器)</div></a> <a href="/pages/38174c/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">本地方法接口</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/797fac/" class="prev">程序计数器(PC寄存器)</a></span> <span class="next"><a href="/pages/38174c/">本地方法接口</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:1348088236@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://gitee.com/afreebird" title="Gitee" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>晨光向 <br/> <a title="工信部备案号" target="_blank" href="http://beian.miit.gov.cn/">豫ICP备2023005584号</a> | <a  title="公安备案号" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41048202000165"> <img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303301208019.png" width="15px" height="15px"/>  豫公网安备 41048202000165号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://ts.cnlxc.cn/upFiles/music/别知己-海来阿木.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:10px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/music/1878406903.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/music/1878406903.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>别知己</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>海来阿木</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.77de9afe.js" defer></script><script src="/assets/js/2.7f8741fb.js" defer></script><script src="/assets/js/35.c6d5f3b6.js" defer></script><script src="/assets/js/3.7b4d6574.js" defer></script>
  </body>
</html>
