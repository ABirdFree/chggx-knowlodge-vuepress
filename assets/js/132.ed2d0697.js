(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{477:function(t,a,s){"use strict";s.r(a);var n=s(2),r=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"springcloud-h基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springcloud-h基础"}},[t._v("#")]),t._v(" SpringCloud.H基础")]),t._v(" "),a("blockquote",[a("p",[t._v("笔记日期：2020.5.20")])]),t._v(" "),a("h2",{attrs:{id:"_1-springboot2-x版和springcloud-h版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-springboot2-x版和springcloud-h版"}},[t._v("#")]),t._v(" 1. SpringBoot2.X版和SpringCloud H版")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("版本选择")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("2.2.2.RELEASE + Hoxton.SR1+ Meaven3.5及以上+MySQL5.7及以上+Java8")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("版本选择 2.2.5.RELEASE + Hoxton.SR3")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("SpringBoot2.1.4版和SpringCloud")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("G版")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-springboot-2-0-之后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-springboot-2-0-之后"}},[t._v("#")]),t._v(" 1. SpringBoot 2.0 之后")]),t._v(" "),a("p",[t._v("官网建议 2.0之后")]),t._v(" "),a("h3",{attrs:{id:"_2-springcloud"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-springcloud"}},[t._v("#")]),t._v(" 2. SpringCloud")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/springcloud%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E7%9A%84springboot%E7%89%88%E6%9C%AC.png?x-oss-process=style/shuiyin_1",alt:""}})]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_2-关于cloud组件的停更-升级-替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-关于cloud组件的停更-升级-替换"}},[t._v("#")]),t._v(" 2.关于Cloud组件的停更/升级/替换")]),t._v(" "),a("h3",{attrs:{id:"_1-停更前"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-停更前"}},[t._v("#")]),t._v(" 1. 停更前")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154503.png",alt:"20210223154503"}})]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_2-注册中心"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-注册中心"}},[t._v("#")]),t._v(" 2. 注册中心")]),t._v(" "),a("h4",{attrs:{id:"_1-eureka"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-eureka"}},[t._v("#")]),t._v(" 1. eureka")]),t._v(" "),a("p",[t._v("停更")]),t._v(" "),a("h4",{attrs:{id:"_2-zookeeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-zookeeper"}},[t._v("#")]),t._v(" 2. zookeeper")]),t._v(" "),a("p",[t._v("可以替换")]),t._v(" "),a("h4",{attrs:{id:"_3-consul"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-consul"}},[t._v("#")]),t._v(" 3. consul")]),t._v(" "),a("p",[t._v("可以替换(GO语言写的)")]),t._v(" "),a("h4",{attrs:{id:"_4-nacos-阿里"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-nacos-阿里"}},[t._v("#")]),t._v(" 4. Nacos (阿里)")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-服务的调用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-服务的调用"}},[t._v("#")]),t._v(" 3. 服务的调用")]),t._v(" "),a("h4",{attrs:{id:"_1-rabbon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-rabbon"}},[t._v("#")]),t._v(" 1. rabbon")]),t._v(" "),a("p",[t._v("还在使用")]),t._v(" "),a("h4",{attrs:{id:"_2-loadbalancer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-loadbalancer"}},[t._v("#")]),t._v(" 2. LoadBalancer")]),t._v(" "),a("p",[t._v("新的服务调用")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_4-服务的调用2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-服务的调用2"}},[t._v("#")]),t._v(" 4. 服务的调用2")]),t._v(" "),a("h4",{attrs:{id:"_1-feign"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-feign"}},[t._v("#")]),t._v(" 1. feign")]),t._v(" "),a("p",[t._v("挂了")]),t._v(" "),a("h4",{attrs:{id:"_2-openfeign"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-openfeign"}},[t._v("#")]),t._v(" 2. OpenFeign")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_5-降级服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-降级服务"}},[t._v("#")]),t._v(" 5. 降级服务")]),t._v(" "),a("h4",{attrs:{id:"_1-hystrix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-hystrix"}},[t._v("#")]),t._v(" 1. Hystrix")]),t._v(" "),a("p",[t._v("官网不用")]),t._v(" "),a("h4",{attrs:{id:"_2-resilience4j"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-resilience4j"}},[t._v("#")]),t._v(" 2.  resilience4j")]),t._v(" "),a("p",[t._v("国外推荐")]),t._v(" "),a("h4",{attrs:{id:"_3-sentienl-阿里"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-sentienl-阿里"}},[t._v("#")]),t._v(" 3. sentienl(阿里)")]),t._v(" "),a("p",[t._v("推荐")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_6-服务网关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-服务网关"}},[t._v("#")]),t._v(" 6. 服务网关")]),t._v(" "),a("h4",{attrs:{id:"_1-zuul"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-zuul"}},[t._v("#")]),t._v(" 1. zuul")]),t._v(" "),a("p",[t._v("挂了 (zuul死了)")]),t._v(" "),a("h4",{attrs:{id:"_2-gateway"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-gateway"}},[t._v("#")]),t._v(" 2. gateway")]),t._v(" "),a("p",[t._v("推荐")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_7-服务配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-服务配置"}},[t._v("#")]),t._v(" 7.  服务配置")]),t._v(" "),a("h4",{attrs:{id:"_1-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-config"}},[t._v("#")]),t._v(" 1. Config")]),t._v(" "),a("p",[t._v("不用")]),t._v(" "),a("h4",{attrs:{id:"_2-nocos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-nocos"}},[t._v("#")]),t._v(" 2.  Nocos")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_8-服务总线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-服务总线"}},[t._v("#")]),t._v(" 8. 服务总线")]),t._v(" "),a("h4",{attrs:{id:"_1-bus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-bus"}},[t._v("#")]),t._v(" 1. Bus")]),t._v(" "),a("p",[t._v("不用")]),t._v(" "),a("h4",{attrs:{id:"_2-nacos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-nacos"}},[t._v("#")]),t._v(" 2. Nacos")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_3-微服务架构编码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-微服务架构编码"}},[t._v("#")]),t._v(" 3. 微服务架构编码")]),t._v(" "),a("h3",{attrs:{id:"_1-订单-支付模块微服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-订单-支付模块微服务"}},[t._v("#")]),t._v(" 1. "),a("strong",[t._v("订单-支付模块微服务")])]),t._v(" "),a("p",[t._v("https://blog.csdn.net/qq_41211642/article/details/104772140")]),t._v(" "),a("p",[t._v("参考此博客")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_2-actuator微服务信息完善"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-actuator微服务信息完善"}},[t._v("#")]),t._v(" 2. actuator微服务信息完善")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/qq_41211642/article/details/104802731")]),t._v(" "),a("h4",{attrs:{id:"_1-主机名称-服务名称修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-主机名称-服务名称修改"}},[t._v("#")]),t._v(" 1. 主机名称：服务名称修改")]),t._v(" "),a("h5",{attrs:{id:"_1-当前问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-当前问题"}},[t._v("#")]),t._v(" 1. 当前问题：")]),t._v(" "),a("p",[a("code",[t._v("服务注册含有主机名称，要想按照规范的要求，只暴露服务名，不要出现主机名")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154556.png",alt:""}})]),t._v(" "),a("h5",{attrs:{id:"_2-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置"}},[t._v("#")]),t._v(" 2. 配置")]),t._v(" "),a("p",[a("strong",[t._v("依赖")]),t._v("标配")]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-web"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-actuator"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("application.yml  eureka中添加")]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 主机名的修改")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("instance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("instance-id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" order80\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154613.png",alt:""}})]),t._v(" "),a("h5",{attrs:{id:"_3-效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-效果"}},[t._v("#")]),t._v(" 3. 效果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154640.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"_2-ip提示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ip提示"}},[t._v("#")]),t._v(" 2. IP提示")]),t._v(" "),a("h5",{attrs:{id:"_1-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置"}},[t._v("#")]),t._v(" 1. 配置")]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问路径可以显示IP地址")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("prefer-ip-address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154656.png",alt:""}})]),t._v(" "),a("h5",{attrs:{id:"_2-效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-效果"}},[t._v("#")]),t._v(" 2. 效果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154707.png",alt:""}})]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-服务发现discovery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-服务发现discovery"}},[t._v("#")]),t._v(" 3. 服务发现Discovery")]),t._v(" "),a("p",[a("code",[t._v("对于注册进入eureka里面的服务,可以通过服务发现来获取该服务信息")])]),t._v(" "),a("p",[t._v("https://blog.csdn.net/qq_41211642/article/details/104803913")]),t._v(" "),a("h4",{attrs:{id:"_1-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用"}},[t._v("#")]),t._v(" 1. 使用")]),t._v(" "),a("h5",{attrs:{id:"_1-启动类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动类"}},[t._v("#")]),t._v(" 1. 启动类")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableDiscoveryClient")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h5",{attrs:{id:"_2-代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-代码"}},[t._v("#")]),t._v(" 2. 代码")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Resource")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DiscoveryClient")]),t._v(" discoveryClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/discovery"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("discovery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. getServices 获取服务信息")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" discoveryClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"服务信息: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. serviceId: eureka对外暴露的服务实例, 如CLOUD-PAYMENT-SERVICE, CLOUD-ORDER-SERVER")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" instances "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" discoveryClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstances")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CLOUD-PAYMENT-SERVICE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        instances"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\t"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\t"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("discoveryClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("hr"),t._v(" "),a("h3",{attrs:{id:"_4-eureka自我保护理论知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-eureka自我保护理论知识"}},[t._v("#")]),t._v(" 4. Eureka自我保护理论知识")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/qq_41211642/article/details/104804049")]),t._v(" "),a("h4",{attrs:{id:"_1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[t._v("#")]),t._v(" 1. 概述：")]),t._v(" "),a("p",[t._v("保护模式主要用于一组客户端和Eureka Server之间存在网络分区场景下的保护，一旦进入保护模式，Eureka Server将会尝试保护其服务注册表中的信息，不再删除服务注册表中的数据，也就是不会注销任何微服务。\n一句话： 某时刻某一个微服务不可用了，Eureka不会立刻清理，依旧会对该微服务的信息进行保存。")]),t._v(" "),a("p",[t._v("如果在Eureka Server的首页看到以下这段提示，则说明Eureka进入了保护模式。属于CAP里面的AP分支。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154722.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"_2-解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-解决"}},[t._v("#")]),t._v(" 2. 解决")]),t._v(" "),a("h5",{attrs:{id:"_1-eureka服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-eureka服务端"}},[t._v("#")]),t._v(" 1. eureka服务端")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154737.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154807.png",alt:""}})]),t._v(" "),a("h5",{attrs:{id:"_2-客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-客户端"}},[t._v("#")]),t._v(" 2. 客户端")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154759.png",alt:""}})]),t._v(" "),a("p",[t._v("但客户端挂了后,eureka直接删除")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154819.png",alt:""}})]),t._v(" "),a("p",[t._v("宕机")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154827.png",alt:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);