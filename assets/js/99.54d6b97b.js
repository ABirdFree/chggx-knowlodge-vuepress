(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{423:function(t,a,s){"use strict";s.r(a);var e=s(7),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"nginx核心配置文件结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx核心配置文件结构"}},[t._v("#")]),t._v(" Nginx核心配置文件结构")]),t._v(" "),a("p",[t._v("我们知道Nginx的核心配置文件默认是放在"),a("code",[t._v("/usr/local/nginx/conf/nginx.conf")]),t._v("，nginx配置格式如下")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("worker_processes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" 1;")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("events")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    worker_connections")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" 1024;")]),t._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("      mime.types;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    default_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" application/octet-stream;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    sendfile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("       on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    keepalive_timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" 65;")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("      80;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        server_name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" localhost;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n        }\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  500 502 503 504  /50x.html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/50x.html {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  html;")]),t._v("\n        }\n    }\n\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br")])]),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("指令名\t指令值;  # 全局块，主要设置Nginx服务器整体运行的配置指令\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v(" # events块,主要设置,Nginx服务器与用户的网络连接,这一部分对Nginx服务器的性能影响较大")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("events")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{\t ")]),t._v("\n    指令名\t指令值;\n}\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#http块，是Nginx服务器配置中的重要部分，代理、缓存、日志记录、第三方模块配置...             ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{\t\t")]),t._v("\n    指令名\t指令值;\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{ #server块，是Nginx配置和虚拟主机相关的内容")]),t._v("\n        指令名\t指令值;\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ { ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("        #location块，基于Nginx服务器接收请求字符串与location后面的值进行匹配，对特定请求进行处理")]),t._v("\n            指令名\t指令值;\n        }\n    }\n\t...\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("blockquote",[a("p",[t._v("简单小结下:")]),t._v(" "),a("p",[t._v("nginx.conf配置文件中默认有三大块：全局块、events块、http块")]),t._v(" "),a("p",[t._v("http块中可以配置多个server块，每个server块又可以配置多个location块。")])]),t._v(" "),a("h2",{attrs:{id:"_1-全局块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-全局块"}},[t._v("#")]),t._v(" 1. 全局块")]),t._v(" "),a("h3",{attrs:{id:"user指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#user指令"}},[t._v("#")]),t._v(" user指令 🚗")]),t._v(" "),a("p",[t._v("（1）user:用于配置运行Nginx服务器的worker进程的用户和用户组。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("user user [group]")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("nobody")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块")])])])]),t._v(" "),a("p",[t._v("该属性也可以在编译的时候指定，语法如下"),a("code",[t._v("./configure --user=user --group=group")]),t._v(",如果两个地方都进行了设置，最终生效的是配置文件中的配置。")]),t._v(" "),a("p",[t._v("该指令的使用步骤:")]),t._v(" "),a("p",[t._v('(1)设置一个用户信息"www"')]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("user www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303152113884.png",alt:"1586597350943"}})]),t._v(" "),a("p",[t._v("(2) 创建一个用户")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" www\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("(3)修改user属性")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("user www\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("(4)创建"),a("code",[t._v("/root/html/index.html")]),t._v("页面，添加如下内容")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Welcome to nginx!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token style"}},[a("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("body")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 35em"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("margin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0 auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("font-family")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Tahoma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Verdana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Arial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sans-serif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Welcome to nginx!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("For online documentation and support please refer to\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://nginx.org/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("nginx.org"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("br")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\nCommercial support is available at\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://nginx.com/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("nginx.com"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("em")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Thank you for using nginx."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("em")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("em")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I am WWW"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("em")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br")])]),a("p",[t._v("(5)修改nginx.conf")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\troot")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  /root/html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tindex")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("(5)测试启动访问")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("页面会报403拒绝访问的错误\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("(6)分析原因")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("因为当前用户没有访问/root/html目录的权限\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("(7)将文件创建到 "),a("code",[t._v("/home/www/html/index.html")]),t._v(",修改配置")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\troot")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  /home/www/html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tindex")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("(8)再次测试启动访问")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("能正常访问。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("综上所述，使用user指令可以指定启动运行工作进程的用户及用户组，这样对于系统的权限访问控制的更加精细，也更加安全。")]),t._v(" "),a("h3",{attrs:{id:"work-process指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#work-process指令"}},[t._v("#")]),t._v(" work process指令")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("master_process")]),t._v(": 用来指定是否开启工作进程。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("master_process on|off;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("master_process on;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块")])])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("worker_processes")]),t._v(":用于配置Nginx生成工作进程的数量，这个是Nginx服务器实现并发处理服务的关键所在。理论上来说workder process的值越大，可以支持的并发处理量也越多，但事实上这个值的设定是需要受到来自服务器自身的限制，建议将该值和服务器CPU的内核数保存一致。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("worker_processes     num/auto;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("1")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块")])])])]),t._v(" "),a("p",[t._v("如果将worker_processes设置成2，则会看到如下内容:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303152113452.png",alt:"1581563242526"}})]),t._v(" "),a("blockquote",[a("p",[t._v("需要关闭服务，重新启动。")])]),t._v(" "),a("h3",{attrs:{id:"其他指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他指令"}},[t._v("#")]),t._v(" 其他指令")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("daemon")]),t._v("：设定Nginx是否以守护进程的方式启动。")])]),t._v(" "),a("p",[t._v("守护式进程是linux后台执行的一种服务进程，特点是独立于控制终端，不会随着终端关闭而停止。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("daemon on|off;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("daemon on;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("需要关闭服务，重新启动。")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("pid")]),t._v(":用来配置Nginx当前master进程的进程号ID存储的文件路径。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("pid file;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("默认为:/usr/local/nginx/logs/nginx.pid")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块")])])])]),t._v(" "),a("p",[t._v("该属性可以通过"),a("code",[t._v("./configure --pid-path=PATH")]),t._v("来指定")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("error_log")]),t._v(":用来配置Nginx的错误日志存放路径")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("error_log  file [日志级别];")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("error_log logs/error.log error;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("全局块、http、server、location")])])])]),t._v(" "),a("p",[t._v("该属性可以通过"),a("code",[t._v("./configure --error-log-path=PATH")]),t._v("来指定")]),t._v(" "),a("p",[t._v("其中日志级别的值有：debug|info|notice|warn|error|crit|alert|emerg，翻译过来为试|信息|通知|警告|错误|临界|警报|紧急，这块建议大家设置的时候不要设置成info以下的等级，因为会带来大量的磁盘I/O消耗，影响Nginx的性能。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("include")]),t._v(":用来引入其他配置文件，使Nginx的配置更加灵活[[[]]]")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("include file;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("无")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("any")])])])]),t._v(" "),a("h2",{attrs:{id:"_2-events块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-events块"}},[t._v("#")]),t._v(" 2. events块")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("accept_mutex")]),t._v(":用来设置Nginx网络连接序列化")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("accept_mutex on|off;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("accept_mutex on;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("events")])])])]),t._v(" "),a("p",[t._v('这个配置主要可以用来解决常说的"'),a("code",[t._v("惊群")]),t._v('"问题。大致意思是在某一个时刻，客户端发来一个请求连接，Nginx后台是以多进程的工作模式，也就是说有多个worker进程会被同时唤醒，但是最终只会有一个进程可以获取到连接，如果每次唤醒的进程数目太多，就会影响Nginx的整体性能。如果将上述值设置为on(开启状态)，将会对多个Nginx进程接收连接进行序列号，一个个来唤醒接收，就防止了多个进程对连接的争抢。')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303152113904.png",alt:"1581566971955"}})]),t._v(" "),a("ul",[a("li",[a("code",[t._v("multi_accept")]),t._v(":用来设置是否允许同时接收多个网络连接")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("multi_accept on|off;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("multi_accept off;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("events")])])])]),t._v(" "),a("p",[t._v("如果multi_accept被禁止了，nginx一个工作进程只能同时接受一个新的连接。否则，一个工作进程可以同时接受所有的新连接")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("worker_connections")]),t._v("：用来配置单个worker进程最大的连接数")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("worker_connections number;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("worker_commections 512;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("events")])])])]),t._v(" "),a("p",[t._v("这里的连接数不仅仅包括和前端用户建立的连接数，而是包括所有可能的连接数。另外，number值不能大于操作系统支持打开的最大文件句柄数量。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("use")]),t._v(":用来设置Nginx服务器选择哪种事件驱动来处理网络消息。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("use  method;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("根据操作系统定")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("events")])])])]),t._v(" "),a("p",[t._v("注意：此处所选择事件处理模型是Nginx优化部分的一个重要内容，method的可选值有select/poll/epoll/kqueue等，之前在准备centos环境的时候，我们强调过要使用linux内核在2.6以上，就是为了能使用epoll函数来优化Nginx。")]),t._v(" "),a("p",[t._v("另外这些值的选择，我们也可以在编译的时候使用")]),t._v(" "),a("p",[a("code",[t._v("--with-select_module")]),t._v("、"),a("code",[t._v("--without-select_module")]),t._v("、")]),t._v(" "),a("p",[a("code",[t._v("--with-poll_module")]),t._v("、"),a("code",[t._v("--without-poll_module")]),t._v("来设置是否需要将对应的事件驱动模块编译到Nginx的内核。")]),t._v(" "),a("h3",{attrs:{id:"events指令配置实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#events指令配置实例"}},[t._v("#")]),t._v(" events指令配置实例")]),t._v(" "),a("p",[t._v("打开Nginx的配置文件 nginx.conf,添加如下配置")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("events{\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\taccept_mutex")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tmulti_accept")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tworker_commections")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1024;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tuse")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("epoll;")]),t._v("\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("启动测试")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("./nginx")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("-t")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("./nginx")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("-s reload")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"_3-http块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-http块"}},[t._v("#")]),t._v(" 3. http块")]),t._v(" "),a("h3",{attrs:{id:"定义mime-type"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义mime-type"}},[t._v("#")]),t._v(" 定义MIME-Type")]),t._v(" "),a("p",[t._v("我们都知道浏览器中可以显示的内容有HTML、XML、GIF等种类繁多的文件、媒体等资源，浏览器为了区分这些资源，就需要使用MIME Type。所以说MIME Type是网络资源的媒体类型。Nginx作为web服务器，也需要能够识别前端请求的资源类型。")]),t._v(" "),a("p",[t._v("在Nginx的配置文件中，默认有两行配置")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("mime.types;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("default_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("application/octet-stream;")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("default_type")]),t._v(":用来配置Nginx响应前端请求默认的MIME类型。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("default_type mime-type;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("default_type text/plain；")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("http、server、location")])])])]),t._v(" "),a("p",[t._v("在default_type之前还有一句"),a("code",[t._v("include mime.types")]),t._v(",include之前我们已经介绍过，相当于把mime.types文件中MIMT类型与相关类型文件的文件后缀名的对应关系加入到当前的配置文件中。")]),t._v(" "),a("p",[t._v("举例来说明：")]),t._v(" "),a("p",[t._v("有些时候请求某些接口的时候需要返回指定的文本字符串或者json字符串，如果逻辑非常简单或者干脆是固定的字符串，那么可以使用nginx快速实现，这样就不用编写程序响应请求了，可以减少服务器资源占用并且响应性能非常快。")]),t._v(" "),a("p",[t._v("如何实现:")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/get_text {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\t#这里也可以设置成text/plain")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    default_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("text/html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('200 "This is nginx\'s text";')]),t._v("\n}\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/get_json{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    default_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("application/json;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('200 \'{"name":"TOM","age":18}\';')]),t._v("\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("blockquote",[a("p",[t._v("application/octet-stream、text/plain、text/html、application/json")])]),t._v(" "),a("h3",{attrs:{id:"自定义服务日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义服务日志"}},[t._v("#")]),t._v(" 自定义服务日志")]),t._v(" "),a("p",[t._v("Nginx中日志的类型分"),a("code",[t._v("access.log")]),t._v("、"),a("code",[t._v("error.log")]),t._v("。")]),t._v(" "),a("p",[a("code",[t._v("access.log")]),t._v(":用来记录用户所有的访问请求。")]),t._v(" "),a("p",[a("code",[t._v("error.log")]),t._v(":记录nginx本身运行时的错误信息，不会记录用户的访问请求。")]),t._v(" "),a("p",[t._v("Nginx服务器支持对服务日志的格式、大小、输出等进行设置，需要使用到两个指令，分别是access_log和log_format指令。")]),t._v(" "),a("ul",[a("li",[t._v("access_log:用来设置用户访问日志的相关属性。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("access_log path[format[buffer=size]]")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("access_log logs/access.log combined;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[a("code",[t._v("http")]),t._v(", "),a("code",[t._v("server")]),t._v(", "),a("code",[t._v("location")])])])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303181852254.png",alt:"image-20230318185233219"}})]),t._v(" "),a("ul",[a("li",[t._v("log_format:用来指定日志的输出格式。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("log_format name [escape=default|json|none] string....;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v('log_format combined "...";')])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("http")])])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303181851282.png",alt:"image-20230318185129240"}})]),t._v(" "),a("h3",{attrs:{id:"其他配置指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他配置指令"}},[t._v("#")]),t._v(" 其他配置指令")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("sendfile")]),t._v(":用来设置Nginx服务器是否使用sendfile()传输文件，该属性"),a("code",[t._v("可以大大提高Nginx处理静态资源的性能")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("sendfile on|off；")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("sendfile off;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("http、server、location")])])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("keepalive_timeout")]),t._v(":用来设置长连接的超时时间。")])]),t._v(" "),a("blockquote",[a("p",[t._v("为什么要使用keepalive？")])]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("我们都知道HTTP是一种无状态协议，客户端向服务端发送一个TCP请求，服务端响应完毕后断开连接。\n如何客户端向服务端发送多个请求，每个请求都需要重新创建一次连接，效率相对来说比较多，使用keepalive模式，可以告诉服务器端在处理完一个请求后保持这个TCP连接的打开状态，若接收到来自这个客户端的其他请求，服务端就会利用这个未被关闭的连接，而不需要重新创建一个新连接，提升效率，但是这个连接也不能一直保持，这样的话，连接如果过多，也会是服务端的性能下降，这个时候就需要我们进行设置其的超时时间。\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("keepalive_timeout time;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("keepalive_timeout 75s;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("http、server、location")])])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("keepalive_requests")]),t._v(":用来设置一个keep-alive连接使用的次数。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("keepalive_requests number;")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("默认值")]),t._v(" "),a("td",[t._v("keepalive_requests 100;")])]),t._v(" "),a("tr",[a("td",[t._v("位置")]),t._v(" "),a("td",[t._v("http、server、location")])])])]),t._v(" "),a("h2",{attrs:{id:"_4-server块和location块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-server块和location块"}},[t._v("#")]),t._v(" 4. server块和location块")]),t._v(" "),a("p",[t._v("server块和location块都是我们要重点讲解和学习的内容，因为我们后面会对Nginx的功能进行详细讲解，所以这块内容就放到静态资源部署的地方给大家详细说明。")]),t._v(" "),a("p",[t._v("本节我们主要来认识下Nginx默认给的nginx.conf中的相关内容，以及server块与location块在使用的时候需要注意的一些内容。")]),t._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\tserver")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("      80;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        server_name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" localhost;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n        }\n       \n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  500 502 503 504 404  /50x.html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/50x.html {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  html;")]),t._v("\n        }\n    }\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);