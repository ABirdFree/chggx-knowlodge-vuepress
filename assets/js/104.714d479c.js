(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{426:function(a,s,t){"use strict";t.r(s);var e=t(7),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"nginxç¼“å­˜é›†æˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginxç¼“å­˜é›†æˆ"}},[a._v("#")]),a._v(" Nginxç¼“å­˜é›†æˆ")]),a._v(" "),s("h2",{attrs:{id:"_1-ç¼“å­˜çš„æ¦‚å¿µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç¼“å­˜çš„æ¦‚å¿µ"}},[a._v("#")]),a._v(" 1. ç¼“å­˜çš„æ¦‚å¿µ")]),a._v(" "),s("p",[a._v("ç¼“å­˜å°±æ˜¯æ•°æ®äº¤æ¢çš„ç¼“å†²åŒº(ç§°ä½œ:Cache),å½“ç”¨æˆ·è¦è·å–æ•°æ®çš„æ—¶å€™ï¼Œä¼šå…ˆä»ç¼“å­˜ä¸­å»æŸ¥è¯¢è·å–æ•°æ®ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰å°±ä¼šç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåˆ™ä¼šå‘è¯·æ±‚ä»æœåŠ¡å™¨é‡æ–°æŸ¥è¯¢æ•°æ®ï¼Œå°†æ•°æ®è¿”å›ç»™ç”¨æˆ·çš„åŒæ—¶å°†æ•°æ®æ”¾å…¥ç¼“å­˜ï¼Œä¸‹æ¬¡ç”¨æˆ·å°±ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303182022263.png",alt:"1591944051969"}})]),a._v(" "),s("p",[a._v("ç¼“å­˜å…¶å®åœ¨å¾ˆå¤šåœºæ™¯ä¸­éƒ½æœ‰ç”¨åˆ°ï¼Œæ¯”å¦‚ï¼š")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("åœºæ™¯")]),a._v(" "),s("th",[a._v("ä½œç”¨")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("æ“ä½œç³»ç»Ÿç£ç›˜ç¼“å­˜")]),a._v(" "),s("td",[a._v("å‡å°‘ç£ç›˜æœºæ¢°æ“ä½œ")])]),a._v(" "),s("tr",[s("td",[a._v("æ•°æ®åº“ç¼“å­˜")]),a._v(" "),s("td",[a._v("å‡å°‘æ–‡ä»¶ç³»ç»Ÿçš„IOæ“ä½œ")])]),a._v(" "),s("tr",[s("td",[a._v("åº”ç”¨ç¨‹åºç¼“å­˜")]),a._v(" "),s("td",[a._v("å‡å°‘å¯¹æ•°æ®åº“çš„æŸ¥è¯¢")])]),a._v(" "),s("tr",[s("td",[a._v("WebæœåŠ¡å™¨ç¼“å­˜")]),a._v(" "),s("td",[a._v("å‡å°‘å¯¹åº”ç”¨æœåŠ¡å™¨è¯·æ±‚æ¬¡æ•°")])]),a._v(" "),s("tr",[s("td",[a._v("æµè§ˆå™¨ç¼“å­˜")]),a._v(" "),s("td",[a._v("å‡å°‘ä¸åå°çš„äº¤äº’æ¬¡æ•°")])])])]),a._v(" "),s("p",[a._v("ç¼“å­˜çš„ä¼˜ç‚¹")]),a._v(" "),s("p",[a._v("â€‹\t1.å‡å°‘æ•°æ®ä¼ è¾“ï¼ŒèŠ‚çœç½‘ç»œæµé‡ï¼ŒåŠ å¿«å“åº”é€Ÿåº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼›")]),a._v(" "),s("p",[a._v("â€‹\t2.å‡è½»æœåŠ¡å™¨å‹åŠ›ï¼›")]),a._v(" "),s("p",[a._v("â€‹\t3.æä¾›æœåŠ¡ç«¯çš„é«˜å¯ç”¨æ€§ï¼›")]),a._v(" "),s("p",[a._v("ç¼“å­˜çš„ç¼ºç‚¹")]),a._v(" "),s("p",[a._v("â€‹\t1.æ•°æ®çš„ä¸ä¸€è‡´")]),a._v(" "),s("p",[a._v("â€‹\t2.å¢åŠ æˆæœ¬")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303182022816.png",alt:"1582295367198"}})]),a._v(" "),s("p",[a._v("æœ¬æ¬¡è¯¾ç¨‹æ³¨è§£è®²è§£çš„æ˜¯Nginx,Nginxä½œä¸ºwebæœåŠ¡å™¨ï¼ŒNginxä½œä¸ºWebç¼“å­˜æœåŠ¡å™¨ï¼Œå®ƒä»‹äºå®¢æˆ·ç«¯å’Œåº”ç”¨æœåŠ¡å™¨ä¹‹é—´ï¼Œå½“ç”¨æˆ·é€šè¿‡æµè§ˆå™¨è®¿é—®ä¸€ä¸ªURLæ—¶ï¼Œwebç¼“å­˜æœåŠ¡å™¨ä¼šå»åº”ç”¨æœåŠ¡å™¨è·å–è¦å±•ç¤ºç»™ç”¨æˆ·çš„å†…å®¹ï¼Œå°†å†…å®¹ç¼“å­˜åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå½“ä¸‹ä¸€æ¬¡è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå¦‚æœè®¿é—®çš„æ˜¯åŒä¸€ä¸ªURLï¼Œwebç¼“å­˜æœåŠ¡å™¨å°±ä¼šç›´æ¥å°†ä¹‹å‰ç¼“å­˜çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸æ˜¯å‘åº”ç”¨æœåŠ¡å™¨å†æ¬¡å‘é€è¯·æ±‚ã€‚webç¼“å­˜é™ä½äº†åº”ç”¨æœåŠ¡å™¨ã€æ•°æ®åº“çš„è´Ÿè½½ï¼Œå‡å°‘äº†ç½‘ç»œå»¶è¿Ÿï¼Œæé«˜äº†ç”¨æˆ·è®¿é—®çš„å“åº”é€Ÿåº¦ï¼Œå¢å¼ºäº†ç”¨æˆ·çš„ä½“éªŒã€‚")]),a._v(" "),s("h2",{attrs:{id:"_2-nginxçš„webç¼“å­˜æœåŠ¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-nginxçš„webç¼“å­˜æœåŠ¡"}},[a._v("#")]),a._v(" 2. Nginxçš„webç¼“å­˜æœåŠ¡")]),a._v(" "),s("p",[a._v("Nginxæ˜¯ä»0.7.48ç‰ˆå¼€å§‹æä¾›ç¼“å­˜åŠŸèƒ½ã€‚Nginxæ˜¯åŸºäºProxy Storeæ¥å®ç°çš„ï¼Œå…¶åŸç†æ˜¯æŠŠURLåŠç›¸å…³ç»„åˆå½“åšKey,åœ¨ä½¿ç”¨MD5ç®—æ³•å¯¹Keyè¿›è¡Œå“ˆå¸Œï¼Œå¾—åˆ°ç¡¬ç›˜ä¸Šå¯¹åº”çš„å“ˆå¸Œç›®å½•è·¯å¾„ï¼Œä»è€Œå°†ç¼“å­˜å†…å®¹ä¿å­˜åœ¨è¯¥ç›®å½•ä¸­ã€‚å®ƒå¯ä»¥æ”¯æŒä»»æ„URLè¿æ¥ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ404/301/302è¿™æ ·çš„é200çŠ¶æ€ç ã€‚Nginxå³å¯ä»¥æ”¯æŒå¯¹æŒ‡å®šURLæˆ–è€…çŠ¶æ€ç è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨purgeå‘½ä»¤æ¥æ‰‹åŠ¨æ¸…é™¤æŒ‡å®šURLçš„ç¼“å­˜ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303182022976.png",alt:"1591947990200"}})]),a._v(" "),s("h2",{attrs:{id:"_3-nginxç¼“å­˜è®¾ç½®çš„ç›¸å…³æŒ‡ä»¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginxç¼“å­˜è®¾ç½®çš„ç›¸å…³æŒ‡ä»¤"}},[a._v("#")]),a._v(" 3. Nginxç¼“å­˜è®¾ç½®çš„ç›¸å…³æŒ‡ä»¤ ğŸ˜„")]),a._v(" "),s("p",[a._v("Nginxçš„webç¼“å­˜æœåŠ¡ä¸»è¦æ˜¯ä½¿ç”¨"),s("code",[a._v("ngx_http_proxy_module")]),a._v("æ¨¡å—ç›¸å…³æŒ‡ä»¤é›†æ¥å®Œæˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå¸¸ç”¨çš„æŒ‡ä»¤æ¥è¿›è¡Œä»‹ç»ä¸‹ã€‚")]),a._v(" "),s("h3",{attrs:{id:"proxy-cache-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache-path"}},[a._v("#")]),a._v(" proxy_cache_path")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡å®šç”¨äºè®¾ç½®ç¼“å­˜æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_path path [levels=number] "),s("br"),a._v("keys_zone=zone_name:zone_size [inactive=time][max_size=size];")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("â€”")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("http")])])])]),a._v(" "),s("p",[a._v("path:ç¼“å­˜è·¯å¾„åœ°å€,å¦‚ï¼š")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("/usr/local/proxy_cache\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("levels: æŒ‡å®šè¯¥ç¼“å­˜ç©ºé—´å¯¹åº”çš„ç›®å½•ï¼Œæœ€å¤šå¯ä»¥è®¾ç½®3å±‚ï¼Œæ¯å±‚å–å€¼ä¸º1|2å¦‚ :")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1:2   ç¼“å­˜ç©ºé—´æœ‰ä¸¤å±‚ç›®å½•ï¼Œç¬¬ä¸€æ¬¡æ˜¯1ä¸ªå­—æ¯ï¼Œç¬¬äºŒæ¬¡æ˜¯2ä¸ªå­—æ¯")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ä¸¾ä¾‹è¯´æ˜")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("itheima[key]é€šè¿‡MD5åŠ å¯†ä»¥åçš„å€¼ä¸º")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("43c8233266edce38c2c9af0694e2107d")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1:2   æœ€ç»ˆçš„å­˜å‚¨è·¯å¾„ä¸º/usr/local/proxy_cache/d/07")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2:1:2 æœ€ç»ˆçš„å­˜å‚¨è·¯å¾„ä¸º/usr/local/proxy_cache/7d/0/21")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2:2:2 æœ€ç»ˆçš„å­˜å‚¨è·¯å¾„ä¸º??/usr/local/proxy_cache/7d/10/e2")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("keys_zone:ç”¨æ¥ä¸ºè¿™ä¸ªç¼“å­˜åŒºè®¾ç½®åç§°å’ŒæŒ‡å®šå¤§å°ï¼Œå¦‚ï¼š")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("keys_zone")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("itcast:200m  ç¼“å­˜åŒºçš„åç§°æ˜¯itcast,å¤§å°ä¸º200M,1Må¤§æ¦‚èƒ½å­˜å‚¨8000ä¸ªkeys")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("inactive:æŒ‡å®šç¼“å­˜çš„æ•°æ®å¤šæ¬¡æ—¶é—´æœªè¢«è®¿é—®å°±å°†è¢«åˆ é™¤ï¼Œå¦‚ï¼š")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("inactive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1d   ç¼“å­˜æ•°æ®åœ¨1å¤©å†…æ²¡æœ‰è¢«è®¿é—®å°±ä¼šè¢«åˆ é™¤")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("max_size:è®¾ç½®æœ€å¤§ç¼“å­˜ç©ºé—´ï¼Œå¦‚æœç¼“å­˜ç©ºé—´å­˜æ»¡ï¼Œé»˜è®¤ä¼šè¦†ç›–ç¼“å­˜æ—¶é—´æœ€é•¿çš„èµ„æºï¼Œå¦‚:")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("20g")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("é…ç½®å®ä¾‹:")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("http{\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tproxy_cache_path")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/usr/local/proxy_cache keys_zone=itcast:200m  levels=1:2:1 inactive=1d max_size=20g;")]),a._v("\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"proxy-cache"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache"}},[a._v("#")]),a._v(" proxy_cache")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤ç”¨æ¥å¼€å¯æˆ–å…³é—­ä»£ç†ç¼“å­˜ï¼Œå¦‚æœæ˜¯å¼€å¯åˆ™è‡ªå®šä½¿ç”¨å“ªä¸ªç¼“å­˜åŒºæ¥è¿›è¡Œç¼“å­˜ã€‚")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache zone_name|off;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("proxy_cache off;")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("p",[a._v("zone_nameï¼šæŒ‡å®šä½¿ç”¨ç¼“å­˜åŒºçš„åç§°")]),a._v(" "),s("h3",{attrs:{id:"proxy-cache-key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache-key"}},[a._v("#")]),a._v(" proxy_cache_key")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤ç”¨æ¥è®¾ç½®webç¼“å­˜çš„keyå€¼ï¼ŒNginxä¼šæ ¹æ®keyå€¼MD5å“ˆå¸Œå­˜ç¼“å­˜ã€‚")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_key key;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("proxy_cache_key $scheme$proxy_host$request_uri;")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("h3",{attrs:{id:"proxy-cache-valid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache-valid"}},[a._v("#")]),a._v(" proxy_cache_valid")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤ç”¨æ¥å¯¹ä¸åŒè¿”å›çŠ¶æ€ç çš„URLè®¾ç½®ä¸åŒçš„ç¼“å­˜æ—¶é—´")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_valid [code ...] time;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("â€”")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("p",[a._v("å¦‚ï¼š")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("200 302 10m;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("404 1m;")]),a._v("\nä¸º200å’Œ302çš„å“åº”URLè®¾ç½®10åˆ†é’Ÿç¼“å­˜ï¼Œä¸º404çš„å“åº”URLè®¾ç½®1åˆ†é’Ÿç¼“å­˜\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("any 1m;")]),a._v("\nå¯¹æ‰€æœ‰å“åº”çŠ¶æ€ç çš„URLéƒ½è®¾ç½®1åˆ†é’Ÿç¼“å­˜\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h3",{attrs:{id:"proxy-cache-min-uses"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache-min-uses"}},[a._v("#")]),a._v(" proxy_cache_min_uses")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤ç”¨æ¥è®¾ç½®èµ„æºè¢«è®¿é—®å¤šå°‘æ¬¡åè¢«ç¼“å­˜")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_min_uses number;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("proxy_cache_min_uses 1;")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("h3",{attrs:{id:"proxy-cache-methods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-cache-methods"}},[a._v("#")]),a._v(" proxy_cache_methods")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤ç”¨æˆ·è®¾ç½®ç¼“å­˜å“ªäº›HTTPæ–¹æ³•")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_methods GET|HEAD|POST;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("proxy_cache_methods GET HEAD;")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("p",[a._v("é»˜è®¤ç¼“å­˜HTTPçš„GETå’ŒHEADæ–¹æ³•ï¼Œä¸ç¼“å­˜POSTæ–¹æ³•ã€‚")]),a._v(" "),s("h2",{attrs:{id:"_4-nginxç¼“å­˜è®¾ç½®æ¡ˆä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-nginxç¼“å­˜è®¾ç½®æ¡ˆä¾‹"}},[a._v("#")]),a._v(" 4. Nginxç¼“å­˜è®¾ç½®æ¡ˆä¾‹ ğŸ˜„")]),a._v(" "),s("h4",{attrs:{id:"éœ€æ±‚åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éœ€æ±‚åˆ†æ"}},[a._v("#")]),a._v(" éœ€æ±‚åˆ†æ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/202303182022712.png",alt:"1591959569463"}})]),a._v(" "),s("h4",{attrs:{id:"æ­¥éª¤å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ­¥éª¤å®ç°"}},[a._v("#")]),a._v(" æ­¥éª¤å®ç°")]),a._v(" "),s("p",[a._v("1.ç¯å¢ƒå‡†å¤‡")]),a._v(" "),s("p",[a._v("åº”ç”¨æœåŠ¡å™¨çš„ç¯å¢ƒå‡†å¤‡")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰åœ¨192.168.200.146æœåŠ¡å™¨ä¸Šçš„tomcatçš„webappsä¸‹é¢æ·»åŠ ä¸€ä¸ªjsç›®å½•ï¼Œå¹¶åœ¨jsç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªjquery.jsæ–‡ä»¶")]),a._v(" "),s("p",[a._v("ï¼ˆ2ï¼‰å¯åŠ¨tomcat")]),a._v(" "),s("p",[a._v("ï¼ˆ3ï¼‰è®¿é—®æµ‹è¯•")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("//192.168.200.146:8080/js/jquery.js")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("Nginxçš„ç¯å¢ƒå‡†å¤‡")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰å®ŒæˆNginxåå‘ä»£ç†é…ç½®")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("http{\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tupstream")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("backend{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tserver")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("192.168.200.146:8080;")]),a._v("\n\t}\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tserver")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tlisten")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("      8080;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        server_name")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" localhost;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/ {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        \tproxy_pass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://backend/js/;")]),a._v("\n        }\n\t}\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("p",[a._v("ï¼ˆ2ï¼‰å®ŒæˆNginxç¼“å­˜é…ç½®")]),a._v(" "),s("p",[a._v("4.æ·»åŠ ç¼“å­˜é…ç½®")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("http{\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tproxy_cache_path")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/usr/local/proxy_cache levels=2:1 keys_zone=itcast:200m inactive=1d max_size=20g;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tupstream")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("backend{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tserver")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("192.168.200.146:8080;")]),a._v("\n\t}\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tserver")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tlisten")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("      8080;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        server_name")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v(" localhost;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/ {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        \tproxy_cache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("itcast;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_cache_key")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("itheima;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_cache_min_uses")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("200 5d;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("404 30s;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            proxy_cache_valid")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("any 1m;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("            add_header")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('nginx-cache "$upstream_cache_status";')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        \tproxy_pass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://backend/js/;")]),a._v("\n        }\n\t}\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br")])]),s("h2",{attrs:{id:"_5-nginxç¼“å­˜çš„æ¸…é™¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-nginxç¼“å­˜çš„æ¸…é™¤"}},[a._v("#")]),a._v(" 5. Nginxç¼“å­˜çš„æ¸…é™¤ ğŸ˜„")]),a._v(" "),s("h3",{attrs:{id:"æ–¹å¼ä¸€-åˆ é™¤å¯¹åº”çš„ç¼“å­˜ç›®å½•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹å¼ä¸€-åˆ é™¤å¯¹åº”çš„ç¼“å­˜ç›®å½•"}},[a._v("#")]),a._v(" æ–¹å¼ä¸€:åˆ é™¤å¯¹åº”çš„ç¼“å­˜ç›®å½•")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("rm -rf /usr/local/proxy_cache/......\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"æ–¹å¼äºŒ-ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰©å±•æ¨¡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹å¼äºŒ-ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰©å±•æ¨¡å—"}},[a._v("#")]),a._v(" æ–¹å¼äºŒ:ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰©å±•æ¨¡å—")]),a._v(" "),s("h4",{attrs:{id:"ngx-cache-purge"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ngx-cache-purge"}},[a._v("#")]),a._v(" ngx_cache_purge")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰ä¸‹è½½ngx_cache_purgeæ¨¡å—å¯¹åº”çš„èµ„æºåŒ…ï¼Œå¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šã€‚")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("ngx_cache_purge-2.3.tar.gz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ2ï¼‰å¯¹èµ„æºæ–‡ä»¶è¿›è¡Œè§£å‹ç¼©")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxf")]),a._v(" ngx_cache_purge-2.3.tar.gz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ3ï¼‰ä¿®æ”¹æ–‡ä»¶å¤¹åç§°ï¼Œæ–¹ä¾¿åæœŸé…ç½®")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" ngx_cache_purge-2.3 purge\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ4ï¼‰æŸ¥è¯¢Nginxçš„é…ç½®å‚æ•°")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("nginx "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-V")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ5ï¼‰è¿›å…¥Nginxçš„å®‰è£…ç›®å½•ï¼Œä½¿ç”¨./configureè¿›è¡Œå‚æ•°é…ç½®")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("./configure --add-module"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/root/nginx/module/purge\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ6ï¼‰ä½¿ç”¨makeè¿›è¡Œç¼–è¯‘")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ7ï¼‰å°†nginxå®‰è£…ç›®å½•çš„nginxäºŒçº§åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å¤‡ä»½")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" /usr/local/nginx/sbin/nginx /usr/local/nginx/sbin/nginxold\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ8ï¼‰å°†ç¼–è¯‘åçš„objsä¸­çš„nginxæ‹·è´åˆ°nginxçš„sbinç›®å½•ä¸‹")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" objs/nginx /usr/local/nginx/sbin\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ9ï¼‰ä½¿ç”¨makeè¿›è¡Œå‡çº§")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" upgrade\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("ï¼ˆ10ï¼‰åœ¨nginxé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("server{\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tlocation")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("~/purge(/.*) {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tproxy_cache_purge")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("itcast itheima;")]),a._v("\n\t}\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h2",{attrs:{id:"_5-nginxè®¾ç½®èµ„æºä¸ç¼“å­˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-nginxè®¾ç½®èµ„æºä¸ç¼“å­˜"}},[a._v("#")]),a._v(" 5. Nginxè®¾ç½®èµ„æºä¸ç¼“å­˜")]),a._v(" "),s("p",[a._v("å‰é¢å’±ä»¬å·²ç»å®Œæˆäº†Nginxä½œä¸ºwebç¼“å­˜æœåŠ¡å™¨çš„ä½¿ç”¨ã€‚ä½†æ˜¯æˆ‘ä»¬å¾—æ€è€ƒä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®éƒ½é€‚åˆè¿›è¡Œç¼“å­˜ã€‚æ¯”å¦‚è¯´å¯¹äºä¸€äº›ç»å¸¸å‘ç”Ÿå˜åŒ–çš„æ•°æ®ã€‚å¦‚æœè¿›è¡Œç¼“å­˜çš„è¯ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°ç”¨æˆ·è®¿é—®åˆ°çš„æ•°æ®ä¸æ˜¯æœåŠ¡å™¨çœŸå®çš„æ•°æ®ã€‚æ‰€ä»¥å¯¹äºè¿™äº›èµ„æºæˆ‘ä»¬åœ¨ç¼“å­˜çš„è¿‡ç¨‹ä¸­å°±éœ€è¦è¿›è¡Œè¿‡æ»¤ï¼Œä¸è¿›è¡Œç¼“å­˜ã€‚")]),a._v(" "),s("p",[a._v("Nginxä¹Ÿæä¾›äº†è¿™å—çš„åŠŸèƒ½è®¾ç½®ï¼Œéœ€è¦ä½¿ç”¨åˆ°å¦‚ä¸‹ä¸¤ä¸ªæŒ‡ä»¤")]),a._v(" "),s("p",[a._v("proxy_no_cache")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤æ˜¯ç”¨æ¥å®šä¹‰ä¸å°†æ•°æ®è¿›è¡Œç¼“å­˜çš„æ¡ä»¶ã€‚")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_no_cache string ...;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("â€”")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("p",[a._v("é…ç½®å®ä¾‹")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("proxy_no_cache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$cookie_nocache $arg_nocache $arg_comment;")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("proxy_cache_bypass")]),a._v(" "),s("p",[a._v("è¯¥æŒ‡ä»¤æ˜¯ç”¨æ¥è®¾ç½®ä¸ä»ç¼“å­˜ä¸­è·å–æ•°æ®çš„æ¡ä»¶ã€‚")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("è¯­æ³•")]),a._v(" "),s("th",[a._v("proxy_cache_bypass string ...;")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("é»˜è®¤å€¼")]),a._v(" "),s("td",[a._v("â€”")])]),a._v(" "),s("tr",[s("td",[a._v("ä½ç½®")]),a._v(" "),s("td",[a._v("httpã€serverã€location")])])])]),a._v(" "),s("p",[a._v("é…ç½®å®ä¾‹")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("proxy_cache_bypass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$cookie_nocache $arg_nocache $arg_comment;")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v('ä¸Šè¿°ä¸¤ä¸ªæŒ‡ä»¤éƒ½æœ‰ä¸€ä¸ªæŒ‡å®šçš„æ¡ä»¶ï¼Œè¿™ä¸ªæ¡ä»¶å¯ä»¥æ˜¯å¤šä¸ªï¼Œå¹¶ä¸”å¤šä¸ªæ¡ä»¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸ä¸ºç©ºä¸”ä¸ç­‰äº"0",åˆ™æ¡ä»¶æ»¡è¶³æˆç«‹ã€‚ä¸Šé¢ç»™çš„é…ç½®å®ä¾‹æ˜¯ä»å®˜æ–¹ç½‘ç«™è·å–çš„ï¼Œé‡Œé¢ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯$cookie_nocacheã€$arg_nocacheã€$arg_comment')]),a._v(" "),s("h3",{attrs:{id:"cookie-nocacheã€-arg-nocacheã€-arg-comment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cookie-nocacheã€-arg-nocacheã€-arg-comment"}},[a._v("#")]),a._v(" $cookie_nocacheã€$arg_nocacheã€$arg_comment")]),a._v(" "),s("p",[a._v("è¿™ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨çš„å«ä¹‰æ˜¯:")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("$cookie_nocache\næŒ‡çš„æ˜¯å½“å‰è¯·æ±‚çš„cookieä¸­é”®çš„åç§°ä¸ºnocacheå¯¹åº”çš„å€¼\n$arg_nocacheå’Œ$arg_comment\næŒ‡çš„æ˜¯å½“å‰è¯·æ±‚çš„å‚æ•°ä¸­å±æ€§åä¸ºnocacheå’Œcommentå¯¹åº”çš„å±æ€§å€¼\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("æ¡ˆä¾‹æ¼”ç¤ºä¸‹:")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_format")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("params $cookie_nocache | $arg_nocache | $arg_commentï¼›")]),a._v("\nserver{\n\tlisten\t8081;\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tserver_name")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("localhost;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tlocation")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\taccess_log")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("logs/access_params.log params;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tadd_header")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Set-Cookie 'nocache=999';")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\troot")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("html;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tindex")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("index.html;")]),a._v("\n\t}\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("h3",{attrs:{id:"æ¡ˆä¾‹å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¡ˆä¾‹å®ç°"}},[a._v("#")]),a._v(" æ¡ˆä¾‹å®ç°")]),a._v(" "),s("p",[a._v("è®¾ç½®ä¸ç¼“å­˜èµ„æºçš„é…ç½®æ–¹æ¡ˆ")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("server{\n\tlisten\t8080;\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tserver_name")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("localhost;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\tlocation")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/ {")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tif")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("($request_uri ~ /.*\\.js$){")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("           set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$nocache 1;")]),a._v("\n        }\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("\t\tproxy_no_cache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$nocache $cookie_nocache $arg_nocache $arg_comment;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("        proxy_cache_bypass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("$nocache $cookie_nocache $arg_nocache $arg_comment;")]),a._v("\n\t}\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);