<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/logo/logo-0.2.5.1.png" type="image/png" sizes="16x16"><meta name="referrer" content="no-referrer"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,maximum-scale=2"><title>SpringCloud.HåŸºç¡€ | chggx Konwledge</title><meta name="description" content="æ™¨å…‰å‘çš„çŸ¥è¯†åº“">
    <link rel="modulepreload" href="/chggx-knowlodge-vuepress/assets/app.099ebd34.js"><link rel="modulepreload" href="/chggx-knowlodge-vuepress/assets/1.SpringCloud.HåŸºç¡€.html.16addf58.js"><link rel="modulepreload" href="/chggx-knowlodge-vuepress/assets/1.SpringCloud.HåŸºç¡€.html.579c7733.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.7965f4da.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.2f2f1f94.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.ae2ce70a.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.ac2b8553.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.e14c572b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.f78e20f6.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.aa654337.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨.html.79d75c4c.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨.html.0f3fe687.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨.html.4e5590bc.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.Rediså…¥é—¨.html.72bd8315.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Redisæ•°æ®ç±»å‹.html.1dca25a7.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Redisäº‹åŠ¡.html.d6541a87.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.Rediså®ç°ä¹è§‚é”.html.0fccfc6b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.Redis-Jedis.html.e0339753.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.SpringBootæ•´åˆ.html.4f6d0361.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£.html.3f71e5f7.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/Redisé¢è¯•å¿…å¤‡.html.565f37a4.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SpringBootåŸºç¡€.html.addd68ab.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.SpringBootæ•´åˆRabbitMQ.html.2130697f.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.SpringCloud Alibabaä»‹ç».html.4df72d19.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/0.Javaè®¾è®¡æ¨¡å¼-å†…å®¹ä»‹ç».html.4c64431b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.Javaè®¾è®¡æ¨¡å¼-è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™.html.f7724ac0.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Javaè®¾è®¡æ¨¡å¼-UMLç±»å›¾.html.dd535d53.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Javaè®¾è®¡æ¨¡å¼-è®¾è®¡æ¨¡å¼æ¦‚è¿°.html.578ab5c8.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.Javaè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼.html.8e694f61.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.Javaè®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼.html.f2d2a3e8.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.Javaè®¾è®¡æ¨¡å¼-åŸå‹æ¨¡å¼.html.96389af1.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.Javaè®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼.html.6c1164f4.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/0.åå°„_æ³¨è§£.html.915ba1a7.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SpringåŸºç¡€.html.09d5c115.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.JVM-JVMä¸Javaä½“ç³»ç»“æ„.html.20b97bab.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/10.JVM-å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html.e0452d45.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/12.JVM-æ‰§è¡Œå¼•æ“.html.09a5fcdb.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/13.JVM-StringTable.html.9c6fa66b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/14.JVM-åƒåœ¾å›æ”¶æ¦‚è¿°.html.f24da324.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/15.JVM-åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html.6c1eee28.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/16.JVM-åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html.555ad5c8.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.JVM-ç±»åŠ è½½å­ç³»ç»Ÿ.html.d23d9307.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.JVM-è¿è¡Œæ—¶æ•°æ®åŒºæ¦‚è¿°åŠçº¿ç¨‹.html.73115a90.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.JVM-ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨).html.eaa43a7a.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.JVM-è™šæ‹Ÿæœºæ ˆ.html.4a5da7d1.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.JVM-æœ¬åœ°æ–¹æ³•æ¥å£.html.6202cb8b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.JVM-æœ¬åœ°æ–¹æ³•æ ˆ.html.fbe12cb8.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/8.JVM-å †.html.2a6f83f4.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/9.JVM-æ–¹æ³•åŒº.html.6b2c2b0c.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Java8æ–°ç‰¹æ€§-Streamæµ.html.eec6de9c.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Java8æ–°ç‰¹æ€§-æ—¥æœŸ.html.b8efb717.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SVNåŸºç¡€.html.68038d62.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Gitå¸¸ç”¨å‘½ä»¤.html.44d60505.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.18b0ea6d.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.ee108be9.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.0bf44c21.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.fdfeec7c.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.f615de6f.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.656af16d.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/index.html.e6fe2efc.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨.html.2aa4ca42.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨.html.2064eebc.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨.html.98f907c0.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.Rediså…¥é—¨.html.a0317cb6.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Redisæ•°æ®ç±»å‹.html.f9096454.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Redisäº‹åŠ¡.html.a99f54a2.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.Rediså®ç°ä¹è§‚é”.html.fbfdb9f3.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.Redis-Jedis.html.75dfaa97.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.SpringBootæ•´åˆ.html.b6c0ae73.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£.html.ed363f3e.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/Redisé¢è¯•å¿…å¤‡.html.cffad8a6.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SpringBootåŸºç¡€.html.e574f8aa.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.SpringBootæ•´åˆRabbitMQ.html.3234b0ce.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.SpringCloud Alibabaä»‹ç».html.954edee6.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/0.Javaè®¾è®¡æ¨¡å¼-å†…å®¹ä»‹ç».html.d767132a.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.Javaè®¾è®¡æ¨¡å¼-è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™.html.b750374f.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Javaè®¾è®¡æ¨¡å¼-UMLç±»å›¾.html.62fef168.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Javaè®¾è®¡æ¨¡å¼-è®¾è®¡æ¨¡å¼æ¦‚è¿°.html.80544a2f.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.Javaè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼.html.1b36b209.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.Javaè®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼.html.d9a560e8.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.Javaè®¾è®¡æ¨¡å¼-åŸå‹æ¨¡å¼.html.c16662fa.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.Javaè®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼.html.4ffa1cf2.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/0.åå°„_æ³¨è§£.html.8c8a5821.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SpringåŸºç¡€.html.8e907486.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.JVM-JVMä¸Javaä½“ç³»ç»“æ„.html.def8831c.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/10.JVM-å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html.c1bc7c3f.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/12.JVM-æ‰§è¡Œå¼•æ“.html.a86974db.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/13.JVM-StringTable.html.592c3824.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/14.JVM-åƒåœ¾å›æ”¶æ¦‚è¿°.html.c3c69a48.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/15.JVM-åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html.8a87682e.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/16.JVM-åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html.97355adf.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.JVM-ç±»åŠ è½½å­ç³»ç»Ÿ.html.c51da7a2.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.JVM-è¿è¡Œæ—¶æ•°æ®åŒºæ¦‚è¿°åŠçº¿ç¨‹.html.e550b9a4.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/4.JVM-ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨).html.5f49930d.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/5.JVM-è™šæ‹Ÿæœºæ ˆ.html.fe4052e4.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/6.JVM-æœ¬åœ°æ–¹æ³•æ¥å£.html.2ca30aed.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/7.JVM-æœ¬åœ°æ–¹æ³•æ ˆ.html.ff1e6b43.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/8.JVM-å †.html.c6130241.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/9.JVM-æ–¹æ³•åŒº.html.60bc82f0.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Java8æ–°ç‰¹æ€§-Streamæµ.html.b14b4cf6.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/3.Java8æ–°ç‰¹æ€§-æ—¥æœŸ.html.30ca8164.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/1.SVNåŸºç¡€.html.d1d6cb97.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/2.Gitå¸¸ç”¨å‘½ä»¤.html.1a2dc50b.js"><link rel="prefetch" href="/chggx-knowlodge-vuepress/assets/404.html.3e165de1.js">
    <link rel="stylesheet" href="/chggx-knowlodge-vuepress/assets/style.19ddbf83.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/chggx-knowlodge-vuepress/" class=""><img class="logo" src="/chggx-knowlodge-vuepress/logo/logo-1.5.2.png" alt="chggx Konwledge"><span class="site-name can-hide">chggx Konwledge</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/chggx-knowlodge-vuepress/" class="" aria-label="  é¦–é¡µ  "><!--[--><!--]-->   é¦–é¡µ   <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  JAVA  "><span class="title">  JAVA  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  JAVA  "><span class="title">  JAVA  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/java-base/" class="" aria-label="JavaåŸºç¡€"><!--[--><!--]--> JavaåŸºç¡€ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/java-advence/" class="" aria-label="Javaè¿›é˜¶"><!--[--><!--]--> Javaè¿›é˜¶ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/framework/" class="router-link-active" aria-label="æ¡†æ¶"><!--[--><!--]--> æ¡†æ¶ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/until/" class="" aria-label="å·¥å…·"><!--[--><!--]--> å·¥å…· <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  æ•°æ®åº“  "><span class="title">  æ•°æ®åº“  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  æ•°æ®åº“  "><span class="title">  æ•°æ®åº“  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/sql/mysql" class="" aria-label="mysql"><!--[--><!--]--> mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Redis</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/1.Redis%E5%85%A5%E9%97%A8.html" class="" aria-label="Rediså…¥é—¨"><!--[--><!--]--> Rediså…¥é—¨ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/2.Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="" aria-label="Redisæ•°æ®ç±»å‹"><!--[--><!--]--> Redisæ•°æ®ç±»å‹ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/3.Redis%E4%BA%8B%E5%8A%A1.html" class="" aria-label="Redisäº‹åŠ¡"><!--[--><!--]--> Redisäº‹åŠ¡ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/4.Redis%E5%AE%9E%E7%8E%B0%E4%B9%90%E8%A7%82%E9%94%81.html" class="" aria-label="Rediså®ç°ä¹è§‚é”"><!--[--><!--]--> Rediså®ç°ä¹è§‚é” <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/5.Redis-Jedis.html" class="" aria-label="Redis-Jedis"><!--[--><!--]--> Redis-Jedis <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/6.SpringBoot%E6%95%B4%E5%90%88.html" class="" aria-label="SpringBootæ•´åˆ"><!--[--><!--]--> SpringBootæ•´åˆ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/7.Redis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3.html" class="" aria-label="Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£"><!--[--><!--]--> Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/Redis%E9%9D%A2%E8%AF%95%E5%BF%85%E5%A4%87.html" class="" aria-label="Redisé¢è¯•å¿…å¤‡"><!--[--><!--]--> Redisé¢è¯•å¿…å¤‡ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>influxdb</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/influxdb/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-influxdb1.x%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/influxdb/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-influxdb2.x%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  æœç´¢å¼•æ“  "><span class="title">  æœç´¢å¼•æ“  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  æœç´¢å¼•æ“  "><span class="title">  æœç´¢å¼•æ“  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>ElasticSearch</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/search/elasticSearch/ElasticSearch7.6.1%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  ä¸­é—´ä»¶  "><span class="title">  ä¸­é—´ä»¶  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  ä¸­é—´ä»¶  "><span class="title">  ä¸­é—´ä»¶  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="RabbitMQ"><!--[--><!--]--> RabbitMQ <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  éƒ¨ç½²è¿ç»´  "><span class="title">  éƒ¨ç½²è¿ç»´  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  éƒ¨ç½²è¿ç»´  "><span class="title">  éƒ¨ç½²è¿ç»´  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="è™šæ‹Ÿæœº"><!--[--><!--]--> è™šæ‹Ÿæœº <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  é—®é¢˜æ±‡æ€»  "><span class="title">  é—®é¢˜æ±‡æ€»  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  é—®é¢˜æ±‡æ€»  "><span class="title">  é—®é¢˜æ±‡æ€»  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="æ•°æ®åº“"><!--[--><!--]--> æ•°æ®åº“ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="éƒ¨ç½²"><!--[--><!--]--> éƒ¨ç½² <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  å‰ç«¯  "><span class="title">  å‰ç«¯  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  å‰ç«¯  "><span class="title">  å‰ç«¯  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/vue/" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/chggx-knowlodge-vuepress/" class="" aria-label="  é¦–é¡µ  "><!--[--><!--]-->   é¦–é¡µ   <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  JAVA  "><span class="title">  JAVA  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  JAVA  "><span class="title">  JAVA  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/java-base/" class="" aria-label="JavaåŸºç¡€"><!--[--><!--]--> JavaåŸºç¡€ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/java-advence/" class="" aria-label="Javaè¿›é˜¶"><!--[--><!--]--> Javaè¿›é˜¶ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/framework/" class="router-link-active" aria-label="æ¡†æ¶"><!--[--><!--]--> æ¡†æ¶ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/java/until/" class="" aria-label="å·¥å…·"><!--[--><!--]--> å·¥å…· <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  æ•°æ®åº“  "><span class="title">  æ•°æ®åº“  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  æ•°æ®åº“  "><span class="title">  æ•°æ®åº“  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/sql/mysql" class="" aria-label="mysql"><!--[--><!--]--> mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Redis</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/1.Redis%E5%85%A5%E9%97%A8.html" class="" aria-label="Rediså…¥é—¨"><!--[--><!--]--> Rediså…¥é—¨ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/2.Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="" aria-label="Redisæ•°æ®ç±»å‹"><!--[--><!--]--> Redisæ•°æ®ç±»å‹ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/3.Redis%E4%BA%8B%E5%8A%A1.html" class="" aria-label="Redisäº‹åŠ¡"><!--[--><!--]--> Redisäº‹åŠ¡ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/4.Redis%E5%AE%9E%E7%8E%B0%E4%B9%90%E8%A7%82%E9%94%81.html" class="" aria-label="Rediså®ç°ä¹è§‚é”"><!--[--><!--]--> Rediså®ç°ä¹è§‚é” <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/5.Redis-Jedis.html" class="" aria-label="Redis-Jedis"><!--[--><!--]--> Redis-Jedis <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/6.SpringBoot%E6%95%B4%E5%90%88.html" class="" aria-label="SpringBootæ•´åˆ"><!--[--><!--]--> SpringBootæ•´åˆ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/7.Redis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3.html" class="" aria-label="Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£"><!--[--><!--]--> Redisçš„é…ç½®æ–‡ä»¶è¯¦è§£ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/redis/Redis%E9%9D%A2%E8%AF%95%E5%BF%85%E5%A4%87.html" class="" aria-label="Redisé¢è¯•å¿…å¤‡"><!--[--><!--]--> Redisé¢è¯•å¿…å¤‡ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>influxdb</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/influxdb/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-influxdb1.x%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> æ—¶åºæ•°æ®åº“-influxdb1.x å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/sql/influxdb/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-influxdb2.x%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> æ—¶åºæ•°æ®åº“-influxdb2.x å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  æœç´¢å¼•æ“  "><span class="title">  æœç´¢å¼•æ“  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  æœç´¢å¼•æ“  "><span class="title">  æœç´¢å¼•æ“  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>ElasticSearch</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/chggx-knowlodge-vuepress/search/elasticSearch/ElasticSearch7.6.1%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html" class="" aria-label="ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨"><!--[--><!--]--> ElasticSearch7.6.1å¿«é€Ÿå…¥é—¨ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  ä¸­é—´ä»¶  "><span class="title">  ä¸­é—´ä»¶  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  ä¸­é—´ä»¶  "><span class="title">  ä¸­é—´ä»¶  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="RabbitMQ"><!--[--><!--]--> RabbitMQ <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  éƒ¨ç½²è¿ç»´  "><span class="title">  éƒ¨ç½²è¿ç»´  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  éƒ¨ç½²è¿ç»´  "><span class="title">  éƒ¨ç½²è¿ç»´  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="è™šæ‹Ÿæœº"><!--[--><!--]--> è™šæ‹Ÿæœº <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  é—®é¢˜æ±‡æ€»  "><span class="title">  é—®é¢˜æ±‡æ€»  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  é—®é¢˜æ±‡æ€»  "><span class="title">  é—®é¢˜æ±‡æ€»  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="æ•°æ®åº“"><!--[--><!--]--> æ•°æ®åº“ <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/mq/mysql" class="" aria-label="éƒ¨ç½²"><!--[--><!--]--> éƒ¨ç½² <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="  å‰ç«¯  "><span class="title">  å‰ç«¯  </span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="  å‰ç«¯  "><span class="title">  å‰ç«¯  </span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/vue/" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/chggx-knowlodge-vuepress/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Spring <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/chggx-knowlodge-vuepress/java/framework/spring/0.%E5%8F%8D%E5%B0%84&amp;%E6%B3%A8%E8%A7%A3.html" class="sidebar-item" aria-label="åå°„&amp;æ³¨è§£"><!--[--><!--]--> åå°„&amp;æ³¨è§£ <!--[--><!--]--></a><!----></li><li><a href="/chggx-knowlodge-vuepress/java/framework/spring/1.Spring%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="SpringåŸºç¡€"><!--[--><!--]--> SpringåŸºç¡€ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">SpringBoot <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/chggx-knowlodge-vuepress/java/framework/springboot/1.SpringBoot%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="SpringBootåŸºç¡€"><!--[--><!--]--> SpringBootåŸºç¡€ <!--[--><!--]--></a><!----></li><li><a href="/chggx-knowlodge-vuepress/java/framework/springboot/2.SpringBoot%E6%95%B4%E5%90%88RabbitMQ.html" class="sidebar-item" aria-label="SpringBootæ•´åˆRabbitMQ"><!--[--><!--]--> SpringBootæ•´åˆRabbitMQ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">SpringCloud <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="SpringCloud.HåŸºç¡€"><!--[--><!--]--> SpringCloud.HåŸºç¡€ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-springboot2-xç‰ˆå’Œspringcloud-hç‰ˆ" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. SpringBoot2.Xç‰ˆå’ŒSpringCloud Hç‰ˆ"><!--[--><!--]--> 1. SpringBoot2.Xç‰ˆå’ŒSpringCloud Hç‰ˆ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-springboot-2-0-ä¹‹å" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. SpringBoot 2.0 ä¹‹å"><!--[--><!--]--> 1. SpringBoot 2.0 ä¹‹å <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-springcloud" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. SpringCloud"><!--[--><!--]--> 2. SpringCloud <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-å…³äºcloudç»„ä»¶çš„åœæ›´-å‡çº§-æ›¿æ¢" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.å…³äºCloudç»„ä»¶çš„åœæ›´/å‡çº§/æ›¿æ¢"><!--[--><!--]--> 2.å…³äºCloudç»„ä»¶çš„åœæ›´/å‡çº§/æ›¿æ¢ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-åœæ›´å‰" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. åœæ›´å‰"><!--[--><!--]--> 1. åœæ›´å‰ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-æ³¨å†Œä¸­å¿ƒ" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. æ³¨å†Œä¸­å¿ƒ"><!--[--><!--]--> 2. æ³¨å†Œä¸­å¿ƒ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-æœåŠ¡çš„è°ƒç”¨" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. æœåŠ¡çš„è°ƒç”¨"><!--[--><!--]--> 3. æœåŠ¡çš„è°ƒç”¨ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-æœåŠ¡çš„è°ƒç”¨2" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. æœåŠ¡çš„è°ƒç”¨2"><!--[--><!--]--> 4. æœåŠ¡çš„è°ƒç”¨2 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-é™çº§æœåŠ¡" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. é™çº§æœåŠ¡"><!--[--><!--]--> 5. é™çº§æœåŠ¡ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_6-æœåŠ¡ç½‘å…³" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. æœåŠ¡ç½‘å…³"><!--[--><!--]--> 6. æœåŠ¡ç½‘å…³ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_7-æœåŠ¡é…ç½®" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.  æœåŠ¡é…ç½®"><!--[--><!--]--> 7.  æœåŠ¡é…ç½® <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-config" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Config"><!--[--><!--]--> 1. Config <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_8-æœåŠ¡æ€»çº¿" class="router-link-active router-link-exact-active sidebar-item" aria-label="8. æœåŠ¡æ€»çº¿"><!--[--><!--]--> 8. æœåŠ¡æ€»çº¿ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-å¾®æœåŠ¡æ¶æ„ç¼–ç " class="router-link-active router-link-exact-active sidebar-item" aria-label="3. å¾®æœåŠ¡æ¶æ„ç¼–ç "><!--[--><!--]--> 3. å¾®æœåŠ¡æ¶æ„ç¼–ç  <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡"><!--[--><!--]--> 1. è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„"><!--[--><!--]--> 2. actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-æœåŠ¡å‘ç°discovery" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. æœåŠ¡å‘ç°Discovery"><!--[--><!--]--> 3. æœåŠ¡å‘ç°Discovery <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯†" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. Eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯†"><!--[--><!--]--> 4. Eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯† <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-æ³¨å†Œä¸­å¿ƒ" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. æ³¨å†Œä¸­å¿ƒ"><!--[--><!--]--> 4. æ³¨å†Œä¸­å¿ƒ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-zookeeper" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. zookeeper"><!--[--><!--]--> 1. zookeeper <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-consul" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. consul"><!--[--><!--]--> 2. consul <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-eureka-consul-zookeeperå¼‚åŒç‚¹" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. eureka, consul, zookeeperå¼‚åŒç‚¹"><!--[--><!--]--> 3. eureka, consul, zookeeperå¼‚åŒç‚¹ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-è´Ÿè½½å‡è¡¡-æœåŠ¡è°ƒç”¨" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. è´Ÿè½½å‡è¡¡[æœåŠ¡è°ƒç”¨]"><!--[--><!--]--> 4. è´Ÿè½½å‡è¡¡[æœåŠ¡è°ƒç”¨] <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-rbbon" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Rbbon"><!--[--><!--]--> 1. Rbbon <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-æœåŠ¡è°ƒç”¨" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. æœåŠ¡è°ƒç”¨"><!--[--><!--]--> 5. æœåŠ¡è°ƒç”¨ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-openfeign" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. openFeign"><!--[--><!--]--> 1. openFeign <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-openfeignç¼–ç " class="router-link-active router-link-exact-active sidebar-item" aria-label="2. openFeignç¼–ç "><!--[--><!--]--> 2. openFeignç¼–ç  <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-openfeignè¶…æ—¶æ§åˆ¶" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. openfeignè¶…æ—¶æ§åˆ¶"><!--[--><!--]--> 3. openfeignè¶…æ—¶æ§åˆ¶ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-openfeignæ—¥å¿—æ‰“å°" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. openfeignæ—¥å¿—æ‰“å°"><!--[--><!--]--> 4. openfeignæ—¥å¿—æ‰“å° <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_6-æœåŠ¡é™çº§" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. æœåŠ¡é™çº§"><!--[--><!--]--> 6. æœåŠ¡é™çº§ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-hystrix-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Hystrix"><!--[--><!--]--> 1. Hystrix <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-èƒ½å¹²ä»€ä¹ˆ" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. èƒ½å¹²ä»€ä¹ˆ?"><!--[--><!--]--> 2. èƒ½å¹²ä»€ä¹ˆ? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-æœåŠ¡é™çº§" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. æœåŠ¡é™çº§ ğŸ˜„"><!--[--><!--]--> 3. æœåŠ¡é™çº§ ğŸ˜„ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-æœåŠ¡ç†”æ–­" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.æœåŠ¡ç†”æ–­ ğŸ˜„"><!--[--><!--]--> 4.æœåŠ¡ç†”æ–­ ğŸ˜„ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-æœåŠ¡é™æµ" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. æœåŠ¡é™æµ"><!--[--><!--]--> 5. æœåŠ¡é™æµ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_6-hystrix-å›¾å½¢åŒ–dashboardæ­å»ºåŠç›‘æ§æµ‹è¯•" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. Hystrix å›¾å½¢åŒ–Dashboardæ­å»ºåŠç›‘æ§æµ‹è¯•"><!--[--><!--]--> 6. Hystrix å›¾å½¢åŒ–Dashboardæ­å»ºåŠç›‘æ§æµ‹è¯• <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_7-ç½‘å…³" class="router-link-active router-link-exact-active sidebar-item" aria-label="7. ç½‘å…³ ğŸ˜„"><!--[--><!--]--> 7. ç½‘å…³ ğŸ˜„ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-zuul-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Zuul"><!--[--><!--]--> 1. Zuul <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-gateway-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. gateway"><!--[--><!--]--> 2. gateway <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-ç¼–ç " class="router-link-active router-link-exact-active sidebar-item" aria-label="3. ç¼–ç "><!--[--><!--]--> 3. ç¼–ç  <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. Gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼"><!--[--><!--]--> 4. Gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-åŠ¨æ€è·¯ç”±" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. åŠ¨æ€è·¯ç”±"><!--[--><!--]--> 5. åŠ¨æ€è·¯ç”± <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_6-predicate" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. Predicate"><!--[--><!--]--> 6. Predicate <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_7-filter" class="router-link-active router-link-exact-active sidebar-item" aria-label="7. Filter"><!--[--><!--]--> 7. Filter <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" class="router-link-active router-link-exact-active sidebar-item" aria-label="8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ ğŸ˜„"><!--[--><!--]--> 8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ ğŸ˜„ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-config-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.  config"><!--[--><!--]--> 1.  config <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_9-springcloud-busæ¶ˆæ¯æ€»çº¿" class="router-link-active router-link-exact-active sidebar-item" aria-label="9. SpringCloud Busæ¶ˆæ¯æ€»çº¿ ğŸ˜„"><!--[--><!--]--> 9. SpringCloud Busæ¶ˆæ¯æ€»çº¿ ğŸ˜„ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-æ¦‚è¿°-7" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.æ¦‚è¿°"><!--[--><!--]--> 1.æ¦‚è¿° <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-rabbitmqé…ç½®" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. RabbitMQé…ç½®"><!--[--><!--]--> 2. RabbitMQé…ç½® <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-springcloud-bus-åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. SpringCloud Bus==åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­=="><!--[--><!--]--> 3. SpringCloud Bus==åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­== <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-springcloud-busåŠ¨æ€åˆ·æ–°-å®šç‚¹é€šçŸ¥" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.  SpringCloud BusåŠ¨æ€åˆ·æ–°==å®šç‚¹é€šçŸ¥=="><!--[--><!--]--> 4.  SpringCloud BusåŠ¨æ€åˆ·æ–°==å®šç‚¹é€šçŸ¥== <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-busæ€»ç»“" class="router-link-active router-link-exact-active sidebar-item" aria-label="5 busæ€»ç»“"><!--[--><!--]--> 5 busæ€»ç»“ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_10-springcloud-streamæ¶ˆæ¯é©±åŠ¨" class="router-link-active router-link-exact-active sidebar-item" aria-label="10. SpringCloud Streamæ¶ˆæ¯é©±åŠ¨"><!--[--><!--]--> 10. SpringCloud Streamæ¶ˆæ¯é©±åŠ¨ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-æ¦‚è¿°-8" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. æ¦‚è¿°"><!--[--><!--]--> 1. æ¦‚è¿° <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-è®¾è®¡æ€æƒ³åŠç†å¿µ" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.è®¾è®¡æ€æƒ³åŠç†å¿µ"><!--[--><!--]--> 2.è®¾è®¡æ€æƒ³åŠç†å¿µ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_3-æµç¨‹" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. æµç¨‹"><!--[--><!--]--> 3. æµç¨‹ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_4-æ¡ˆä¾‹-å‚è€ƒ" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. æ¡ˆä¾‹ å‚è€ƒ"><!--[--><!--]--> 4. æ¡ˆä¾‹ å‚è€ƒ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_5-åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–"><!--[--><!--]--> 5. åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ– <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_11-springcloud-sleuth-åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" class="router-link-active router-link-exact-active sidebar-item" aria-label="11. SpringCloud Sleuth åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª"><!--[--><!--]--> 11. SpringCloud Sleuth åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_1-æ¦‚å¿µ-å®˜ç½‘" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. æ¦‚å¿µ å®˜ç½‘"><!--[--><!--]--> 1. æ¦‚å¿µ å®˜ç½‘ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/chggx-knowlodge-vuepress/java/framework/springcloud/1.SpringCloud.H%E5%9F%BA%E7%A1%80.html#_2-ç¯å¢ƒæ­å»º" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. ç¯å¢ƒæ­å»º"><!--[--><!--]--> 2. ç¯å¢ƒæ­å»º <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/chggx-knowlodge-vuepress/java/framework/springcloud/2.SpringCloud%20Alibaba%E4%BB%8B%E7%BB%8D.html" class="sidebar-item" aria-label="SpringCloud Alibaba å®˜ç½‘"><!--[--><!--]--> SpringCloud Alibaba å®˜ç½‘ <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="springcloud-håŸºç¡€" tabindex="-1"><a class="header-anchor" href="#springcloud-håŸºç¡€" aria-hidden="true">#</a> SpringCloud.HåŸºç¡€</h1><h2 id="_1-springboot2-xç‰ˆå’Œspringcloud-hç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_1-springboot2-xç‰ˆå’Œspringcloud-hç‰ˆ" aria-hidden="true">#</a> 1. SpringBoot2.Xç‰ˆå’ŒSpringCloud Hç‰ˆ</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ç‰ˆæœ¬é€‰æ‹© 2.2.2.RELEASE + Hoxton.SR1+ Meaven3.5åŠä»¥ä¸Š+MySQL5.7åŠä»¥ä¸Š+Java8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç‰ˆæœ¬é€‰æ‹© 2.2.5.RELEASE + Hoxton.SR3</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">SpringBoot2.1.4ç‰ˆå’ŒSpringCloud</span> <span class="token value attr-value">Gç‰ˆ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_1-springboot-2-0-ä¹‹å" tabindex="-1"><a class="header-anchor" href="#_1-springboot-2-0-ä¹‹å" aria-hidden="true">#</a> 1. SpringBoot 2.0 ä¹‹å</h3><p>å®˜ç½‘å»ºè®® 2.0ä¹‹å</p><h3 id="_2-springcloud" tabindex="-1"><a class="header-anchor" href="#_2-springcloud" aria-hidden="true">#</a> 2. SpringCloud</h3><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/springcloudç‰ˆæœ¬å¯¹åº”çš„springbootç‰ˆæœ¬.png?x-oss-process=style/shuiyin_1" alt=""></p><hr><h2 id="_2-å…³äºcloudç»„ä»¶çš„åœæ›´-å‡çº§-æ›¿æ¢" tabindex="-1"><a class="header-anchor" href="#_2-å…³äºcloudç»„ä»¶çš„åœæ›´-å‡çº§-æ›¿æ¢" aria-hidden="true">#</a> 2.å…³äºCloudç»„ä»¶çš„åœæ›´/å‡çº§/æ›¿æ¢</h2><h3 id="_1-åœæ›´å‰" tabindex="-1"><a class="header-anchor" href="#_1-åœæ›´å‰" aria-hidden="true">#</a> 1. åœæ›´å‰</h3><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154503.png" alt=""></p><hr><h3 id="_2-æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_2-æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 2. æ³¨å†Œä¸­å¿ƒ</h3><h4 id="_1-eureka" tabindex="-1"><a class="header-anchor" href="#_1-eureka" aria-hidden="true">#</a> 1. eureka</h4><p>åœæ›´</p><h4 id="_2-zookeeper" tabindex="-1"><a class="header-anchor" href="#_2-zookeeper" aria-hidden="true">#</a> 2. zookeeper</h4><p>å¯ä»¥æ›¿æ¢</p><h4 id="_3-consul" tabindex="-1"><a class="header-anchor" href="#_3-consul" aria-hidden="true">#</a> 3. consul</h4><p>å¯ä»¥æ›¿æ¢(GOè¯­è¨€å†™çš„)</p><h4 id="_4-nacos-é˜¿é‡Œ" tabindex="-1"><a class="header-anchor" href="#_4-nacos-é˜¿é‡Œ" aria-hidden="true">#</a> 4. Nacos (é˜¿é‡Œ)</h4><hr><h3 id="_3-æœåŠ¡çš„è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡çš„è°ƒç”¨" aria-hidden="true">#</a> 3. æœåŠ¡çš„è°ƒç”¨</h3><h4 id="_1-rabbon" tabindex="-1"><a class="header-anchor" href="#_1-rabbon" aria-hidden="true">#</a> 1. rabbon</h4><p>è¿˜åœ¨ä½¿ç”¨</p><h4 id="_2-loadbalancer" tabindex="-1"><a class="header-anchor" href="#_2-loadbalancer" aria-hidden="true">#</a> 2. LoadBalancer</h4><p>æ–°çš„æœåŠ¡è°ƒç”¨</p><hr><h3 id="_4-æœåŠ¡çš„è°ƒç”¨2" tabindex="-1"><a class="header-anchor" href="#_4-æœåŠ¡çš„è°ƒç”¨2" aria-hidden="true">#</a> 4. æœåŠ¡çš„è°ƒç”¨2</h3><h4 id="_1-feign" tabindex="-1"><a class="header-anchor" href="#_1-feign" aria-hidden="true">#</a> 1. feign</h4><p>æŒ‚äº†</p><h4 id="_2-openfeign" tabindex="-1"><a class="header-anchor" href="#_2-openfeign" aria-hidden="true">#</a> 2. OpenFeign</h4><hr><h3 id="_5-é™çº§æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_5-é™çº§æœåŠ¡" aria-hidden="true">#</a> 5. é™çº§æœåŠ¡</h3><h4 id="_1-hystrix" tabindex="-1"><a class="header-anchor" href="#_1-hystrix" aria-hidden="true">#</a> 1. Hystrix</h4><p>å®˜ç½‘ä¸ç”¨</p><h4 id="_2-resilience4j" tabindex="-1"><a class="header-anchor" href="#_2-resilience4j" aria-hidden="true">#</a> 2. resilience4j</h4><p>å›½å¤–æ¨è</p><h4 id="_3-sentienl-é˜¿é‡Œ" tabindex="-1"><a class="header-anchor" href="#_3-sentienl-é˜¿é‡Œ" aria-hidden="true">#</a> 3. sentienl(é˜¿é‡Œ)</h4><p>æ¨è</p><hr><h3 id="_6-æœåŠ¡ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#_6-æœåŠ¡ç½‘å…³" aria-hidden="true">#</a> 6. æœåŠ¡ç½‘å…³</h3><h4 id="_1-zuul" tabindex="-1"><a class="header-anchor" href="#_1-zuul" aria-hidden="true">#</a> 1. zuul</h4><p>æŒ‚äº† (zuulæ­»äº†)</p><h4 id="_2-gateway" tabindex="-1"><a class="header-anchor" href="#_2-gateway" aria-hidden="true">#</a> 2. gateway</h4><p>æ¨è</p><hr><h3 id="_7-æœåŠ¡é…ç½®" tabindex="-1"><a class="header-anchor" href="#_7-æœåŠ¡é…ç½®" aria-hidden="true">#</a> 7. æœåŠ¡é…ç½®</h3><h3 id="_1-config" tabindex="-1"><a class="header-anchor" href="#_1-config" aria-hidden="true">#</a> 1. Config</h3><p>ä¸ç”¨</p><h4 id="_2-nocos" tabindex="-1"><a class="header-anchor" href="#_2-nocos" aria-hidden="true">#</a> 2. Nocos</h4><hr><h3 id="_8-æœåŠ¡æ€»çº¿" tabindex="-1"><a class="header-anchor" href="#_8-æœåŠ¡æ€»çº¿" aria-hidden="true">#</a> 8. æœåŠ¡æ€»çº¿</h3><h4 id="_1-bus" tabindex="-1"><a class="header-anchor" href="#_1-bus" aria-hidden="true">#</a> 1. Bus</h4><p>ä¸ç”¨</p><h4 id="_2-nacos" tabindex="-1"><a class="header-anchor" href="#_2-nacos" aria-hidden="true">#</a> 2. Nacos</h4><hr><h2 id="_3-å¾®æœåŠ¡æ¶æ„ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_3-å¾®æœåŠ¡æ¶æ„ç¼–ç " aria-hidden="true">#</a> 3. å¾®æœåŠ¡æ¶æ„ç¼–ç </h2><h3 id="_1-è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_1-è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡" aria-hidden="true">#</a> 1. <strong>è®¢å•-æ”¯ä»˜æ¨¡å—å¾®æœåŠ¡</strong></h3><p>https://blog.csdn.net/qq_41211642/article/details/104772140</p><p>å‚è€ƒæ­¤åšå®¢</p><hr><h3 id="_2-actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„" tabindex="-1"><a class="header-anchor" href="#_2-actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„" aria-hidden="true">#</a> 2. actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„</h3><p>https://blog.csdn.net/qq_41211642/article/details/104802731</p><h4 id="_1-ä¸»æœºåç§°-æœåŠ¡åç§°ä¿®æ”¹" tabindex="-1"><a class="header-anchor" href="#_1-ä¸»æœºåç§°-æœåŠ¡åç§°ä¿®æ”¹" aria-hidden="true">#</a> 1. ä¸»æœºåç§°ï¼šæœåŠ¡åç§°ä¿®æ”¹</h4><h5 id="_1-å½“å‰é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-å½“å‰é—®é¢˜" aria-hidden="true">#</a> 1. å½“å‰é—®é¢˜ï¼š</h5><p><code>æœåŠ¡æ³¨å†Œå«æœ‰ä¸»æœºåç§°ï¼Œè¦æƒ³æŒ‰ç…§è§„èŒƒçš„è¦æ±‚ï¼Œåªæš´éœ²æœåŠ¡åï¼Œä¸è¦å‡ºç°ä¸»æœºå</code></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154556.png" alt=""></p><h5 id="_2-é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-é…ç½®" aria-hidden="true">#</a> 2. é…ç½®</h5><p><strong>ä¾èµ–</strong>æ ‡é…</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>application.yml eurekaä¸­æ·»åŠ </p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token comment"># ä¸»æœºåçš„ä¿®æ”¹</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> order80
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154613.png" alt=""></p><h5 id="_3-æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_3-æ•ˆæœ" aria-hidden="true">#</a> 3. æ•ˆæœ</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154640.png" alt=""></p><h4 id="_2-ipæç¤º" tabindex="-1"><a class="header-anchor" href="#_2-ipæç¤º" aria-hidden="true">#</a> 2. IPæç¤º</h4><h5 id="_1-é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-é…ç½®" aria-hidden="true">#</a> 1. é…ç½®</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€</span>
<span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154656.png" alt=""></p><h5 id="_2-æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_2-æ•ˆæœ" aria-hidden="true">#</a> 2. æ•ˆæœ</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154707.png" alt=""></p><hr><h3 id="_3-æœåŠ¡å‘ç°discovery" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡å‘ç°discovery" aria-hidden="true">#</a> 3. æœåŠ¡å‘ç°Discovery</h3><p><code>å¯¹äºæ³¨å†Œè¿›å…¥eurekaé‡Œé¢çš„æœåŠ¡,å¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æ¥è·å–è¯¥æœåŠ¡ä¿¡æ¯</code></p><p>https://blog.csdn.net/qq_41211642/article/details/104803913</p><h4 id="_1-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_1-ä½¿ç”¨" aria-hidden="true">#</a> 1. ä½¿ç”¨</h4><h5 id="_1-å¯åŠ¨ç±»" tabindex="-1"><a class="header-anchor" href="#_1-å¯åŠ¨ç±»" aria-hidden="true">#</a> 1. å¯åŠ¨ç±»</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableDiscoveryClient</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_2-ä»£ç " aria-hidden="true">#</a> 2. ä»£ç </h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span>
<span class="token keyword">private</span> <span class="token class-name">DiscoveryClient</span> discoveryClient<span class="token punctuation">;</span>

 <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/discovery&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">discovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. getServices è·å–æœåŠ¡ä¿¡æ¯</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        services<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æœåŠ¡ä¿¡æ¯: &quot;</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2. serviceId: eurekaå¯¹å¤–æš´éœ²çš„æœåŠ¡å®ä¾‹, å¦‚CLOUD-PAYMENT-SERVICE, CLOUD-ORDER-SERVER</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        instances<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">getServiceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discoveryClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_4-eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯†" tabindex="-1"><a class="header-anchor" href="#_4-eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯†" aria-hidden="true">#</a> 4. Eurekaè‡ªæˆ‘ä¿æŠ¤ç†è®ºçŸ¥è¯†</h3><p>https://blog.csdn.net/qq_41211642/article/details/104804049</p><h4 id="_1-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°" aria-hidden="true">#</a> 1. æ¦‚è¿°ï¼š</h4><p>ä¿æŠ¤æ¨¡å¼ä¸»è¦ç”¨äºä¸€ç»„å®¢æˆ·ç«¯å’ŒEureka Serverä¹‹é—´å­˜åœ¨ç½‘ç»œåˆ†åŒºåœºæ™¯ä¸‹çš„ä¿æŠ¤ï¼Œä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼ŒEureka Serverå°†ä¼šå°è¯•ä¿æŠ¤å…¶æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ã€‚ ä¸€å¥è¯ï¼š æŸæ—¶åˆ»æŸä¸€ä¸ªå¾®æœåŠ¡ä¸å¯ç”¨äº†ï¼ŒEurekaä¸ä¼šç«‹åˆ»æ¸…ç†ï¼Œä¾æ—§ä¼šå¯¹è¯¥å¾®æœåŠ¡çš„ä¿¡æ¯è¿›è¡Œä¿å­˜ã€‚</p><p>å¦‚æœåœ¨Eureka Serverçš„é¦–é¡µçœ‹åˆ°ä»¥ä¸‹è¿™æ®µæç¤ºï¼Œåˆ™è¯´æ˜Eurekaè¿›å…¥äº†ä¿æŠ¤æ¨¡å¼ã€‚å±äºCAPé‡Œé¢çš„APåˆ†æ”¯ã€‚</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154722.png" alt=""></p><h4 id="_2-è§£å†³" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³" aria-hidden="true">#</a> 2. è§£å†³</h4><h5 id="_1-eurekaæœåŠ¡ç«¯" tabindex="-1"><a class="header-anchor" href="#_1-eurekaæœåŠ¡ç«¯" aria-hidden="true">#</a> 1. eurekaæœåŠ¡ç«¯</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154737.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154807.png" alt=""></p><h5 id="_2-å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#_2-å®¢æˆ·ç«¯" aria-hidden="true">#</a> 2. å®¢æˆ·ç«¯</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154759.png" alt=""></p><p>ä½†å®¢æˆ·ç«¯æŒ‚äº†å,eurekaç›´æ¥åˆ é™¤</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154819.png" alt=""></p><p>å®•æœº</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154827.png" alt=""></p><hr><h2 id="_4-æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_4-æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 4. æ³¨å†Œä¸­å¿ƒ</h2><p>eurekaåœæ›´.....</p><p>ä½¿ç”¨:</p><ul><li>Zookeeper</li><li>consul</li><li>Nacos(é˜¿é‡Œ)</li></ul><h3 id="_1-zookeeper" tabindex="-1"><a class="header-anchor" href="#_1-zookeeper" aria-hidden="true">#</a> 1. zookeeper</h3><h4 id="_1-æ¦‚è¿°-1" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-1" aria-hidden="true">#</a> 1. æ¦‚è¿°</h4><p>zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åè°ƒå·¥å…·,å¯ä»¥å®ç°æ³¨å†Œä¸­å¿ƒåŠŸèƒ½</p><p>https://blog.csdn.net/qq_41211642/article/details/104821619</p><h4 id="_2-å…¥é—¨" tabindex="-1"><a class="header-anchor" href="#_2-å…¥é—¨" aria-hidden="true">#</a> 2. å…¥é—¨</h4><h5 id="_1-ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-ä¾èµ–" aria-hidden="true">#</a> 1.ä¾èµ–</h5><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--springbootæ•´åˆzookeeperå®¢æˆ·ç«¯--&gt;</span>
<span class="token comment">&lt;!--æ›¿ä»£eureka--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zookeeper-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-é…ç½®-1" tabindex="-1"><a class="header-anchor" href="#_2-é…ç½®-1" aria-hidden="true">#</a> 2.é…ç½®</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#æœåŠ¡åˆ«å----æ³¨å†Œzookeeperåˆ°æ³¨å†Œä¸­å¿ƒåç§°</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>provider<span class="token punctuation">-</span>payment
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment"># zookeeperé…ç½®</span>
    <span class="token key atrule">zookeeper</span><span class="token punctuation">:</span>
      <span class="token key atrule">connect-string</span><span class="token punctuation">:</span> 116.196.118.167<span class="token punctuation">:</span><span class="token number">2181</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_3-ä»£ç " aria-hidden="true">#</a> 3.ä»£ç </h5><p><code>@EnableDiscoveryClient</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * @Author: CHGGX
 * @Date: 2020/03/30 14:25
 * @Description: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span> Zookeeperä½œä¸ºæœåŠ¡å™¨ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
 * @EnableDiscoveryClient // è¯¥æ³¨è§£ç”¨æˆ·æƒ³ä½¿ç”¨consulæˆ–è€…zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒæ˜¯æœåŠ¡æ³¨å†Œ
 */</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain8004</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain8004</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;payment&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${server.port}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/zk&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentZk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;SpringCloud with Zookeeper: &quot;</span> <span class="token operator">+</span> serverPort <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-jaråŒ…å†²çª" tabindex="-1"><a class="header-anchor" href="#_3-jaråŒ…å†²çª" aria-hidden="true">#</a> 3. jaråŒ…å†²çª</h4><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zookeeper-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--å…ˆæ’é™¤è‡ªå¸¦çš„zookeeper3.5.3--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--æ·»åŠ zookeeper3.5.6ç‰ˆæœ¬--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>PSï¼š</strong> æ–°ç‰ˆæœ¬çš„zookeeperè¿˜ä¼šé‡åˆ°slf4jå’Œlog4jåŒ…å†²çªçš„é—®é¢˜ï¼Œæ­¤æ—¶åœ¨zookeeperå»æ‰slf4jçš„ä¾èµ–</p><h4 id="_4-zookeeperä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒ-å¾®æœåŠ¡ä½œä¸ºèŠ‚ç‚¹æ³¨å†Œè¿›æ¥-é‚£è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸´æ—¶è¿˜æ˜¯æŒä¹…" tabindex="-1"><a class="header-anchor" href="#_4-zookeeperä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒ-å¾®æœåŠ¡ä½œä¸ºèŠ‚ç‚¹æ³¨å†Œè¿›æ¥-é‚£è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸´æ—¶è¿˜æ˜¯æŒä¹…" aria-hidden="true">#</a> 4. zookeeperä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå¾®æœåŠ¡ä½œä¸ºèŠ‚ç‚¹æ³¨å†Œè¿›æ¥ï¼Œé‚£è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸´æ—¶è¿˜æ˜¯æŒä¹…ï¼Ÿ</h4><p>å…³äºEurekaæˆ‘ä»¬çŸ¥é“ï¼Œå¶å°”æœ‰ä¸€æ—¶åˆ»æœåŠ¡æä¾›è€…å‡ºäº†ç‚¹æ•…éšœï¼ŒEurekaä¼šå¼€å¯è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œå¾®æœåŠ¡ä¸ä¼šè¢«åˆ é™¤ï¼Œé‚£ç°åœ¨å…³é—­8004è¯•ä¸€ä¸‹zookeeperä¸­çš„æœåŠ¡ä¼šæœ‰ä»€ä¹ˆå˜åŒ–å—</p><ul><li>å¯ä»¥çœ‹å‡ºï¼ŒZookeeperä¹Ÿæ˜¯åœ¨ä¸€å®šæ—¶é—´å†…ï¼Œä¸ä¼šå‰”é™¤æœåŠ¡ï¼Œè¶…æ—¶æ‰å‰”é™¤ï¼Œæ‰€ä»¥zookeeperå…·å¤‡çš„<strong>æœåŠ¡èŠ‚ç‚¹æ˜¯ä¸´æ—¶çš„</strong>ã€‚å½“ä½ å†å¯åŠ¨8004æ—¶ï¼Œzookeeperè¿˜ä¼šè‡ªåŠ¨ç›‘å¬æœåŠ¡çŠ¶æ€ï¼Œä½†æ˜¯æµæ°´å·æ˜¯ä¸€ä¸ªæ–°çš„æµæ°´å·ã€‚</li></ul><hr><h3 id="_2-consul" tabindex="-1"><a class="header-anchor" href="#_2-consul" aria-hidden="true">#</a> 2. consul</h3><p>å®˜ç½‘: https://www.consul.io/</p><p>https://blog.csdn.net/qq_41211642/article/details/104828632</p><h4 id="_1-æ¦‚è¿°-2" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-2" aria-hidden="true">#</a> 1. æ¦‚è¿°</h4><p>consul æ˜¯ä¸€å°å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ç³»ç»Ÿ,æœ‰HashiCorpå…¬å¸ç”¨</p><p><code>GO</code>è¯­è¨€å¼€å‘</p><p>æä¾›äº†å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„æœåŠ¡ä¹‹ç±»,é…ç½®ä¸­å¿ƒ,æ§åˆ¶æ€»çº¿....</p><ul><li>å¯è§†åŒ–ç•Œé¢</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> consul<span class="token punctuation">-</span>provider<span class="token punctuation">-</span>peyment
  <span class="token comment">###consulæ³¨å†Œä¸­å¿ƒåœ°å€</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">consul</span><span class="token punctuation">:</span>
      <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8500</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token comment">#hostname: 127.0.0.1</span>
        <span class="token key atrule">service-name</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾èµ–</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--springcloud consul-server--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-consul-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-consulå®‰è£…" tabindex="-1"><a class="header-anchor" href="#_2-consulå®‰è£…" aria-hidden="true">#</a> 2. consulå®‰è£…</h4><h5 id="_1-ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#_1-ä¸‹è½½" aria-hidden="true">#</a> 1.ä¸‹è½½</h5><ul><li><p>å®˜ç½‘ä¸‹è½½åœ°å€ï¼š https://www.consul.io/downloads.html</p></li><li><p>å®˜ç½‘ä¸‹è½½å¤ªæ…¢ï¼Œæˆ‘æ‰¾äº†ä¸€ä¸ªç™¾åº¦äº‘åœ°å€ï¼Œæå–ç ï¼š247m https://pan.baidu.com/s/1nMXRms3_ZPhgqawrcEcsdA</p></li></ul><h5 id="_2-å®‰è£…" tabindex="-1"><a class="header-anchor" href="#_2-å®‰è£…" aria-hidden="true">#</a> 2. å®‰è£…</h5><p>ä¸‹è½½å®Œæˆåè§£å‹ï¼Œæ ¹æ®è‡ªå·±å®é™…æƒ…å†µé€‰æ‹©è·¯å¾„</p><ul><li>è§£å‹å®Œæˆåï¼Œåœ¨è§£å‹è·¯å¾„ä¸‹çš„åœ°å€æ è¾“å…¥â€œcmdâ€ï¼Œæ‰“å¼€å‘½ä»¤è¡Œçª—å£ã€‚å¹¶é”®å…¥â€œconsulâ€ï¼Œè‹¥å‡ºç°ä¸€è¿ä¸²è‹±æ–‡åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸï¼Œè§å›¾äºŒã€‚</li></ul><p>å¯åŠ¨ï¼š</p><ul><li>å‘½ä»¤<strong>consul agent -dev</strong>å¯åŠ¨ï¼Œçœ‹åˆ°Consul agent running! å¯åŠ¨æˆåŠŸ</li></ul><p>é€šè¿‡ä»¥ä¸‹åœ°å€å¯ä»¥è®¿é—® Consul é¦–é¡µ <code>http://localhost:8500</code></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154900.png" alt=""></p><hr><h3 id="_3-eureka-consul-zookeeperå¼‚åŒç‚¹" tabindex="-1"><a class="header-anchor" href="#_3-eureka-consul-zookeeperå¼‚åŒç‚¹" aria-hidden="true">#</a> 3. eureka, consul, zookeeperå¼‚åŒç‚¹</h3><h4 id="_1-å¼‚åŒç‚¹" tabindex="-1"><a class="header-anchor" href="#_1-å¼‚åŒç‚¹" aria-hidden="true">#</a> 1. å¼‚åŒç‚¹</h4><table><thead><tr><th>ç»„ä»¶å</th><th>è¯­è¨€</th><th>CAP</th><th>æœåŠ¡å¥åº·å¯æŸ¥</th><th>å¯¹å¤–æš´éœ²æ¥å£</th><th style="text-align:left;">SpringCloudé›†æˆ</th></tr></thead><tbody><tr><td>Eureka</td><td>Java</td><td>AP</td><td>å¯é…æ”¯æŒ</td><td>HTTP</td><td style="text-align:left;">å·²é›†æˆ</td></tr><tr><td>Consul</td><td>Go</td><td>CP</td><td>æ”¯æŒ</td><td>HTTP/DNS</td><td style="text-align:left;">å·²é›†æˆ</td></tr><tr><td>Zookeeper</td><td>Java</td><td>CP</td><td>æ”¯æŒ</td><td>å®¢æˆ·ç«¯</td><td style="text-align:left;">å·²é›†æˆ</td></tr></tbody></table><p>PS: C: å¼ºä¸€è‡´æ€§,A: å¯ç”¨æ€§,P: åˆ†åŒºå®¹é”™æ€§</p><h4 id="_2-capæ ¸å¿ƒç†è®º" tabindex="-1"><a class="header-anchor" href="#_2-capæ ¸å¿ƒç†è®º" aria-hidden="true">#</a> 2. CAPæ ¸å¿ƒç†è®º</h4><p>æœ€å¤šåªèƒ½åŒæ—¶è¾ƒå¥½çš„æ»¡è¶³ä¸¤ä¸ª</p><p>CAPç†è®ºçš„æ ¸å¿ƒæ˜¯ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶å¾ˆå¥½çš„æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ã€‚å› æ­¤ï¼Œæ ¹æ®CAPåŸç†å°†NoSQLæ•°æ®åº“åˆ†æˆäº†æ»¡è¶³CAåŸåˆ™ã€æ»¡è¶³CPåŸåˆ™å’Œæ»¡è¶³APåŸåˆ™ä¸‰å¤§ç±»ã€‚</p><p>CA - å•ç‚¹é›†ç¾¤ï¼Œæ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸åœ¨å¯æ‰©å±•æ€§ä¸Šä¸å¤ªå¼º CP - æ»¡è¶³ä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸æ€§èƒ½ä¸æ˜¯ç‰¹åˆ«é«˜ AP - æ»¡è¶³å¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯èƒ½å¯¹ä¸€è‡´æ€§è¦æ±‚ä½ä¸€äº›</p><h5 id="_1-eureka-1" tabindex="-1"><a class="header-anchor" href="#_1-eureka-1" aria-hidden="true">#</a> 1. eureka</h5><ul><li>Eureka é‡‡ç”¨çš„æ˜¯<strong>APæ¶æ„</strong>ï¼Œåªæ»¡è¶³å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§.</li><li>å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼Œç³»ç»ŸBå¯ä»¥è¿”å›æ—§å€¼ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154943.png" alt=""></p><ul><li>Eurekaæœ‰è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œæ›´å¼ºè°ƒçš„æ˜¯APï¼Œä¿è¯æœåŠ¡çš„é«˜å¯ç”¨ï¼Œå¾®æœåŠ¡å°±æ˜¯å¶å°”å®•æœºæ‰çº¿äº†ï¼Œä¸€æ—¶åŠä¼šä¸ä¼šç«‹åˆ»åˆ é™¤ã€‚</li></ul><h5 id="_2-zookeeper-consul" tabindex="-1"><a class="header-anchor" href="#_2-zookeeper-consul" aria-hidden="true">#</a> 2. zookeeper/consul</h5><ul><li>Zookeeper å’Œ Consulé‡‡ç”¨çš„æ˜¯<strong>CPæ¶æ„</strong>ï¼Œæ»¡è¶³ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™æ€§</li><li>å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œå°±å¿…é¡»æ‹’ç»è¯·æ±‚ï¼Œå¦åˆ™æ— æ³•ä¿è¯ä¸€è‡´æ€§ã€‚</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223154955.png" alt=""></p><p>PS: Zookeeperã€Consulæ³¨å†Œçš„å¾®æœåŠ¡æ˜¯ä¸€ä¸ª<strong>ä¸´æ—¶èŠ‚ç‚¹</strong>ï¼Œåªè¦å¾®æœåŠ¡ä¸å¯ç”¨ï¼Œå‘å¿ƒè·³æµ‹è¯•æ”¶ä¸åˆ°äº†ï¼Œå°±è¿…é€Ÿå‰”é™¤å¾®æœåŠ¡ï¼Œå¾®æœåŠ¡æ¢å¤è¿‡æ¥ä»¥åï¼Œä¼šé‡æ–°æ¢ä¸€ä¸ªserviceIDã€‚</p><hr><h2 id="_4-è´Ÿè½½å‡è¡¡-æœåŠ¡è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_4-è´Ÿè½½å‡è¡¡-æœåŠ¡è°ƒç”¨" aria-hidden="true">#</a> 4. è´Ÿè½½å‡è¡¡[æœåŠ¡è°ƒç”¨]</h2><h3 id="_1-rbbon" tabindex="-1"><a class="header-anchor" href="#_1-rbbon" aria-hidden="true">#</a> 1. Rbbon</h3><p>https://blog.csdn.net/qq_41211642/article/details/104838727</p><h4 id="_1-æ¦‚è¿°-3" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-3" aria-hidden="true">#</a> 1. æ¦‚è¿°</h4><p>Ribbon ç®€ä»‹ï¼š</p><p>Spring Cloud Ribbon æ˜¯åŸºäºNetflix Ribbon å®ç°çš„ä¸€å¥—å®¢æˆ·ç«¯ <strong>è´Ÿè½½å‡è¡¡</strong>çš„å·¥å…·ã€‚</p><p>Ribbon æ˜¯ Netflix å‘å¸ƒçš„å¼€æºé¡¹ç›®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•å’ŒæœåŠ¡è°ƒç”¨ã€‚Ribbon å®¢æˆ·ç«¯ç»„ä»¶æä¾›ä¸€ç³»åˆ—å®Œå–„çš„é…ç½®é¡¹å¦‚è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç­‰ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡º Load Balancerï¼ˆç®€ç§°LBï¼‰åé¢æ‰€æœ‰çš„æœºå™¨ï¼ŒRibbon ä¼šè‡ªåŠ¨çš„å¸®åŠ©ä½ åŸºäºæŸç§è§„åˆ™ï¼ˆå¦‚ç®€å•è½®è¯¢ã€éšæœºè¿æ¥ç­‰ï¼‰å»è¿æ¥è¿™äº›æœºå™¨ã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“ä½¿ç”¨Ribbonå®ç°è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</p><p>å®˜ç½‘èµ„æ–™ï¼šhttps://github.com/Netflix/ribbon/wiki/Getting-starte27</p><p><strong>PSï¼š</strong> Ribbonç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼ï¼ŒSpringCloud æƒ³ç”¨Spring Cloud LoadBalancer æ›¿ä»£ Netflix çš„Ribbon ï¼Œä½†ç°åœ¨ Ribbon åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¤§è§„æ¨¡éƒ¨ç½²ï¼Œä¸€æ—¶åŠä¼šæ›¿ä¸æ‰</p><h4 id="_2-ä½œç”¨-lbè´Ÿè½½å‡è¡¡-load-balance" tabindex="-1"><a class="header-anchor" href="#_2-ä½œç”¨-lbè´Ÿè½½å‡è¡¡-load-balance" aria-hidden="true">#</a> 2. ä½œç”¨ï¼š LBè´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰</h4><p>ç®€å•çš„è¯´å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šçš„åˆ†é…åˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„HAï¼ˆé«˜å¯ç”¨ï¼‰ã€‚å¸¸è§çš„è´Ÿè½½å‡è¡¡æœ‰è½¯ä»¶ Nginxï¼ŒLVSï¼Œç¡¬ä»¶F5 ç­‰ã€‚</p><h5 id="_1-é›†ä¸­å¼b" tabindex="-1"><a class="header-anchor" href="#_1-é›†ä¸­å¼b" aria-hidden="true">#</a> 1. é›†ä¸­å¼B</h5><p>å³åœ¨æœåŠ¡çš„æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹ä¹‹é—´ä½¿ç”¨<strong>ç‹¬ç«‹çš„LBè®¾æ–½</strong>ï¼ˆå¯ä»¥æ˜¯ç¡¬ä»¶ï¼Œå¦‚F5ï¼Œä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶ï¼Œå¦‚nginxï¼‰,ç”±è¯¥è®¾æ–½è´Ÿè´£æŠŠè®¿é—®è¯·æ±‚é€šè¿‡æŸç§ç­–ç•¥è½¬å‘è‡³æœåŠ¡çš„æä¾›æ–¹</p><h5 id="_2-è¿›ç¨‹å†…lb" tabindex="-1"><a class="header-anchor" href="#_2-è¿›ç¨‹å†…lb" aria-hidden="true">#</a> 2. è¿›ç¨‹å†…LB</h5><p>å°† LB <strong>é€»è¾‘é›†æˆåˆ°æ¶ˆè´¹æ–¹</strong>ï¼Œæ¶ˆè´¹æ–¹ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·çŸ¥æœ‰å“ªäº›åœ°å€å¯ç”¨ï¼Œç„¶åè‡ªå·±å†ä»è¿™äº›åœ°å€ä¸­é€‰æ‹©å‡ºä¸€ä¸ªåˆé€‚çš„æœåŠ¡å™¨ã€‚Ribbonå°±å±äºè¿›ç¨‹å†… LB ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç±»åº“ï¼Œé›†æˆä¸æ¶ˆè´¹æ–¹è¿›ç¨‹ï¼Œæ¶ˆè´¹æ–¹é€šè¿‡å®ƒæ¥è·å–åˆ°æœåŠ¡æä¾›æ–¹çš„åœ°å€ã€‚</p><h5 id="_3-ribbon-æœ¬åœ°è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯-å’Œ-nginx-æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_3-ribbon-æœ¬åœ°è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯-å’Œ-nginx-æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡-åŒºåˆ«" aria-hidden="true">#</a> 3. Ribbon æœ¬åœ°è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ å’Œ Nginx æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡ åŒºåˆ«ï¼š</h5><ul><li><p>Nginx æ˜¯æœåŠ¡å™¨è´Ÿè½½å‡è¡¡ï¼Œå®¢æˆ·ç«¯æ‰€æœ‰è¯·æ±‚éƒ½ä¼šäº¤ç»™ nginx ï¼Œç„¶åç”± nginx å®ç°è½¬å‘è¯·æ±‚ã€‚å³è´Ÿè½½å‡è¡¡æ˜¯ç”±æœåŠ¡ç«¯å®ç°çš„ã€‚</p></li><li><p>Ribbon æœ¬åœ°è´Ÿè½½å‡è¡¡ï¼Œåœ¨è°ƒç”¨å¾®æœåŠ¡æ¥å£æ—¶å€™ï¼Œä¼šåœ¨æ³¨å†Œä¸­å¿ƒä¸Šè·å–æ³¨å†Œä¿¡æ¯æœåŠ¡åˆ—è¡¨ä¹‹åç¼“å­˜åˆ°JVMæœ¬åœ°ï¼Œä»è€Œåœ¨æœ¬åœ°å®ç° RPC è¿œç¨‹æœåŠ¡è°ƒç”¨æŠ€æœ¯ã€‚</p></li></ul><p>æ€»ä¹‹ä¸€å¥è¯ï¼š <strong>Ribbon å°±æ˜¯ è´Ÿè½½å‡è¡¡ + RestTemplateè°ƒç”¨ï¼Œæœ€ç»ˆå®ç°RPCçš„è¿œç¨‹è°ƒç”¨</strong></p><h4 id="_3-æ¶æ„" tabindex="-1"><a class="header-anchor" href="#_3-æ¶æ„" aria-hidden="true">#</a> 3. æ¶æ„</h4><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>Ribbonï¼š
<span class="token key attr-name">Ribbon</span> <span class="token value attr-value">æ˜¯ä¸€ä¸ªè½¯è´Ÿè½½å‡è¡¡çš„å®¢æˆ·ç«¯ç»„ä»¶ï¼Œå®ƒå¯ä»¥å’Œå…¶ä»–æ‰€éœ€è¯·æ±‚çš„å®¢æˆ·ç«¯ç»“åˆä½¿ç”¨ï¼Œå’Œ eureka ç»“åˆåªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå®ä¾‹ã€‚</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155008.png" alt=""></p><p><strong>Ribbon åœ¨å·¥ä½œæ—¶åˆ†æˆä¸¤æ­¥ï¼š</strong></p><ul><li>ç¬¬ä¸€æ­¥å…ˆé€‰æ‹© EurekaServerï¼Œå®ƒä¼˜å…ˆé€‰æ‹©åœ¨åŒä¸€ä¸ªåŒºåŸŸå†…è´Ÿè½½è¾ƒå°‘çš„server</li><li>ç¬¬äºŒæ­¥å†æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç­–ç•¥ï¼Œåœ¨ä»server å–åˆ°çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªåœ°å€</li></ul><p>å…¶ä¸­Ribbon æä¾›äº†å¤šç§ç­–ç•¥ï¼šæ¯”å¦‚<strong>è½®è¯¢</strong>ã€<strong>éšæœº</strong>å’Œæ ¹æ®å“åº”æ—¶é—´åŠ æƒ</p><p>æ–°ç‰ˆeurekaå¼•å…¥äº†ribbonï¼Œæ‰€ä»¥ä¸ç”¨è‡ªå·±å¼•å…¥ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿè½½å‡è¡¡</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155016.png" alt=""></p><p><strong>RestTemplateä½¿ç”¨ï¼š</strong></p><p>å®˜ç½‘ï¼šhttps://docs.spring.io/spring-framework/docs/5.2.2.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html</p><p>getForObject æ–¹æ³• / getForEntityæ–¹æ³•</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155027.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155037.png" alt=""></p><p><strong>ç¤ºä¾‹ ** getForObject æ–¹æ³• / getForEntityæ–¹æ³• æ¨è</strong>getForObject** æ–¹æ³•</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/create&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Payment</span> payment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/create&quot;</span><span class="token punctuation">,</span> payment<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/create2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">create2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Payment</span> payment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CommonResult</span><span class="token punctuation">&gt;</span></span> entity <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForEntity</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/create&quot;</span><span class="token punctuation">,</span> payment<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entity<span class="token punctuation">.</span><span class="token function">getStatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is2xxSuccessful</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> entity<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span><span class="token string">&quot;æ“ä½œå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/get/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/get/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/getForEntity/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">getPayment2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CommonResult</span><span class="token punctuation">&gt;</span></span> entity <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForEntity</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/get/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entity<span class="token punctuation">.</span><span class="token function">getStatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is2xxSuccessful</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> entity<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span><span class="token string">&quot;æ“ä½œå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-ribbonæ ¸å¿ƒç»„ä»¶irule" tabindex="-1"><a class="header-anchor" href="#_4-ribbonæ ¸å¿ƒç»„ä»¶irule" aria-hidden="true">#</a> 4. ribbonæ ¸å¿ƒç»„ä»¶IRule</h4><p>IRule: <code>æ ¹æ®ç‰¹å®šç®—æ³•ä»æœåŠ¡åˆ—è¡¨ä¸­é€‰å–ä¸€ä¸ªè¦è®¿é—®çš„æœåŠ¡</code></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155050.png" alt=""></p><ul><li>com.netflix.loadbalancer.<strong>RoundRobinRule</strong> è½®è¯¢</li><li>com.netflix.loadbalancer.<strong>RandomRule</strong> éšæœº</li><li>com.netflix.loadbalancer.<strong>RetryRule</strong> å…ˆæŒ‰ç…§RoundRobinRuleçš„ç­–ç•¥è·å–æœåŠ¡ï¼Œå¦‚æœè·å–æœåŠ¡å¤±è´¥åˆ™åœ¨æŒ‡å®šæ—¶é—´å†…ä¼šè¿›è¡Œé‡è¯•ï¼Œè·å–å¯ç”¨çš„æœåŠ¡</li><li>WeightedResponseTimeRule å¯¹RoundRobinRuleçš„æ‰©å±•ï¼Œå“åº”é€Ÿåº¦è¶Šå¿«çš„å®ä¾‹é€‰æ‹©æƒé‡è¶Šå¤§ï¼Œè¶Šå®¹æ˜“è¢«é€‰æ‹©</li><li>BestAvailableRule ä¼šå…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå¹¶å‘é‡æœ€å°çš„æœåŠ¡</li><li>AvailabilityFilteringRule å…ˆè¿‡æ»¤æ‰æ•…éšœå®ä¾‹ï¼Œå†é€‰æ‹©å¹¶å‘è¾ƒå°çš„å®ä¾‹ ZoneAvoidanceRule é»˜è®¤è§„åˆ™ï¼Œå¤åˆåˆ¤æ–­serveræ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½å’Œserverçš„å¯ç”¨æ€§é€‰æ‹©æœåŠ¡å™¨</li></ul><h4 id="_5-ribbon-è´Ÿè½½è§„åˆ™æ›¿æ¢" tabindex="-1"><a class="header-anchor" href="#_5-ribbon-è´Ÿè½½è§„åˆ™æ›¿æ¢" aria-hidden="true">#</a> 5. Ribbon è´Ÿè½½è§„åˆ™æ›¿æ¢</h4><h5 id="_1-æ·»åŠ è§„åˆ™ç±»" tabindex="-1"><a class="header-anchor" href="#_1-æ·»åŠ è§„åˆ™ç±»" aria-hidden="true">#</a> 1 æ·»åŠ è§„åˆ™ç±»ï¼š</h5><p><strong>æ³¨æ„ï¼š</strong> å®˜æ–¹æ–‡æ¡£æ˜ç¡®ç»™å‡ºäº†è­¦å‘Šï¼š</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155101.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/ribbonè§„åˆ™æ›¿æ¢è­¦å‘Š2.png?x-oss-process=style/shuiyin_1" alt=""></p><p>è§£å†³è­¦å‘Š</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155108.png" alt=""></p><h5 id="_2-è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡è§„åˆ™ç±»" tabindex="-1"><a class="header-anchor" href="#_2-è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡è§„åˆ™ç±»" aria-hidden="true">#</a> 2.<em>è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡è§„åˆ™ç±»</em></h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySelfRule</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">IRule</span> <span class="token function">myRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// éšæœº</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RandomRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155119.png" alt=""></p><h4 id="_6-ribbonè´Ÿè½½å‡è¡¡ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_6-ribbonè´Ÿè½½å‡è¡¡ç®—æ³•" aria-hidden="true">#</a> 6. ribbonè´Ÿè½½å‡è¡¡ç®—æ³•</h4><h5 id="_1-åŸç†" tabindex="-1"><a class="header-anchor" href="#_1-åŸç†" aria-hidden="true">#</a> 1. åŸç†</h5><p><strong>è½®è¯¢</strong>ç®—æ³•</p><p><code>rest æ¥å£ç¬¬å‡ æ¬¡è¯·æ±‚æ•° % æœåŠ¡å™¨é›†ç¾¤æ€»æ•°é‡ = å®é™…è°ƒç”¨æœåŠ¡å™¨ä½ç½®ä¸‹æ ‡</code><code>æ¯æ¬¡æœåŠ¡å™¨é‡å¯årestæ¥å£æ•°ä»1å¼€å§‹</code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;CLOUD-PROVIDER-SERVICE&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚ï¼š</p><ul><li>List[0] instances = 127.0.0.1:8002</li><li>List[1] instances = 127.0.0.1:8001</li></ul><p>8001 + 8002 ç»„åˆæˆä¸ºé›†ç¾¤ï¼Œå®ƒä»¬å…±è®¡2å°æœºå™¨ï¼Œé›†ç¾¤æ€»æ•°ä¸º2ï¼ŒæŒ‰ç…§è½®è¯¢ç®—æ³•åŸç†ï¼š</p><table><thead><tr><th style="text-align:center;"><strong>æ€»è¯·æ±‚æ•°</strong></th><th style="text-align:center;"><strong>å¯¹åº”ä¸‹æ ‡</strong></th><th style="text-align:center;"><strong>è·å¾—æœåŠ¡å™¨åœ°å€</strong></th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;">1 % 2 = 1</td><td style="text-align:center;">127.0.0.1:8001</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">2 %2 = 0</td><td style="text-align:center;">127.0.0.1:8002</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;">3 % 2 = 1</td><td style="text-align:center;">127.0.0.1:8001</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">4 % 2 = 0</td><td style="text-align:center;">127.0.0.1:8002</td></tr><tr><td style="text-align:center;">...</td><td style="text-align:center;">...</td><td style="text-align:center;"></td></tr></tbody></table><h5 id="_2-æºç " tabindex="-1"><a class="header-anchor" href="#_2-æºç " aria-hidden="true">#</a> 2. æºç </h5><h6 id="_1-irule" tabindex="-1"><a class="header-anchor" href="#_1-irule" aria-hidden="true">#</a> 1. IRule</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/*
*
* Copyright 2013 Netflix, Inc.
*
* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
*/</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>netflix<span class="token punctuation">.</span>loadbalancer</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Interface that defines a &quot;Rule&quot; for a LoadBalancer. A Rule can be thought of
 * as a Strategy for loadbalacing. Well known loadbalancing strategies include
 * Round Robin, Response Time based etc.
 * 
 * <span class="token keyword">@author</span> stonse
 * 
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IRule</span><span class="token punctuation">{</span>
    <span class="token comment">/*
     * choose one alive server from lb.allServers or
     * lb.upServers according to key
     * 
     * @return choosen Server object. NULL is returned if none
     *  server is available 
     */</span>

    <span class="token keyword">public</span> <span class="token class-name">Server</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoadBalancer</span><span class="token punctuation">(</span><span class="token class-name">ILoadBalancer</span> lb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">ILoadBalancer</span> <span class="token function">getLoadBalancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-roundrobinrule" tabindex="-1"><a class="header-anchor" href="#_2-roundrobinrule" aria-hidden="true">#</a> 2.RoundRobinRule</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/*
 *
 * Copyright 2013 Netflix, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>netflix<span class="token punctuation">.</span>loadbalancer</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>netflix<span class="token punctuation">.</span>client<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">IClientConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span></span><span class="token class-name">AtomicInteger</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * The most well known and basic load balancing strategy, i.e. Round Robin Rule.
 *
 * <span class="token keyword">@author</span> stonse
 * <span class="token keyword">@author</span> Nikos Michalakis <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nikos@netflix.com</span><span class="token punctuation">&gt;</span></span>
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RoundRobinRule</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractLoadBalancerRule</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AtomicInteger</span> nextServerCyclicCounter<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token constant">AVAILABLE_ONLY_SERVERS</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token constant">ALL_SERVERS</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">RoundRobinRule</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RoundRobinRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nextServerCyclicCounter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">RoundRobinRule</span><span class="token punctuation">(</span><span class="token class-name">ILoadBalancer</span> lb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setLoadBalancer</span><span class="token punctuation">(</span>lb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Server</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token class-name">ILoadBalancer</span> lb<span class="token punctuation">,</span> <span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lb <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;no load balancer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Server</span> server <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>server <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> count<span class="token operator">++</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Server</span><span class="token punctuation">&gt;</span></span> reachableServers <span class="token operator">=</span> lb<span class="token punctuation">.</span><span class="token function">getReachableServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Server</span><span class="token punctuation">&gt;</span></span> allServers <span class="token operator">=</span> lb<span class="token punctuation">.</span><span class="token function">getAllServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> upCount <span class="token operator">=</span> reachableServers<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> serverCount <span class="token operator">=</span> allServers<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>upCount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>serverCount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;No up servers available from load balancer: &quot;</span> <span class="token operator">+</span> lb<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">int</span> nextServerIndex <span class="token operator">=</span> <span class="token function">incrementAndGetModulo</span><span class="token punctuation">(</span>serverCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            server <span class="token operator">=</span> allServers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nextServerIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>server <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">/* Transient. */</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">isReadyToServe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Next.</span>
            server <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;No available alive servers after 10 tries from load balancer: &quot;</span>
                    <span class="token operator">+</span> lb<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> server<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Inspired by the implementation of <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">AtomicInteger</span><span class="token punctuation">#</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>.
     *
     * <span class="token keyword">@param</span> <span class="token parameter">modulo</span> The modulo to bound the value of the counter.
     * <span class="token keyword">@return</span> The next value.
     * è‡ªæ—‹é”
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">incrementAndGetModulo</span><span class="token punctuation">(</span><span class="token keyword">int</span> modulo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> current <span class="token operator">=</span> nextServerCyclicCounter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> next <span class="token operator">=</span> <span class="token punctuation">(</span>current <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> modulo<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nextServerCyclicCounter<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Server</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token function">getLoadBalancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initWithNiwsConfig</span><span class="token punctuation">(</span><span class="token class-name">IClientConfig</span> clientConfig<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-æ‰‹å†™ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_3-æ‰‹å†™ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•" aria-hidden="true">#</a> 3. æ‰‹å†™ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•</h5><p>åŸç†+JUC(CAS+è‡ªæ—‹é”å¤ä¹ )</p><h6 id="_1-æ”¹å†™æä¾›è€…-2ä¸ª" tabindex="-1"><a class="header-anchor" href="#_1-æ”¹å†™æä¾›è€…-2ä¸ª" aria-hidden="true">#</a> 1.æ”¹å†™æä¾›è€…(2ä¸ª)</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/lb&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">gePaymentLb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> serverPost<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-æ¶ˆè´¹è€…" tabindex="-1"><a class="header-anchor" href="#_2-æ¶ˆè´¹è€…" aria-hidden="true">#</a> 2. æ¶ˆè´¹è€…</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Bean</span>
<span class="token comment">//    @LoadBalanced æ³¨é‡Šæ‰</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥å£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> loadBalancer <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è·å–ç¤ºä¾‹
     *
     * <span class="token keyword">@param</span> <span class="token parameter">serviceInstances</span> æœåŠ¡è¿›ç¨‹ä¿¡æ¯
     * <span class="token keyword">@return</span> ä¿¡æ¯
     */</span>
    <span class="token class-name">ServiceInstance</span> <span class="token function">instances</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> serviceInstances<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ç°ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * @Author: CHGGX
 * @Date: 2020/03/30 20:07
 * @Description: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span> è‡ªå®šä¹‰ribbonè½®è¯¢ç®—æ³• <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLb</span> <span class="token keyword">implements</span> loadBalancer <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AtomicInteger</span> atomicInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> current<span class="token punctuation">;</span>
        <span class="token keyword">int</span> next<span class="token punctuation">;</span>
        <span class="token keyword">do</span> <span class="token punctuation">{</span>
            current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>atomicInteger<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            next <span class="token operator">=</span> current <span class="token operator">&gt;=</span> <span class="token number">2147483647</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> current <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>atomicInteger<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*****ç¬¬å‡ æ¬¡è®¿é—®,æ¬¡æ•°next: &quot;</span> <span class="token operator">+</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> next<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ServiceInstance</span> <span class="token function">instances</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> serviceInstances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// `rest æ¥å£ç¬¬å‡ æ¬¡è¯·æ±‚æ•° % æœåŠ¡å™¨é›†ç¾¤æ€»æ•°é‡ = å®é™…è°ƒç”¨æœåŠ¡å™¨ä½ç½®ä¸‹æ ‡`</span>
        <span class="token comment">//`æ¯æ¬¡æœåŠ¡å™¨é‡å¯årestæ¥å£æ•°ä»1å¼€å§‹`</span>
        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> serviceInstances<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> serviceInstances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 2147483647</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5controller</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> loadBalancer loadBalancer<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscoveryClient</span> discoveryClient<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * ä½¿ç”¨è‡ªå®šä¹‰çš„è½®è¯¢ç®—æ³•,
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/lb&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPaymentLb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>instances<span class="token operator">==</span><span class="token keyword">null</span> <span class="token operator">||</span> instances<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨è‡ªå®šä¹‰</span>
    <span class="token class-name">ServiceInstance</span> serviceInstance <span class="token operator">=</span> loadBalancer<span class="token punctuation">.</span><span class="token function">instances</span><span class="token punctuation">(</span>instances<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">URI</span> uri <span class="token operator">=</span> serviceInstance<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>uri<span class="token operator">+</span><span class="token string">&quot;/payment/lb&quot;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_5-æœåŠ¡è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_5-æœåŠ¡è°ƒç”¨" aria-hidden="true">#</a> 5. æœåŠ¡è°ƒç”¨</h2><p>feign: åœæ›´</p><p>https://blog.csdn.net/qq_41211642/article/details/104846752</p><h3 id="_1-openfeign" tabindex="-1"><a class="header-anchor" href="#_1-openfeign" aria-hidden="true">#</a> 1. openFeign</h3><p>å®˜ç½‘ï¼šhttps://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#spring-cloud-openfeign</p><h4 id="_1-feign-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_1-feign-ç®€ä»‹" aria-hidden="true">#</a> 1. Feign ç®€ä»‹ï¼š</h4><p>Feign æ˜¯ä¸€ä¸ªå£°æ˜å¼ WebService å®¢æˆ·ç«¯ã€‚ä½¿ç”¨ Feign èƒ½è®©ç¼–å†™Web Service å®¢æˆ·ç«¯æ›´åŠ ç®€å•ã€‚</p><p>å®ƒçš„ä½¿ç”¨æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªæœåŠ¡æ¥å£ç„¶ååœ¨ä¸Šé¢æ·»åŠ æ³¨è§£ã€‚Feign ä¹Ÿæ”¯æŒå¯æ’æ‹”å¼çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚Spring Cloud å¯¹ Feign è¿›è¡Œäº†å°è£…ï¼Œä½¿å…¶æ”¯æŒäº†Spring MVCæ ‡å‡†æ³¨è§£å’Œ HttpMessageConvertersã€‚Feign å¯ä»¥ä¸ Eurekaå’ŒRibbon ç»„åˆä½¿ç”¨ä»¥æ”¯æŒè´Ÿè½½å‡è¡¡ã€‚</p><p>Githubï¼šhttps://github.com/spring-cloud/spring-cloud-openfeign</p><h4 id="_2-feign-èƒ½å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-feign-èƒ½å¹²ä»€ä¹ˆ" aria-hidden="true">#</a> 2 . Feign èƒ½å¹²ä»€ä¹ˆï¼Ÿ</h4><p>Feign æ—¨åœ¨ä½¿ç¼–å†™Java Http å®¢æˆ·ç«¯å˜å¾—æ›´å®¹æ˜“ã€‚ å‰é¢åœ¨ä½¿ç”¨ <strong>Ribbon+RestTemplate</strong>æ—¶ï¼Œåˆ©ç”¨RestTemplate å¯¹httpè¯·æ±‚çš„å°è£…å¤„ç†ï¼Œå½¢æˆäº†ä¸€å¥—æ¨¡æ¿åŒ–çš„è°ƒç”¨æ–¹æ³•ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå¯¹æœåŠ¡ä¾èµ–çš„è°ƒç”¨å¯èƒ½ä¸æ­¢ä¸€å¤„ï¼Œå¾€å¾€ä¸€ä¸ªæ¥å£ä¼šè¢«å¤šå¤„è°ƒç”¨ï¼Œæ‰€ä»¥é€šå¸¸éƒ½ä¼šé’ˆå¯¹æ¯ä¸ªå¾®æœåŠ¡è‡ªè¡Œå°è£…ä¸€äº›å®¢æˆ·ç«¯ç±»æ¥åŒ…è£…è¿™äº›ä¾èµ–æœåŠ¡çš„è°ƒç”¨ã€‚æ‰€ä»¥ï¼ŒFeign åœ¨æ­¤åŸºç¡€ä¸Šåšäº†è¿›ä¸€æ­¥å°è£…ï¼Œç”±ä»–æ¥å¸®åŠ©æˆ‘ä»¬å®šä¹‰å’Œå®ç°ä¾èµ–æœåŠ¡æ¥å£çš„å®šä¹‰ã€‚åœ¨Feign çš„å®ç°ä¸‹ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒï¼ˆä»¥å‰æ˜¯Daoæ¥å£ä¸Šé¢æ ‡æ³¨Mapperæ³¨è§£ï¼Œç°åœ¨æ˜¯ä¸€ä¸ªå¾®æœåŠ¡æ¥å£ä¸Šé¢æ ‡æ³¨è¡£ä¸€ä¸ªFeignæ³¨è§£å³å¯ï¼‰ï¼Œå³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®šï¼Œç®€åŒ–äº†ä½¿ç”¨Spring Cloud Ribbonæ—¶ï¼Œè‡ªåŠ¨å°è£…æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯çš„å¼€å‘é‡ã€‚</p><h4 id="_3-feigné›†æˆäº†ribbon" tabindex="-1"><a class="header-anchor" href="#_3-feigné›†æˆäº†ribbon" aria-hidden="true">#</a> 3. Feigné›†æˆäº†Ribbon</h4><p>åˆ©ç”¨Ribbonç»´æŠ¤äº†Payment çš„æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡è½®è¯¢å®ç°äº†å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚è€Œä¸Ribbonä¸åŒçš„æ˜¯ï¼Œé€šè¿‡feign åªéœ€è¦å®šä¹‰æœåŠ¡ç»‘å®šæ¥å£ä¸”ä»¥å£°æ˜å¼çš„æ–¹æ³•ï¼Œä¼˜é›…è€Œç®€å•çš„å®ç°äº†æœåŠ¡è°ƒç”¨ã€‚</p><h4 id="_4-feign-å’Œ-openfeign-ä¸¤è€…åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_4-feign-å’Œ-openfeign-ä¸¤è€…åŒºåˆ«" aria-hidden="true">#</a> 4. Feign å’Œ OpenFeign ä¸¤è€…åŒºåˆ«</h4><p>Feignæ˜¯Springcloudç»„ä»¶ä¸­çš„ä¸€ä¸ªè½»é‡çº§Restfulçš„HTTPæœåŠ¡å®¢æˆ·ç«¯ï¼ŒFeignå†…ç½®äº†Ribbonï¼Œç”¨æ¥åšå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œå»è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡ã€‚Feignçš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼šä½¿ç”¨Feignçš„æ³¨è§£å®šä¹‰æ¥å£ï¼Œè°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-feign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>OpenFeignæ˜¯springcloudåœ¨Feignçš„åŸºç¡€ä¸Šæ”¯æŒäº†SpringMVCçš„æ³¨è§£ï¼Œå¦‚@RequestMappingç­‰ç­‰ã€‚OpenFeignçš„@FeignClientå¯ä»¥è§£æSpringMVCçš„@RequestMappingæ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œå®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-openfeignç¼–ç " tabindex="-1"><a class="header-anchor" href="#_2-openfeignç¼–ç " aria-hidden="true">#</a> 2. openFeignç¼–ç </h3><p><code>@EnableFeignClients</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/payment&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentFeignService</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * æ ¹æ®idè·å–payment
     *
     * <span class="token keyword">@param</span> <span class="token parameter">id</span> id
     * <span class="token keyword">@return</span> payment
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/get/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPaymentById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-openfeignè¶…æ—¶æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_3-openfeignè¶…æ—¶æ§åˆ¶" aria-hidden="true">#</a> 3. openfeignè¶…æ—¶æ§åˆ¶</h3><p>https://blog.csdn.net/qq_41211642/article/details/104850857</p><p>è§£å†³:</p><p>openFeign å†…ä¸ ribbon æ•´åˆäº†ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡ï¼Œå®ƒçš„è¶…æ—¶æ§åˆ¶ä¹Ÿç”±æœ€åº•å±‚çš„ ribbon è¿›è¡Œæ§åˆ¶ï¼Œyml æ·»åŠ é…ç½®</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#è®¾ç½®feign å®¢æˆ·ç«¯è¶…æ—¶æ—¶é—´ï¼ˆopenFeigné»˜è®¤æ”¯æŒribbonï¼‰</span>
<span class="token key atrule">ribbon</span><span class="token punctuation">:</span>
<span class="token comment">#æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥æ‰€ç”¨çš„æ—¶é—´ï¼Œé€‚ç”¨äºç½‘ç»œçŠ¶å†µæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œä¸¤ç«¯è¿æ¥æ‰€ç”¨çš„æ—¶é—´</span>
  <span class="token key atrule">ReadTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
<span class="token comment">#æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥åä»æœåŠ¡å™¨è¯»å–åˆ°å¯ç”¨èµ„æºæ‰€ç”¨çš„æ—¶é—´</span>
  <span class="token key atrule">ConnectTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-openfeignæ—¥å¿—æ‰“å°" tabindex="-1"><a class="header-anchor" href="#_4-openfeignæ—¥å¿—æ‰“å°" aria-hidden="true">#</a> 4. openfeignæ—¥å¿—æ‰“å°</h3><p>https://blog.csdn.net/qq_41211642/article/details/104851537</p><p><strong>æ—¥å¿—çº§åˆ«ï¼š</strong></p><ul><li>NONEï¼šé»˜è®¤çš„ï¼Œä¸æ˜¾ç¤ºä»»ä½•æ—¥å¿—</li><li>BASICï¼šä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€URLã€å“åº”çŠ¶æ€ç åŠæ‰§è¡Œæ—¶é—´</li><li>HEADERSï¼šé™¤äº† BASIC ä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯</li><li>FULLï¼šé™¤äº† HEADERS ä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„æ­£æ–‡åŠå…ƒæ•°æ®</li></ul><p><strong>æ·»åŠ é…ç½®æ—¥å¿—Bean</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FeignConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Logger<span class="token punctuation">.</span>Level</span> <span class="token function">feignLoggerLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Logger<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span><span class="token constant">FULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>yml é…ç½®å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token comment">#feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span>
    <span class="token key atrule">com.chggx.springboot.service.PaymentFeignService</span><span class="token punctuation">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_6-æœåŠ¡é™çº§" tabindex="-1"><a class="header-anchor" href="#_6-æœåŠ¡é™çº§" aria-hidden="true">#</a> 6. æœåŠ¡é™çº§</h2><h3 id="_1-hystrix-1" tabindex="-1"><a class="header-anchor" href="#_1-hystrix-1" aria-hidden="true">#</a> 1. Hystrix</h3><p>https://blog.csdn.net/qq_41211642/article/details/104851945</p><h4 id="_1-é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-é—®é¢˜" aria-hidden="true">#</a> 1. é—®é¢˜</h4><h5 id="_1-åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜" aria-hidden="true">#</a> 1. åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</h5><p>å¤æ‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„åº”ç”¨ç¨‹åºæœ‰æ•°åä¸ªä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªä¾èµ–å…³ç³»åœ¨æŸä¸ªæ—¶å€™å°†ä¸å¯é¿å…çš„å¤±è´¥ã€‚</p><h5 id="_2-æœåŠ¡é›ªå´©" tabindex="-1"><a class="header-anchor" href="#_2-æœåŠ¡é›ªå´©" aria-hidden="true">#</a> 2. æœåŠ¡é›ªå´©ï¼š</h5><p>å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ—¶å€™ï¼Œå‡è®¾å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cï¼Œå¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cåˆè°ƒç”¨å…¶ä»–çš„å¾®æœåŠ¡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ â€œ æ‰‡å‡º â€ ã€‚ å¦‚æœæ‰‡å‡ºçš„é“¾è·¯ä¸ŠæŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨ï¼Œå¯¹å¾®æœåŠ¡A çš„è°ƒç”¨å°±ä¼šå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æºï¼Œè¿›è€Œå¼•èµ·ç³»ç»Ÿå´©æºƒï¼Œæ‰€è°“çš„ â€œ é›ªå´©æ•ˆåº” â€ã€‚</p><p>å¯¹äºé«˜æµé‡çš„åº”ç”¨æ¥è¯´ï¼Œå•ä¸€çš„åç«¯ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½åœ¨å‡ ç§’é’Ÿå†…é¥±å’Œã€‚æ¯”å¤±è´¥æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¿˜å¯èƒ½å¯¼è‡´æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿå¢åŠ ï¼Œå¤‡ä»½é˜Ÿåˆ—ï¼Œçº¿ç¨‹å’Œå…¶ä»–ç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå‘ç”Ÿæ›´å¤šçš„çº§è”æ•…éšœã€‚è¿™äº›éƒ½è¡¨ç¤ºéœ€è¦å¯¹æ•…éšœå’Œå»¶è¿Ÿè¿›è¡Œéš”ç¦»å’Œç®¡ç†ï¼Œä»¥ä¾¿å•ä¸ªä¾èµ–å…³ç³»çš„å¤±è´¥ï¼Œä¸èƒ½å–æ¶ˆæ•´ä¸ªåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿã€‚</p><p>æ‰€ä»¥ï¼Œé€šå¸¸å½“ä½ å‘ç°ä¸€ä¸ªæ¨¡å—ä¸‹çš„æŸä¸ªå®ä¾‹å¤±è´¥åï¼Œè¿™æ—¶å€™è¿™ä¸ªæ¨¡å—ä¾ç„¶è¿˜ä¼šæ¥å—æµé‡ï¼Œç„¶åè¿™ä¸ªæœ‰é—®é¢˜çš„æ¨¡å—è¿˜è°ƒç”¨äº†å…¶ä»–çš„æ¨¡å—ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿçº§è”æ•…éšœï¼Œæˆ–è€…å« é›ªå´©ã€‚</p><p>è¦é¿å…è¿™æ ·çš„çº§è”æ•…éšœï¼Œå°±éœ€è¦æœ‰ä¸€ç§é“¾è·¯ä¸­æ–­çš„æ–¹æ¡ˆï¼š <strong>æœåŠ¡é™çº§</strong>ã€<strong>æœåŠ¡ç†”æ–­</strong></p><h4 id="_2-hystrix-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_2-hystrix-ç®€ä»‹" aria-hidden="true">#</a> 2. Hystrix ç®€ä»‹ï¼š</h4><p>Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å»¶è¿Ÿå’Œå®¹é”™çš„å¼€æºåº“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥ï¼Œæ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥ï¼Œé¿å…çº§è”æ•…éšœï¼Œå·²æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚</p><p>â€œ æ–­è·¯å™¨ â€ æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘é€æ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”ï¼ˆFallBackï¼‰ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸ï¼Œè¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚</p><ul><li><p>å®˜ç½‘: https://github.com/Netflix/Hystrix/wiki/How-To-Use</p></li><li><p>Hystrix å®˜å®£ï¼šåœæ›´è¿›å…¥ç»´æŠ¤é˜¶æ®µ</p></li><li><p>springæ¨èä½¿ç”¨ <strong>resilience4j</strong> æ›¿ä»£ï¼Œä½†æ˜¯å›½å†…ç”¨çš„æ¯”è¾ƒå°‘ï¼Œåç»­ä¼šä»‹ç» <strong>SpringCloud Alibaba Sentinel</strong> å®ç°ç†”æ–­å’Œæ–­æµã€‚</p></li></ul><h3 id="_2-èƒ½å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-èƒ½å¹²ä»€ä¹ˆ" aria-hidden="true">#</a> 2. èƒ½å¹²ä»€ä¹ˆ?</h3><h4 id="_1-hystrix-åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_1-hystrix-åŠŸèƒ½" aria-hidden="true">#</a> 1. Hystrix åŠŸèƒ½ï¼š</h4><ul><li><p>æœåŠ¡é™çº§: fallback</p></li><li><p>æœåŠ¡ç†”æ–­: break</p></li><li><p>æ¥è¿‘å®æ—¶çš„ç›‘æ§</p></li><li><p>é™æµã€éš”ç¦»ç­‰: flowlimit</p></li></ul><h4 id="_2-hystrixé‡è¦æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_2-hystrixé‡è¦æ¦‚å¿µ" aria-hidden="true">#</a> 2. Hystrixé‡è¦æ¦‚å¿µï¼š</h4><h5 id="_1-æœåŠ¡é™çº§-fallback" tabindex="-1"><a class="header-anchor" href="#_1-æœåŠ¡é™çº§-fallback" aria-hidden="true">#</a> **1.æœåŠ¡é™çº§ï¼š**fallback</h5><h6 id="åœºæ™¯ä¸€" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯ä¸€" aria-hidden="true">#</a> åœºæ™¯ä¸€:</h6><p><code>æœåŠ¡å™¨å¿™ï¼Œè¯·ç¨åå†è¯•ï¼Œä¸è®©å®¢æˆ·ç«¯ç­‰å¾…å¹¶ç«‹åˆ»è¿”å›ä¸€ä¸ªå‹å¥½æç¤º.fallback</code></p><p>æ‰“ç”µè¯å‡ºç°å¯¹æ–¹æ­£åœ¨é€šè¯,è¯·ç¨åå†æ’­.</p><h6 id="å“ªäº›æƒ…å†µä¼šå‘å‡ºé™çº§" tabindex="-1"><a class="header-anchor" href="#å“ªäº›æƒ…å†µä¼šå‘å‡ºé™çº§" aria-hidden="true">#</a> å“ªäº›æƒ…å†µä¼šå‘å‡ºé™çº§ï¼Ÿ</h6><ul><li>ç¨‹åºè¿è¡Œå¼‚å¸¸</li><li>è¶…æ—¶</li><li>æœåŠ¡ç†”æ–­è§¦å‘æœåŠ¡é™çº§</li><li>çº¿ç¨‹æ±  / ä¿¡å·é‡æ‰“æ»¡ä¹Ÿä¼šå¯¼è‡´æœåŠ¡é™çº§</li></ul><h5 id="_2-æœåŠ¡ç†”æ–­-break" tabindex="-1"><a class="header-anchor" href="#_2-æœåŠ¡ç†”æ–­-break" aria-hidden="true">#</a> <strong>2.æœåŠ¡ç†”æ–­</strong> break</h5><p>ç±»ä¼¼ä¿é™©ä¸è¾¾åˆ°æœ€å¤§æœåŠ¡è®¿é—®åï¼Œç›´æ¥æ‹’ç»è®¿é—®ï¼Œæ‹‰é—¸é™ç”µï¼Œç„¶åè°ƒç”¨æœåŠ¡é™çº§çš„æ–¹æ³•å¹¶è¿”å›å‹å¥½æç¤º</p><h5 id="_3-æœåŠ¡é™æµ-flowlimit" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡é™æµ-flowlimit" aria-hidden="true">#</a> <strong>3.æœåŠ¡é™æµ</strong> flowlimit</h5><p>ç§’æ€é«˜å¹¶å‘ç­‰æ“ä½œï¼Œä¸¥ç¦ä¸€çªèœ‚çš„è¿‡æ¥æ‹¥æŒ¤ï¼Œå¤§å®¶æ’é˜Ÿï¼Œä¸€ç§’é’ŸNä¸ªï¼Œæœ‰åºè¿›è¡Œ</p><h3 id="_3-æœåŠ¡é™çº§" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡é™çº§" aria-hidden="true">#</a> 3. æœåŠ¡é™çº§ ğŸ˜„</h3><h4 id="_1-é™çº§å®¹é”™è§£å†³çš„ç»´åº¦è¦æ±‚" tabindex="-1"><a class="header-anchor" href="#_1-é™çº§å®¹é”™è§£å†³çš„ç»´åº¦è¦æ±‚" aria-hidden="true">#</a> 1.é™çº§å®¹é”™è§£å†³çš„ç»´åº¦è¦æ±‚</h4><h5 id="_1-è¦æ±‚" tabindex="-1"><a class="header-anchor" href="#_1-è¦æ±‚" aria-hidden="true">#</a> 1. è¦æ±‚</h5><ol><li><p>è¶…æ—¶å¯¼è‡´æœåŠ¡å™¨å˜æ…¢ (è½¬åœˆ)</p><ul><li>è¶…æ—¶ä¸å†ç­‰å¾…</li></ul></li><li><p>å‡ºé”™ï¼ˆå®•æœºæˆ–ç¨‹åºè¿è¡Œå‡ºé”™ï¼‰</p><ul><li>å‡ºé”™è¦æœ‰å…œåº•</li></ul></li><li><p>è§£å†³</p><ul><li><p>å¯¹æ–¹æœåŠ¡(8001)è¶…æ—¶äº†ï¼Œè°ƒç”¨è€…(80)ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p></li><li><p>å¯¹æ–¹æœåŠ¡(8001)å®•æœºäº†ï¼Œè°ƒç”¨è€…(80)ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p></li><li><p>å¯¹æ–¹æœåŠ¡(8001)OKï¼Œè°ƒç”¨è€…(80)è‡ªå·±å‡ºæ•…éšœæˆ–æœ‰è‡ªæˆ‘è¦æ±‚(è‡ªå·±çš„ç­‰å¾…æ—¶é—´å°äºæœåŠ¡æä¾›è€…)ï¼Œè‡ªå·±å¤„ç†é™çº§</p></li></ul></li></ol><h5 id="_2-ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#_2-ä»£ç -1" aria-hidden="true">#</a> 2. ä»£ç :</h5><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--hystrix ç†”æ–­é™æµ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-hystrix<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>æœåŠ¡ç«¯</li></ol><p>https://blog.csdn.net/qq_41211642/article/details/104859026</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æŸ¥å®è®¿é—®,TimeOut
 * * @HystrixCommandæŠ¥å¼‚å¸¸åå¦‚ä½•å¤„ç†ï¼š
 * 1. ä¸€æ—¦è°ƒç”¨æœåŠ¡æ–¹æ³•å¤±è´¥å¹¶æŠ›å‡ºäº†é”™è¯¯ä¿¡æ¯åï¼Œ
 * 2. ä¼šè‡ªåŠ¨è°ƒç”¨@HystrixCommandæ ‡æ³¨å¥½çš„fallbackMethodè°ƒç”¨ç±»ä¸­çš„æŒ‡å®šæ–¹æ³•
 *
 * <span class="token keyword">@param</span> <span class="token parameter">id</span> id
 * <span class="token keyword">@return</span> String
 */</span>
<span class="token annotation punctuation">@HystrixCommand</span><span class="token punctuation">(</span>fallbackMethod <span class="token operator">=</span> <span class="token string">&quot;paymentInfo_TimeOutHandler&quot;</span><span class="token punctuation">,</span> commandProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">//è®¾ç½®è¿™ä¸ªçº¿ç¨‹çš„è¶…æ—¶æ—¶é—´æ˜¯3sï¼Œ3så†…æ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¶…è¿‡3sè°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•è¿›è¡Œå¤„ç†</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;execution.isolation.thread.timeoutInMilliseconds&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOut</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> timeNumber <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token comment">// int age = 10/0&#39;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>timeNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;çº¿ç¨‹æ± : &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; paymentInfo_TimeOut,id: &quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;O(âˆ©_âˆ©)Oå“ˆå“ˆ~&quot;</span> <span class="token operator">+</span> <span class="token string">&quot; è€—æ—¶(ç§’)&quot;</span> <span class="token operator">+</span> timeNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * å‡ºé”™è¦æœ‰å…œåº•: å…œåº•æ–¹æ³•
 */</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOutHandler</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;çº¿ç¨‹æ± : &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ç³»ç»Ÿç¹å¿™,è¯·ç¨åå†è¯•,id: &quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ç±»æ·»åŠ </p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableCircuitBreaker</span><span class="token operator">:</span> <span class="token comment">// å›è·¯</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>å®¢æˆ·ç«¯(æ¨è)</li></ol><ul><li>é…ç½®æ–‡ä»¶</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># å¼€å¯hystrix</span>
<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯åŠ¨ç±»</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableHystrix</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>controller</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hystrix/timeout/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@HystrixCommand</span><span class="token punctuation">(</span>fallbackMethod <span class="token operator">=</span> <span class="token string">&quot;paymentTimeOutFallbackMethod&quot;</span><span class="token punctuation">,</span> commandProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">//è®¾ç½®è¿™ä¸ªçº¿ç¨‹çš„è¶…æ—¶æ—¶é—´æ˜¯3sï¼Œ3så†…æ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¶…è¿‡3sè°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•è¿›è¡Œå¤„ç†</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;execution.isolation.thread.timeoutInMilliseconds&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;1500&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOut</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span>  paymentHystrixService<span class="token punctuation">.</span><span class="token function">paymentInfo_TimeOut</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/**
 * å‡ºé”™è¦æœ‰å…œåº•: å…œåº•æ–¹æ³•
 */</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentTimeOutFallbackMethod</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;æˆ‘æ˜¯æ¶ˆè´¹è€…80,å¯¹æ–¹æ”¯ä»˜ç³»ç»Ÿç¹å¿™è¯·10ç§’é’Ÿåå†è¯•æˆ–è€…è‡ªå·±è¿è¡Œå¤„å¤„,è¯·æ£€æŸ¥è‡ªå·±,o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PS: æˆ‘ä»¬è‡ªå·±é…ç½®è¿‡çš„çƒ­éƒ¨ç½²æ–¹å¼å¯¹Javaä»£ç çš„æ”¹åŠ¨æ˜æ˜¾ï¼Œä½†å¯¹@HystrixCommandå†…å±æ€§çš„ä¿®æ”¹å»ºè®®é‡å¯å¾®æœåŠ¡ã€‚</p><h4 id="_2-ä¼˜åŒ–ä»£ç " tabindex="-1"><a class="header-anchor" href="#_2-ä¼˜åŒ–ä»£ç " aria-hidden="true">#</a> 2. ä¼˜åŒ–ä»£ç </h4><h5 id="_1-é—®é¢˜-1" tabindex="-1"><a class="header-anchor" href="#_1-é—®é¢˜-1" aria-hidden="true">#</a> 1. é—®é¢˜</h5><ul><li><strong>é—®é¢˜1:</strong></li></ul><p>è¿™æ ·å¦‚æœæ¯ä¸ªä¸šåŠ¡æ–¹æ³•éƒ½å¯¹åº”ä¸€ä¸ªå…œåº•çš„æ–¹æ³•ï¼Œ100ä¸ªæ–¹æ³•å°±æœ‰100ä¸ªæœåŠ¡é™çº§ï¼Œä¼šå‡ºç°ä»£ç è†¨èƒ€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„ fallbackMethodï¼Œç»Ÿä¸€çš„å’Œè‡ªå®šä¹‰çš„åˆ†å¼€ã€‚</p><ul><li><strong>é—®é¢˜2ï¼š</strong></li></ul><p>ç°åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å…³ç³»ç´§ç´§è€¦åˆï¼Œå®¢æˆ·ç«¯èƒ½è·‘æ˜¯å› ä¸ºæ¥å£è°ƒç”¨äº†å¾®æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œæˆ‘ä»¬å¦‚æœé’ˆå¯¹å®¢æˆ·ç«¯æ¥å£åšä¸€äº›å¤„ç†ï¼ŒæŠŠå®ƒè°ƒç”¨çš„æ‰€æœ‰å¾®æœåŠ¡æ–¹æ³•è¿›è¡Œé™çº§ï¼Œå°±å¯ä»¥è§£å†³è€¦åˆé—®é¢˜ã€‚</p><h5 id="_2-è§£å†³-1" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³-1" aria-hidden="true">#</a> 2. è§£å†³</h5><h6 id="_1-è§£å†³1" tabindex="-1"><a class="header-anchor" href="#_1-è§£å†³1" aria-hidden="true">#</a> 1. è§£å†³1</h6><p>@DefaultProperties(defaultFallback = &quot;&quot;)</p><p>1 : 1 æ¯ä¸ªæ–¹æ³•é…ç½®ä¸€ä¸ªæœåŠ¡é™çº§æ–¹æ³•ï¼Œé€ æˆä»£ç è†¨èƒ€</p><p>1 : N é™¤äº†ä¸ªåˆ«é‡è¦æ ¸å¿ƒä¸šåŠ¡æœ‰ä¸“å±ï¼Œå…¶ä»–æ™®é€šçš„å¯ä»¥é€šè¿‡@DefaultProperties(defaultFallback = â€œâ€) ç»Ÿä¸€è·³è½¬åˆ°ç»Ÿä¸€å¤„ç†ç»“æœé¡µé¢</p><p>è¿™æ ·<strong>é€šç”¨çš„å’Œç‹¬äº«çš„å„è‡ªåˆ†å¼€ï¼Œé¿å…äº†ä»£ç è†¨èƒ€ï¼Œåˆç†å‡å°‘äº†ä»£ç é‡ã€‚</strong></p><p><strong>æ­¥éª¤:</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¸‹é¢æ˜¯å…¨å±€fallbackæ–¹æ³•,
 */</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">payment_Global_FallbackMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Globalå¼‚å¸¸å¤„ç†ä¿¡æ¯,è¯·ç¨åå†è¯•.o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç±»ä¸Šæ·»åŠ </li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@DefaultProperties</span><span class="token punctuation">(</span>defaultFallback <span class="token operator">=</span> <span class="token string">&quot;payment_Global_FallbackMethod&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ·»åŠ é™çº§æ³¨è§£</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@HystrixCommand</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>PS: å¦‚æœæœ‰è‡ªå·±çš„,ä½¿ç”¨è‡ªå·±çš„</p><h6 id="_2-è§£å†³2" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³2" aria-hidden="true">#</a> 2. è§£å†³2</h6><ul><li>å¯¹æ¥å£ä½¿ç”¨ @FeignClient(fallback = xxx.class) ------&gt;fallback = PaymentFallbackService.class</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;CLOUD-PROVIDER-HYSTRIX-PAYMENT&quot;</span><span class="token punctuation">,</span>fallback <span class="token operator">=</span> <span class="token class-name">PaymentFallbackService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/payment&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentHystrixService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hystrix/ok/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_ok</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hystrix/timeout/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOut</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯¹feignæ¥å£è¿›è¡Œå®ç°,æ¥è¿›è¡ŒæœåŠ¡é™çº§å¤„ç†(ç»Ÿä¸€æœåŠ¡é™çº§å¤„ç†)</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentFallbackService</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentHystrixService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_ok</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;-------PaymentFallbackService fall back-paymentInfo_ok ,o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOut</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;-------PaymentFallbackService fall back-paymentInfo_TimeOut ,o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æœåŠ¡ç†”æ–­" tabindex="-1"><a class="header-anchor" href="#_4-æœåŠ¡ç†”æ–­" aria-hidden="true">#</a> 4.æœåŠ¡ç†”æ–­ ğŸ˜„</h3><p>https://blog.csdn.net/qq_41211642/article/details/104866657</p><p>ç†”æ–­æœºåˆ¶æ¦‚è¿°ï¼š</p><ul><li><strong>ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶</strong>ã€‚å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡å‡ºé”™ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›é”™è¯¯çš„å“åº”ä¿¡æ¯ã€‚</li><li><strong>å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åï¼Œæ¢å¤è°ƒç”¨é“¾è·¯</strong>ã€‚</li></ul><p>åœ¨SpringCloudæ¡†æ¶é‡Œï¼Œç†”æ–­æœºåˆ¶é€šè¿‡Hystrixå®ç°ï¼ŒHystrixä¼šç›‘æ§å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œå½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼ï¼Œç¼ºçœæ˜¯5ç§’å†…20æ¬¡è°ƒç”¨å¤±è´¥ï¼Œå°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯**@HystrixCommand**</p><h4 id="_1-æœåŠ¡çš„é™çº§-è¿›è€Œç†”æ–­-æ¢å¤è°ƒç”¨é“¾è·¯" tabindex="-1"><a class="header-anchor" href="#_1-æœåŠ¡çš„é™çº§-è¿›è€Œç†”æ–­-æ¢å¤è°ƒç”¨é“¾è·¯" aria-hidden="true">#</a> 1. æœåŠ¡çš„é™çº§---&gt;è¿›è€Œç†”æ–­---&gt;æ¢å¤è°ƒç”¨é“¾è·¯</h4><p>service</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//============= æœåŠ¡ç†”æ–­ ===========</span>

<span class="token doc-comment comment">/**
 * - **ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶**ã€‚å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡å‡ºé”™ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›é”™è¯¯çš„å“åº”ä¿¡æ¯ã€‚
 * - **å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åï¼Œæ¢å¤è°ƒç”¨é“¾è·¯**
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * è¦æ±‚: 10æ¬¡è¯·æ±‚,åœ¨10så†…å¤±è´¥ç‡è¾¾åˆ°60%å¼€å¯æ–­è·¯å™¨
 * HystrixCommandProperties: ä¸»è¦å±æ€§
 */</span>
<span class="token annotation punctuation">@HystrixCommand</span><span class="token punctuation">(</span>fallbackMethod <span class="token operator">=</span> <span class="token string">&quot;paymentCircuitBreaker_fallback&quot;</span><span class="token punctuation">,</span> commandProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ˜¯å¦å¼€å¯æ–­è·¯å™¨</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;circuitBreaker.enabled&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// è¯·æ±‚æ¬¡æ•°</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;circuitBreaker.requestVolumeThreshold&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// æ—¶é—´çª—å£æœŸ</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;circuitBreaker.sleepWindowInMilliseconds&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;10000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// å¤±è´¥ç‡è¾¾åˆ°å¤šå°‘åè·³é—¸</span>
        <span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;circuitBreaker.errorThresholdPercentage&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;60&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentCircuitBreaker</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;******id ä¸èƒ½ä¸ºè´Ÿæ•°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ç­‰ä»·äº UUID.randomUUID().toString();</span>
    <span class="token comment">// hutool å·¥å…·åŒ…</span>
    <span class="token class-name">String</span> serialNumber <span class="token operator">=</span> <span class="token class-name">IdUtil</span><span class="token punctuation">.</span><span class="token function">simpleUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;è°ƒç”¨æˆåŠŸ,æµæ°´å·: &quot;</span> <span class="token operator">+</span> serialNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * å…œåº•æ–¹æ³•
 */</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentCircuitBreaker_fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;id ä¸èƒ½è´Ÿæ•°,è¯·ç¨åå†è¯•,o(â•¥ï¹â•¥)o id: &quot;</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>controller</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// ===== æœåŠ¡ç†”æ–­ ======</span>

<span class="token doc-comment comment">/**
 * æœåŠ¡ç†”æ–­
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/circuit/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentCircuitBreaker</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> resutl <span class="token operator">=</span> paymentService<span class="token punctuation">.</span><span class="token function">paymentCircuitBreaker</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;******resukt: &quot;</span> <span class="token operator">+</span> resutl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resutl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»“æœ:</p><ul><li>æ­£ç¡®: æ”¾è¡Œ</li><li>é”™è¯¯; æ‹¦æˆª</li><li>Controller è°ƒç”¨ Serviceï¼Œè¯·æ±‚æ•°10æ¬¡å†…å‡ºç°6æ¬¡ä»¥ä¸Šé”™è¯¯ï¼Œå°±ä¼šè§¦å‘ç†”æ–­ï¼Œç†”æ–­åæ­£ç¡®çš„è¯·æ±‚ä¹Ÿä¸èƒ½ç«‹åˆ»è¢«å“åº”ï¼Œè€Œæ˜¯<strong>ç¼“æ…¢ã€æ­£ç¡®ç‡é«˜äº†æ‰å“åº”ã€‚</strong></li></ul><p>æœåŠ¡çš„é™çº§ --&gt; è¿›è€Œç†”æ–­ --&gt; æ¢å¤è°ƒç”¨é“¾è·¯</p><h4 id="_2-ç»“è®º" tabindex="-1"><a class="header-anchor" href="#_2-ç»“è®º" aria-hidden="true">#</a> 2. ç»“è®º</h4><h5 id="_1-ç†”æ–­ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1-ç†”æ–­ç±»å‹" aria-hidden="true">#</a> 1. ç†”æ–­ç±»å‹</h5><ul><li>ç†”æ–­æ‰“å¼€ è¯·æ±‚ä¸å†è¿›è¡Œè°ƒç”¨å½“å‰æœåŠ¡ï¼Œå†…éƒ¨è®¾ç½®æ—¶é’Ÿä¸€èˆ¬ä¸ºMTTRï¼ˆå¹³å‡æ•…éšœå¤„ç†æ—¶é—´ï¼‰ï¼Œå½“æ‰“å¼€æ—¶é•¿è¾¾åˆ°æ‰€è®¾æ—¶é’Ÿåˆ™è¿›å…¥åŠç†”æ–­çŠ¶æ€</li><li>ç†”æ–­å…³é—­ ç†”æ–­å…³é—­ä¸ä¼šå¯¹æœåŠ¡è¿›è¡Œè°ƒç”¨</li><li>ç†”æ–­åŠå¼€ éƒ¨åˆ†è¯·æ±‚æ ¹æ®è§„åˆ™è°ƒç”¨å½“å‰æœåŠ¡ï¼Œå¦‚æœè¯·æ±‚æˆåŠŸä¸”ç¬¦åˆè§„åˆ™åˆ™è®¤ä¸ºå½“å‰æœåŠ¡æ¢å¤æ­£å¸¸ï¼Œå…³é—­ç†”æ–­</li></ul><h5 id="_2-æ–­è·¯å™¨åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼€å§‹èµ·ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#_2-æ–­è·¯å™¨åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼€å§‹èµ·ä½œç”¨" aria-hidden="true">#</a> 2. æ–­è·¯å™¨åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼€å§‹èµ·ä½œç”¨</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155148.png" alt=""></p><p>è®¾è®¡åˆ°æ–­è·¯å™¨çš„ä¸‰ä¸ªé‡è¦å‚æ•°ï¼š<strong>å¿«ç…§æ—¶é—´çª—</strong>ã€<strong>è¯·æ±‚æ€»æ•°é˜ˆå€¼</strong>ã€<strong>é”™è¯¯ç™¾åˆ†æ¯”é˜ˆå€¼</strong></p><ol><li><p>å¿«ç…§æ—¶é—´çª—ï¼šæ–­è·¯å™¨ç¡®å®šæ˜¯å¦æ‰“å¼€éœ€è¦ç»Ÿè®¡ä¸€äº›è¯·æ±‚å’Œé”™è¯¯æ•°æ®ï¼Œè€Œç»Ÿè®¡çš„æ—¶é—´èŒƒå›´å°±æ˜¯å¿«ç…§æ—¶é—´çª—ï¼Œé»˜è®¤ä¸ºæœ€è¿‘çš„10ç§’</p></li><li><p>è¯·æ±‚æ€»æ•°é˜ˆå€¼ï¼šåœ¨å¿«ç…§æ—¶é—´å†…ï¼Œå¿…é¡»æ»¡è¶³è¯·æ±‚æ€»æ•°é˜ˆå€¼æ‰æœ‰èµ„æ ¼ç†”æ–­ã€‚é»˜è®¤ä¸º20ï¼Œæ„å‘³ç€åœ¨10ç§’å†…ï¼Œå¦‚æœè¯¥hystrixå‘½ä»¤çš„è°ƒç”¨æ¬¡æ•°ä¸è¶³20æ¬¡ï¼Œå³ä½¿æ‰€æœ‰çš„è¯·æ±‚éƒ½è¶…æ—¶æˆ–å…¶ä»–åŸå› å¤±è´¥ï¼Œæ–­è·¯å™¨éƒ½ä¸ä¼šæ‰“å¼€</p></li><li><p>é”™è¯¯ç™¾åˆ†æ¯”é˜ˆå€¼ï¼šå½“è¯·æ±‚æ€»æ•°åœ¨å¿«ç…§æ—¶é—´çª—å†…è¶…è¿‡é˜ˆå€¼ï¼Œæ¯”å¦‚å‘ç”Ÿäº†30æ¬¡è°ƒç”¨ï¼Œå¦‚æœåœ¨è¿™30æ¬¡è°ƒç”¨ä¸­ï¼Œæœ‰15æ¬¡å‘ç”Ÿäº†è¶…æ—¶å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¶…è¿‡50%çš„é”™è¯¯ç™¾åˆ†æ¯”ï¼Œåœ¨é»˜è®¤è®¾å®š50%é˜ˆå€¼æƒ…å†µä¸‹ï¼Œè¿™æ—¶å€™å°±ä¼šå°†æ–­è·¯å™¨æ‰“å¼€</p></li></ol><h5 id="_3-æ–­è·¯å™¨å¼€å¯æˆ–å…³é—­çš„æ¡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-æ–­è·¯å™¨å¼€å¯æˆ–å…³é—­çš„æ¡ä»¶" aria-hidden="true">#</a> 3. æ–­è·¯å™¨å¼€å¯æˆ–å…³é—­çš„æ¡ä»¶</h5><ol><li><p>å½“æ»¡è¶³ä¸€å®šçš„é˜ˆå€¼çš„æ—¶å€™ï¼ˆé»˜è®¤10ç§’å†…è¶…è¿‡20ä¸ªè¯·æ±‚æ¬¡æ•°ï¼‰</p></li><li><p>å½“å¤±è´¥ç‡è¾¾åˆ°ä¸€å®šçš„æ—¶å€™ï¼ˆé»˜è®¤10ç§’å†…è¶…è¿‡50%çš„è¯·æ±‚å¤±è´¥ï¼‰</p></li><li><p>åˆ°è¾¾ä»¥ä¸Šé˜ˆå€¼ï¼Œæ–­è·¯å™¨å°†ä¼šå¼€å¯</p></li><li><p>å½“å¼€å¯çš„æ—¶å€™ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¸ä¼šè¿›è¡Œè½¬å‘</p></li><li><p>ä¸€æ®µæ—¶é—´åï¼ˆé»˜è®¤æ˜¯5ç§’ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æ–­è·¯å™¨æ˜¯åŠå¼€çŠ¶æ€ï¼Œä¼šè®©å…¶ä¸­ä¸€ä¸ªè¯·æ±‚è¿›è¡Œè½¬å‘ã€‚å¦‚æœæˆåŠŸï¼Œæ–­è·¯å™¨ä¼šå…³é—­ï¼Œè‹¥å¤±è´¥ï¼Œç»§ç»­å¼€å¯ã€‚é‡å¤4å’Œ5ã€‚</p></li></ol><h5 id="_4-æ–­è·¯å™¨æ‰“å¼€ä¹‹å" tabindex="-1"><a class="header-anchor" href="#_4-æ–­è·¯å™¨æ‰“å¼€ä¹‹å" aria-hidden="true">#</a> 4. æ–­è·¯å™¨æ‰“å¼€ä¹‹å</h5><ol><li><p><strong>å†æœ‰è¯·æ±‚è°ƒç”¨çš„æ—¶å€™ï¼Œå°†ä¸ä¼šè°ƒç”¨ä¸»é€»è¾‘ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨é™çº§fallback</strong>ã€‚é€šè¿‡æ–­è·¯å™¨ï¼Œå®ç°äº†è‡ªåŠ¨åœ°å‘ç°é”™è¯¯å¹¶å°†é™çº§é€»è¾‘åˆ‡æ¢ä¸ºä¸»é€»è¾‘ï¼Œå‡å°‘å“åº”å»¶è¿Ÿçš„æ•ˆæœã€‚</p></li><li><p>åŸæ¥çš„ä¸»é€»è¾‘è¦å¦‚ä½•æ¢å¤å‘¢ï¼Ÿ <strong>å¯¹äºè¿™ä¸€é—®é¢˜ï¼Œhystrixä¹Ÿä¸ºæˆ‘ä»¬å®ç°äº†è‡ªåŠ¨æ¢å¤åŠŸèƒ½</strong> å½“æ–­è·¯å™¨æ‰“å¼€ï¼Œå¯¹ä¸»é€»è¾‘è¿›è¡Œç†”æ–­ä¹‹åï¼Œhystrixä¼šå¯åŠ¨ä¸€ä¸ªä¼‘çœ æ—¶é—´çª—ï¼Œåœ¨è¿™ä¸ªæ—¶é—´çª—å†…ï¼Œé™çº§é€»è¾‘æ˜¯ä¸´æ—¶çš„æˆä¸ºä¸»é€»è¾‘ï¼Œå½“ä¼‘çœ æ—¶é—´çª—åˆ°æœŸï¼Œç†”æ–­å™¨å°†è¿›å…¥åŠå¼€çŠ¶æ€ï¼Œé‡Šæ”¾ä¸€æ¬¡è¯·æ±‚åˆ°åŸæ¥çš„ä¸»é€»è¾‘ä¸Šï¼Œå¦‚æœæ­¤æ¬¡è¯·æ±‚æ­£å¸¸è¿”å›ï¼Œé‚£ä¹ˆæ–­è·¯å™¨å°†ç»§ç»­é—­åˆï¼Œä¸»é€»è¾‘æ¢å¤ï¼Œå¦‚æœè¿™æ¬¡è¯·æ±‚ä¾ç„¶æœ‰é—®é¢˜ï¼Œæ–­è·¯å™¨ç»§ç»­è¿›å…¥æ‰“å¼€çŠ¶æ€ï¼Œä¼‘çœ æ—¶é—´çª—é‡æ–°è®¡æ—¶ã€‚</p></li></ol><h4 id="_3-hystrixç›¸å…³é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-hystrixç›¸å…³é…ç½®" aria-hidden="true">#</a> 3. Hystrixç›¸å…³é…ç½®ï¼š</h4><p>https://blog.csdn.net/qq_41211642/article/details/104866657</p><h3 id="_5-æœåŠ¡é™æµ" tabindex="-1"><a class="header-anchor" href="#_5-æœåŠ¡é™æµ" aria-hidden="true">#</a> 5. æœåŠ¡é™æµ</h3><p>Alibaba - Sentiel å­¦ä¹ </p><h3 id="_6-hystrix-å›¾å½¢åŒ–dashboardæ­å»ºåŠç›‘æ§æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_6-hystrix-å›¾å½¢åŒ–dashboardæ­å»ºåŠç›‘æ§æµ‹è¯•" aria-hidden="true">#</a> 6. Hystrix å›¾å½¢åŒ–Dashboardæ­å»ºåŠç›‘æ§æµ‹è¯•</h3><h4 id="_1-æ¦‚è¿°-4" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-4" aria-hidden="true">#</a> 1 æ¦‚è¿°</h4><p>é™¤äº†éš”ç¦»ä¾èµ–æœåŠ¡çš„è°ƒç”¨æ„å¤–ï¼ŒHystrixè¿˜æä¾›äº†å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§ï¼ˆHystrix Dashboardï¼‰ï¼ŒHystrixä¼šæŒç»­çš„è®°å½•æ‰€æœ‰é€šè¿‡Hystrixå‘èµ·çš„è¯·æ±‚çš„æ‰§è¡Œä¿¡æ¯ï¼Œå¹¶ä»¥ç»Ÿè®¡æŠ¥è¡¨å’Œå›¾å½¢çš„å½¢å¼å±•ç¤ºç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¯ç§’æ‰§è¡Œå¤šå°‘è¯·æ±‚å¤šå°‘æˆåŠŸï¼Œå¤šå°‘å¤±è´¥ç­‰ã€‚Netflix é€šè¿‡ hystrix-metrics-event-streamé¡¹ç›®å®ç°äº†å¯¹ä»¥ä¸ŠæŒ‡æ ‡çš„ç›‘æ§ã€‚SpringCloudä¹Ÿæä¾›äº†Hystrix Dashboardçš„æ•´åˆï¼Œå¯¹ç›‘æ§å†…å®¹è½¬åŒ–æˆå¯è§†åŒ–ç•Œé¢ã€‚</p><h4 id="_2-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_2-ç¼–ç " aria-hidden="true">#</a> 2.ç¼–ç </h4><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code> <span class="token comment">&lt;!-- hystrixä»ªè¡¨ç›˜ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-hystrix-dashboard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›‘æ§æœåŠ¡éœ€è¦ä¾èµ–</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableHystrixDashboard</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¿é—®</p><p>http://localhost:9001/hystrix</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155217.png" alt=""></p><h4 id="_3-æ–°ç‰ˆæœ¬hystrixéœ€è¦åœ¨ä¸»å¯åŠ¨ç±»ä¸­æŒ‡å®šç›‘æ§è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#_3-æ–°ç‰ˆæœ¬hystrixéœ€è¦åœ¨ä¸»å¯åŠ¨ç±»ä¸­æŒ‡å®šç›‘æ§è·¯å¾„" aria-hidden="true">#</a> 3. æ–°ç‰ˆæœ¬Hystrixéœ€è¦åœ¨ä¸»å¯åŠ¨ç±»ä¸­æŒ‡å®šç›‘æ§è·¯å¾„</h4><p>å¯åŠ¨ç±»æ·»åŠ  (éœ€è¦ç›‘æ§æœåŠ¡çš„å¯åŠ¨ç±»)</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> 
    <span class="token doc-comment comment">/**
     * æ­¤é…ç½®æ˜¯ä¸ºäº†æœåŠ¡ç›‘æ§è€Œé…ç½®ï¼Œä¸æœåŠ¡å®¹é”™æœ¬èº«æ— å…³,SpringCloudå‡çº§åçš„å‘
     * ServletRegistrationBeanå› ä¸ºspringbootçš„é»˜è®¤è·¯å¾„ä¸æ˜¯&quot;/hystrix.stream&quot;ï¼Œ
     * åªè¦åœ¨è‡ªå·±çš„é¡¹ç›®é‡Œé…ç½®ä¸Šä¸‹é¢çš„servletå°±å¯ä»¥äº†
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">HystrixMetricsStreamServlet</span> streamServlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HystrixMetricsStreamServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletRegistrationBean</span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span>streamServlet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">setLoadOnStartup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">addUrlMappings</span><span class="token punctuation">(</span><span class="token string">&quot;/hystrix.stream&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;HystrixMetricsStreamServlet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155226.png" alt=""></p><p>ç›‘æ§çš„åœ°å€å¡«å†™</p><p>http://localhost:8001/hystrix.stream</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155235.png" alt=""></p><p>ç›‘æ§é¡µé¢ä»£è¡¨çš„å«ä¹‰:</p><p><img src="https://img-blog.csdnimg.cn/20200314232629705.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjExNjQy,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="_7-ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#_7-ç½‘å…³" aria-hidden="true">#</a> 7. ç½‘å…³ ğŸ˜„</h2><h3 id="_1-zuul-1" tabindex="-1"><a class="header-anchor" href="#_1-zuul-1" aria-hidden="true">#</a> 1. Zuul</h3><p>åœæ›´ (netflix)</p><h3 id="_2-gateway-1" tabindex="-1"><a class="header-anchor" href="#_2-gateway-1" aria-hidden="true">#</a> 2. gateway</h3><p>spring(è‡ªå·±)</p><p>https://blog.csdn.net/qq_41211642/article/details/104873418</p><h4 id="_1-æ¦‚è¿°-5" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-5" aria-hidden="true">#</a> 1.æ¦‚è¿°</h4><h5 id="_1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_1-ä»‹ç»" aria-hidden="true">#</a> 1. ä»‹ç»</h5><ul><li><p>å®˜ç½‘: https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/</p></li><li><p>Cloud å…¨å®¶æ¡¶ä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ç»„ä»¶å°±æ˜¯ç½‘å…³ï¼Œåœ¨1.xç‰ˆæœ¬ä¸­éƒ½æ˜¯é‡‡ç”¨çš„Zuulç½‘å…³ï¼›ä½†åœ¨2.xç‰ˆæœ¬ä¸­ï¼Œzuulçš„å‡çº§ä¸€ç›´è·³ç¥¨ï¼ŒSpringCloudæœ€åè‡ªå·±ç ”å‘äº†ä¸€ä¸ªç½‘å…³æ›¿ä»£Zuulï¼Œé‚£å°±æ˜¯Spring Cloud Gateway</p></li><li><p>Gatewayæ˜¯åœ¨Spring ç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼ŒåŸºäº<strong>Spring 5ï¼ŒSpringBoot 2å’ŒProject Reactorç­‰æŠ€æœ¯</strong>ã€‚Gatewayæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š<strong>ç†”æ–­ã€é™æµã€é‡è¯•</strong>ç­‰ã€‚</p></li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/gatewayå¥½å¤„.png?x-oss-process=style/shuiyin_1" alt=""></p><p>æ€»ç»“: <strong>Spring Cloud Gateway ä½¿ç”¨çš„Webfluxä¸­çš„reactor-nettyå“åº”å¼ç¼–ç¨‹ç»„ä»¶,åº•å±‚ä½¿ç”¨äº†Nettyé€šè®¯æ¡†æ¶.</strong>(åˆ©äºé«˜å¹¶å‘,<code>éé˜»å¡å¼,å“åº”å¼ç¼–ç¨‹é«˜æ€§èƒ½çš„æ¡†æ¶</code>)</p><h5 id="_2-èƒ½å¹²ä»€ä¹ˆ-1" tabindex="-1"><a class="header-anchor" href="#_2-èƒ½å¹²ä»€ä¹ˆ-1" aria-hidden="true">#</a> 2. èƒ½å¹²ä»€ä¹ˆ?</h5><p><strong>åŠŸèƒ½ï¼š</strong></p><ul><li>åå‘ä»£ç†</li><li>é‰´æƒ</li><li>æµé‡æ§åˆ¶</li><li>ç†”æ–­</li><li>æ—¥å¿—ç›‘æ§ã€‚ã€‚ã€‚</li></ul><h5 id="_3-å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ªé‡Œ" tabindex="-1"><a class="header-anchor" href="#_3-å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ªé‡Œ" aria-hidden="true">#</a> 3. å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ªé‡Œ?</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155257.png" alt=""></p><h5 id="_4-ä¸ºä»€ä¹ˆé€‰æ‹©gateway" tabindex="-1"><a class="header-anchor" href="#_4-ä¸ºä»€ä¹ˆé€‰æ‹©gateway" aria-hidden="true">#</a> 4. <strong>ä¸ºä»€ä¹ˆé€‰æ‹©Gateway</strong></h5><ol><li><p>netflixä¸å¤ªé è°±ï¼Œzuul 2.0ä¸€ç›´è·³ç¥¨ï¼Œè¿Ÿè¿Ÿä¸å‘å¸ƒ</p><ul><li>ä¸€æ–¹é¢å› ä¸ºZuul 1.0å·²ç»è¿›å…¥äº†ç»´æŠ¤é˜¶æ®µï¼Œè€Œä¸”Gatewayæ˜¯SpringCloudå›¢é˜Ÿç ”å‘çš„ï¼Œå€¼å¾—ä¿¡èµ–ã€‚è€Œä¸”å¾ˆå¤šåŠŸèƒ½Zuuléƒ½æ²¡æœ‰ç”¨èµ·æ¥ä¹Ÿéå¸¸çš„ç®€å•ä¾¿æ·ã€‚</li><li>Gatewayæ˜¯åŸºäºå¼‚æ­¥éé˜»å¡æ¨¡å‹ä¸Šè¿›è¡Œå¼€å‘çš„ï¼Œæ€§èƒ½æ–¹é¢ä¸éœ€è¦æ‹…å¿ƒã€‚è™½ç„¶Netflixæ—©å°±å‘å¸ƒäº†æœ€æ–°çš„Zuul 2.xï¼Œä½†SpringCloudè²Œä¼¼æ²¡æœ‰æ•´åˆè®¡åˆ’ã€‚è€Œä¸”Netflixç›¸å…³ç»„ä»¶éƒ½å®£å¸ƒè¿›å…¥ç»´æŠ¤æœŸã€‚</li><li>å¤šæ–¹é¢ç»¼åˆè€ƒè™‘<strong>Gateway</strong>æ˜¯å¾ˆç†æƒ³çš„ç½‘å…³é€‰æ‹©.</li></ul></li><li><p>SpringCloud Gatewayå…·æœ‰å¦‚ä¸‹ç‰¹æ€§</p><ul><li><strong>åŸºäºSpring Framework 5ï¼ŒProject Reactorå’ŒSpring Boot 2.0æ„å»º</strong></li><li><strong>åŠ¨æ€è·¯ç”±</strong>ï¼šèƒ½å¤ŸåŒ¹é…ä»»ä½•è¯·æ±‚å±æ€§</li><li>å¯ä»¥å¯¹è·¯ç”±æŒ‡å®š Predicateï¼ˆæ–­è¨€ï¼‰å’ŒFilterï¼ˆè¿‡æ»¤å™¨ï¼‰</li><li>é›†æˆHystrixçš„æ–­è·¯å™¨åŠŸèƒ½</li><li>é›†æˆSpring Cloud çš„æœåŠ¡å‘ç°åŠŸèƒ½</li><li>æ˜“äºç¼–å†™çš„Predicateï¼ˆæ–­è¨€ï¼‰å’ŒFilterï¼ˆè¿‡æ»¤å™¨ï¼‰</li><li>è¯·æ±‚é™æµåŠŸèƒ½</li><li>æ”¯æŒè·¯å¾„é‡å†™</li></ul></li><li><p>SpringCloud Gateway ä¸ zuul çš„åŒºåˆ«</p><p>åœ¨SpringCloud Finchley æ­£å¼ç‰ˆä¹‹å‰ï¼ŒSpringCloudæ¨èçš„ç½‘å…³æ˜¯Netflixæä¾›çš„Zuulï¼š</p><ul><li>Zuul 1.xæ˜¯ä¸€ä¸ªåŸºäºé˜»å¡ I/O çš„API Gateway</li><li>Zuul 1.xåŸºäºservlet 2.5ä½¿ç”¨é˜»å¡æ¶æ„å®ƒä¸æ”¯æŒä»»ä½•é•¿è¿æ¥ï¼ˆå¦‚websocketï¼‰Zuulçš„è®¾è®¡æ¨¡å¼å’ŒNginxè¾ƒåƒï¼Œæ¯æ¬¡I/O æ“ä½œéƒ½æ˜¯ä»å·¥ä½œçº¿ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œï¼Œè¯·æ±‚çº¿ç¨‹è¢«é˜»å¡åˆ°å·¥ä½œçº¿ç¨‹å®Œæˆï¼Œä½†æ˜¯å·®åˆ«æ˜¯Nginxç”¨C++å®ç°ï¼ŒZuulç”¨Javaå®ç°ï¼Œè€ŒJVMæœ¬èº«ä¼šæœ‰ä¸€æ¬¡åŠ è½½è¾ƒæ…¢çš„æƒ…å†µï¼Œä½¿å¾—zuulçš„æ€§èƒ½ç›¸å¯¹è¾ƒå·®</li><li>Zuul 2.xç†å¿µæ›´å…ˆè¿›ï¼Œå‘åŸºäºNettyéé˜»å¡å’Œæ”¯æŒé•¿è¿æ¥ï¼Œä½†SpringCloudç›®å‰è¿˜æ²¡æœ‰æ•´åˆã€‚Zuul 2.xçš„æ€§èƒ½è¾ƒZuul 1.xæœ‰è¾ƒå¤§æå‡ã€‚åœ¨æ€§èƒ½æ–¹é¢ï¼Œæ ¹æ®å®˜æ–¹æä¾›çš„åŸºå‡†æµ‹è¯•ï¼ŒSpringCloud Gatewayçš„RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰æ˜¯Zuulçš„1.6å€</li><li>SpringCloud Gatewayå»ºç«‹åœ¨Spring Framework5ã€Project Reactorå’ŒSpring Boot 2ä¹‹ä¸Šï¼Œä½¿ç”¨éé˜»å¡API</li><li>SpringCloud Gatewayè¿˜æ”¯æŒWebSocketï¼Œå¹¶ä¸”ä¸Springç´§å¯†é›†æˆç”¨äºæ›´å¥½çš„å¼€å‘ä½“éªŒ</li></ul></li><li><p>Gatewayæ¨¡å‹</p><p>Gatewayæ”¯æŒ <strong>Reactor</strong> å’Œ <strong>WebFlux</strong></p><p>ä¼ ç»Ÿçš„Webæ¡†æ¶ï¼Œæ¯”å¦‚è¯´ï¼šstruts2ï¼Œspringmvcç­‰éƒ½æ˜¯åŸºäºServlet APIä¸servletå®¹å™¨åŸºç¡€ä¹‹ä¸Šè¿è¡Œçš„ã€‚ ä½†æ˜¯Servlet3.1ä¹‹åæœ‰äº†å¼‚æ­¥éé˜»å¡çš„æ”¯æŒï¼Œè€ŒWebFluxæ˜¯ä¸€ä¸ªå…¸å‹éé˜»å¡å¼‚æ­¥çš„æ¡†æ¶ï¼Œå®ƒçš„æ ¸å¿ƒæ˜¯åŸºäºReactorçš„ç›¸å…³APIå®ç°çš„ã€‚ç›¸å¯¹ä¸ä¼ ç»Ÿçš„Webæ¡†æ¶æ¥è¯´ï¼Œå®ƒå¯ä»¥è¿è¡Œåœ¨è¯¸å¦‚Nettyï¼ŒUndertowåŠæ”¯æŒServlet3.1çš„å®¹å™¨ä¸Šã€‚<strong>éé˜»å¡å¼+å‡½æ•°å¼ç¼–ç¨‹</strong></p><p>Spring WebFlux æ˜¯ Spring 5.0å¼•å…¥çš„æ–°çš„å“åº”å¼æ¡†æ¶ï¼ŒåŒºåˆ«äºSpring MVCï¼Œå®ƒä¸éœ€è¦ä¾èµ–Servlet APIï¼Œå®ƒæ˜¯å®Œå…¨å¼‚æ­¥éé˜»å¡çš„ï¼Œå¹¶ä¸”åŸºäº Reactor æ¥å®ç°å“åº”å¼æµè§„èŒƒ</p></li><li><p>zuul 1.xæ¨¡å‹</p><p>SpringCloudä¸­æ‰€é›†æˆçš„Zuulç‰ˆæœ¬ï¼Œé‡‡ç”¨çš„æ˜¯Tomcatå®¹å™¨ï¼Œä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿçš„Servlet IOå¤„ç†æ¨¡å‹ã€‚</p><ol><li><p>Servletç”Ÿå‘½å‘¨æœŸï¼Ÿ servlet ç”± servlet container è¿›è¡Œç”Ÿå‘½å‘¨æœŸç®¡ç† container å¯åŠ¨æ—¶æ„é€  servlet å¯¹è±¡å¹¶è°ƒç”¨ servlet init() è¿›è¡Œåˆå§‹åŒ–ï¼› container è¿è¡Œæ—¶æ¥å—è¯·æ±‚ï¼Œå¹¶ä¸ºæ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¸€èˆ¬ä»çº¿ç¨‹æ± ä¸­è·å–ç©ºé—²çº¿ç¨‹ï¼‰ç„¶åè°ƒç”¨service()ï¼› container å…³é—­æ—¶è°ƒç”¨ servlet destory() é”€æ¯servletï¼›</p></li><li><p>ä¸Šè¿°æ¨¡å¼çš„ç¼ºç‚¹ï¼š servletæ˜¯ä¸€ä¸ªç®€å•çš„ç½‘ç»œIOæ¨¡å‹ï¼Œå½“è¯·æ±‚è¿›å…¥servlet containeræ—¶ï¼Œservlet containerå°±ä¼šä¸ºå…¶ç»‘å®šä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨å¹¶å‘ä¸é«˜çš„åœºæ™¯ä¸‹è¿™ç§æ¨¡å‹æ˜¯é€‚ç”¨çš„ã€‚ä½†æ˜¯ä¸€æ—¦é«˜å¹¶å‘ï¼ˆæ¯”å¦‚ç”¨jmeterå‹æµ‹ï¼‰ï¼Œçº¿ç¨‹æ•°é‡å°±ä¼šæ¶¨ï¼Œè€Œçº¿ç¨‹èµ„æºä»£ä»·æ˜¯æ˜‚è´µçš„ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå†…å­˜æ¶ˆè€—å¤§ï¼‰ä¸¥é‡å½±å“è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚åœ¨ä¸€äº›ç®€å•ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œä¸å¸Œæœ›ä¸ºæ¯ä¸ªrequeståˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼Œåªéœ€è¦1ä¸ªæˆ–å‡ ä¸ªçº¿ç¨‹å°±èƒ½åº”å¯¹æå¤§å¹¶å‘çš„è¯·æ±‚ï¼Œè¿™ç§ä¸šåŠ¡åœºæ™¯ä¸‹servletæ¨¡å‹æ²¡æœ‰ä¼˜åŠ¿</p><p>æ‰€ä»¥Zuul 1.xæ˜¯åŸºäºservletä¹‹ä¸Šçš„ä¸€ä¸ªé˜»å¡å¼å¤„ç†æ¨¡å‹ï¼Œå³springå®ç°äº†å¤„ç†æ‰€æœ‰requestè¯·æ±‚çš„ä¸€ä¸ªservletï¼ˆDispatcherServletï¼‰å¹¶ç”±è¯¥servleté˜»å¡å¼å¤„ç†ã€‚æ‰€ä»¥SpringCloud Zuulæ— æ³•æ‘†è„±servletæ¨¡å‹çš„å¼Šç«¯ã€‚</p></li></ol></li></ol><h4 id="_2-gateway-æ ¸å¿ƒæ¦‚å¿µåŠå·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-gateway-æ ¸å¿ƒæ¦‚å¿µåŠå·¥ä½œæµç¨‹" aria-hidden="true">#</a> 2. Gateway æ ¸å¿ƒæ¦‚å¿µåŠå·¥ä½œæµç¨‹</h4><h5 id="_1-æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_1-æ ¸å¿ƒæ¦‚å¿µ" aria-hidden="true">#</a> 1. æ ¸å¿ƒæ¦‚å¿µ</h5><ol><li><p>Route(è·¯ç”±)ï¼šè·¯ç”±æ˜¯æ„å»ºç½‘å…³çš„åŸºæœ¬æ¨¡å—ï¼Œå®ƒç”±IDã€ç›®æ ‡URIï¼Œä¸€ç³»åˆ—çš„æ–­è¨€å’Œè¿‡æ»¤å™¨ç»„æˆï¼Œå¦‚æœæ–­è¨€ä¸ºtrueåˆ™åŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Predicate(æ–­è¨€)ï¼šå‚è€ƒçš„æ˜¯Java8çš„java.util.function.Predicate å¼€å‘äººå‘˜å¯ä»¥åŒ¹é…HTTPè¯·æ±‚ä¸­çš„æ‰€æœ‰å†…å®¹(ä¾‹å¦‚è¯·æ±‚å¤´æˆ–è¯·æ±‚å‚æ•°)ï¼Œå¦‚æœè¯·æ±‚ä¸æ–­è¨€ç›¸åŒ¹é…åˆ™è¿›è¡Œè·¯ç”±</p></li><li><p>Filter(è¿‡æ»¤)ï¼šæŒ‡çš„æ˜¯Springæ¡†æ¶ä¸­GatewayFilyterçš„å®ä¾‹ï¼Œä½¿ç”¨è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±å‰æˆ–è€…ä¹‹åè¿›è¡Œä¿®æ”¹</p></li></ol><p>åŒ¹é…æ–¹å¼å°±å«æ–­è¨€ï¼Œå®ç°è¿™ä¸ªåŒ¹é…æ–¹å¼å°±å«filterï¼Œå¯¹å¤–è¡¨ç°å‡ºæ¥å°±æ˜¯è·¯ç”±çš„åŠŸèƒ½ã€‚</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155309.png" alt=""></p><ul><li>web è¯·æ±‚ï¼Œé€šè¿‡ä¸€äº›åŒ¹é…æ¡ä»¶ï¼Œå®šä½åˆ°çœŸæ­£çš„æœåŠ¡èŠ‚ç‚¹ã€‚å¹¶åœ¨è¿™ä¸ªè½¬å‘è¿‡ç¨‹çš„å‰åï¼Œè¿›è¡Œä¸€äº›ç²¾ç»†åŒ–æ§åˆ¶ã€‚</li><li>predicate å°±æ˜¯æˆ‘ä»¬çš„åŒ¹é…æ¡ä»¶ï¼Œè€Œfilterï¼Œå°±å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„æ‹¦æˆªå™¨ã€‚æœ‰äº†è¿™ä¸¤ä¸ªå…ƒç´ å†åŠ ä¸Šç›®æ ‡uriï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå…·ä½“çš„è·¯ç”±ã€‚</li></ul><h5 id="_2-gatewayå·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-gatewayå·¥ä½œæµç¨‹" aria-hidden="true">#</a> 2. gatewayå·¥ä½œæµç¨‹</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155317.png" alt=""></p><ul><li><p>å®¢æˆ·ç«¯å‘Spring Cloud Gatewayå‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨Gateway Handler Mappingä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ°Gateway Web Handlerã€‚</p></li><li><p>Handlerå†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥è®²è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚</p></li><li><p>è¿‡æ»¤å™¨ä¹‹é—´ç”¨è™šçº¿åˆ†å¼€æ˜¯å› ä¸ºè¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨å‘é€ä»£ç†è¯·æ±‚ä¹‹å‰ï¼ˆâ€œpreâ€ï¼‰æˆ–ä¹‹åï¼ˆâ€œpostâ€ï¼‰æ‰§è¡Œä¸šåŠ¡é€»è¾‘</p></li><li><p>Filter åœ¨ â€œpreâ€ ç±»å‹çš„è¿‡æ»¤å™¨å¯ä»¥åšå‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡ç›‘æ§ã€æ—¥å¿—è¾“å‡ºã€åè®®è½¬æ¢ç­‰ï¼›åœ¨ â€œpostâ€ ç±»å‹çš„è¿‡æ»¤å™¨ä¸­å¯ä»¥åšå“åº”å†…å®¹ã€å“åº”å¤´çš„ä¿®æ”¹ï¼Œæ—¥å¿—çš„è¾“å‡ºï¼Œæµé‡ç›‘æ§ç­‰ï¼Œæœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨</p></li></ul><p>æ ¸å¿ƒé€»è¾‘ ï¼šè·¯ç”±è½¬å‘ + æ‰§è¡Œè¿‡æ»¤å™¨é“¾</p><h3 id="_3-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_3-ç¼–ç " aria-hidden="true">#</a> 3. ç¼–ç </h3><p>https://blog.csdn.net/qq_41211642/article/details/104874932</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--gateway--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®æ–‡ä»¶</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway
  <span class="token comment"># ç½‘å…³é…ç½®</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">#payment_routh    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œç®€æ˜“é…åˆæœåŠ¡å</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span>         <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>          <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_routh   #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œç®€æ˜“é…åˆæœåŠ¡å</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span>          <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>             <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155328.png" alt=""></p><p>æ•ˆæœ</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155334.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155347.png" alt=""></p><h3 id="_4-gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_4-gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼" aria-hidden="true">#</a> 4. Gatewayç½‘å…³è·¯ç”±æœ‰ä¸¤ç§é…ç½®æ–¹å¼</h3><p>https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#route-metadata-configuration</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155357.png" alt=""></p><h4 id="_1-æ–¹å¼ä¸€" tabindex="-1"><a class="header-anchor" href="#_1-æ–¹å¼ä¸€" aria-hidden="true">#</a> 1. æ–¹å¼ä¸€</h4><p>3ä¸­çš„æ–¹å¼: åœ¨é…ç½®æ–‡ä»¶yml ä¸­é…ç½®</p><h4 id="_2-æ–¹å¼äºŒ" tabindex="-1"><a class="header-anchor" href="#_2-æ–¹å¼äºŒ" aria-hidden="true">#</a> 2. æ–¹å¼äºŒ</h4><p>ä»£ç ä¸­æ³¨å…¥RouteLocator çš„Bean</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GatewayConfig</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * é€šè¿‡è®¿é—® http://localhost:9527/guonei æ¥è®¿é—® http://news.baidu.com/guonei
     * é€šè¿‡è·¯ç”± ç™¾åº¦ç™¾åº¦ç½‘ç«™
     * http://news.baidu.com/guonei
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RouteLocatorBuilder<span class="token punctuation">.</span>Builder</span> routes <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        routes<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">&quot;path_route_chggx&quot;</span><span class="token punctuation">,</span>
                r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://news.baidu.com/guonei&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•ˆæœ</p><p>http://localhost:9527/guonei</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155409.png" alt=""></p><h3 id="_5-åŠ¨æ€è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_5-åŠ¨æ€è·¯ç”±" aria-hidden="true">#</a> 5. åŠ¨æ€è·¯ç”±</h3><h4 id="_1-ä¸ºä»€ä¹ˆä½¿ç”¨åŠ¨æ€è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_1-ä¸ºä»€ä¹ˆä½¿ç”¨åŠ¨æ€è·¯ç”±" aria-hidden="true">#</a> 1. ä¸ºä»€ä¹ˆä½¿ç”¨åŠ¨æ€è·¯ç”±?</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155426.png" alt=""></p><p>ä¹‹å‰è®¿é—®çš„è·¯ç”±åœ°å€æˆ‘ä»¬æ˜¯å†™æ­»çš„ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¾®æœåŠ¡æä¾›è€…ä¸å¯èƒ½åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œå°±éœ€è¦åŠ¨æ€è·¯ç”±</p><h4 id="_2-ä½¿ç”¨æ€è·¯" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨æ€è·¯" aria-hidden="true">#</a> 2. ä½¿ç”¨æ€è·¯</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155419.png" alt=""></p><ul><li><p>ä¹‹å‰80å®¢æˆ·ç«¯å‘é€è¯·æ±‚è®¿é—®8001/8002ï¼Œé€šè¿‡ribbonè´Ÿè½½å‡è¡¡ï¼Œå°†è¯·æ±‚åˆ†æ•£ï¼Œç°åœ¨æœåŠ¡æä¾›è€…å¦‚æœæ˜¯å¤šå°ï¼Œå°±éœ€è¦å°†ribbonæ›¿æ¢ä¸ºgatewayï¼Œåªæš´éœ²gatewayï¼Œå®¢æˆ·ç«¯è¯·æ±‚ç»Ÿä¸€å‘åˆ°gatewayï¼Œgatewayå°†è¯·æ±‚è½¬å‘ç»™8001/8002ã€‚</p></li><li><p>é»˜è®¤æƒ…å†µä¸‹Gatewayä¼šæ ¹æ®æ³¨å†Œä¸­å¿ƒæ³¨å†Œçš„æœåŠ¡åˆ—è¡¨ï¼Œä»¥æ³¨å†Œä¸­å¿ƒä¸Šå¾®æœåŠ¡åä¸ºè·¯å¾„åˆ›å»ºåŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°åŠ¨æ€è·¯ç”±çš„åŠŸèƒ½ã€‚</p></li><li><p>ç°åœ¨å¯åŠ¨ä¸€ä¸ªeureka7001ï¼Œä¸¤ä¸ªæœåŠ¡æä¾›è€…8001/8002</p></li></ul><h4 id="_3-ç¼–ç -1" tabindex="-1"><a class="header-anchor" href="#_3-ç¼–ç -1" aria-hidden="true">#</a> 3. ç¼–ç </h4><ol><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><ul><li>å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½,åˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±</li><li>ä½¿ç”¨&quot;lb&quot;åŠ¨æ€åŒ¹é…è·¯ç”±åœ°å€</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155440.png" alt=""></p></li></ol><p>è®¿é—® æµ‹è¯•</p><p>http://localhost:9527/payment/get/1</p><p>8001/8002 åˆ‡æ¢è®¿é—®</p><h3 id="_6-predicate" tabindex="-1"><a class="header-anchor" href="#_6-predicate" aria-hidden="true">#</a> 6. Predicate</h3><p>https://blog.csdn.net/qq_41211642/article/details/104879278</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155449.png" alt=""></p><h4 id="_0-æ±‚æ—¶åŒºæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#_0-æ±‚æ—¶åŒºæ—¶é—´" aria-hidden="true">#</a> 0. æ±‚æ—¶åŒºæ—¶é—´</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T2</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// é»˜è®¤æ—¶åŒº</span>
        <span class="token class-name">ZonedDateTime</span> zbj <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2020-04-02T10:32:44.384+08:00[Asia/Shanghai]</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zbj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç”¨äºåˆ¶å®šæ—¶åŒºè·å–å½“å‰æ—¶é—´</span>
<span class="token comment">//        ZonedDateTime zny = ZonedDateTime.now(ZoneId.of(&quot;America/New_york&quot;));</span>
<span class="token comment">//        System.out.println(zny);</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-after-æ—¶é—´ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1-after-æ—¶é—´ç±»å‹" aria-hidden="true">#</a> 1. After <sup>æ—¶é—´ç±»å‹</sup></h4><p>https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gateway-request-predicates-factories</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155457.png" alt=""></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway
  <span class="token comment"># ç½‘å…³é…ç½®</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">locator</span><span class="token punctuation">:</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½,åˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±(é»˜è®¤false)</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">#payment_routh    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œç®€æ˜“é…åˆæœåŠ¡å</span>
          <span class="token comment">#          uri: http://localhost:8001         #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service     <span class="token comment"># åŒ¹é…ååŠ¨æ€æä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>          <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_routh   #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œç®€æ˜“é…åˆæœåŠ¡å</span>
            <span class="token comment">#          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service   <span class="token comment"># åŒ¹é…ååŠ¨æ€æä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>             <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token punctuation">-</span> After=2020<span class="token punctuation">-</span>04<span class="token punctuation">-</span>02T10<span class="token punctuation">:</span>32<span class="token punctuation">:</span>44.384+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è°ƒèŠ‚æ—¶é—´,åªæœ‰å½“å‰æ—¶é—´åœ¨&quot;è®¾ç½®æ—¶é—´ä¹‹å&quot;æ‰èƒ½æ­£å¸¸è®¿é—®</li></ul><h4 id="_2-before-æ—¶é—´ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_2-before-æ—¶é—´ç±»å‹" aria-hidden="true">#</a> 2. Before <sup>æ—¶é—´ç±»å‹</sup></h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155509.png" alt=""></p><ul><li>è°ƒèŠ‚æ—¶é—´,åªæœ‰å½“å‰æ—¶é—´åœ¨&quot;è®¾ç½®æ—¶é—´ä¹‹å‰&quot;æ‰èƒ½æ­£å¸¸è®¿é—®</li></ul><h4 id="_3-between-æ—¶é—´ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-between-æ—¶é—´ç±»å‹" aria-hidden="true">#</a> 3. Between <sup>æ—¶é—´ç±»å‹</sup></h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155516.png" alt=""></p><ul><li>è°ƒèŠ‚æ—¶é—´,åªæœ‰å½“å‰æ—¶é—´åœ¨&quot;è®¾ç½®æ—¶é—´ä¹‹å†…&quot;æ‰èƒ½æ­£å¸¸è®¿é—®</li></ul><h4 id="_4-cookie" tabindex="-1"><a class="header-anchor" href="#_4-cookie" aria-hidden="true">#</a> 4. Cookie</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155527.png" alt=""></p><p>Cookie Route Predicate: éœ€è¦ä¸¤ä¸ªå‚æ•°, ==(Cookie Name,æ­£åˆ™è¡¨è¾¾å¼)==</p><p>è·¯ç”±è§„åˆ™ä¼šé€šè¿‡è·å–å¯¹åº”çš„Cookie Nameå€¼å’Œæ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…,å¦‚æœåŒ¹é…ä¸Šå°±ä¼šæ‰§è¡Œè·¯ç”±,å¦‚æœæ²¡æœ‰åŒ¹é…ä¸Šåˆ™ä¸æ‰§è¡Œ</p><h5 id="_1-ymlé…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-ymlé…ç½®" aria-hidden="true">#</a> 1. ymlé…ç½®</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">predicates</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>             <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
  <span class="token punctuation">-</span> After=2020<span class="token punctuation">-</span>04<span class="token punctuation">-</span>02T10<span class="token punctuation">:</span>32<span class="token punctuation">:</span>44.384+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>
  <span class="token punctuation">-</span> Cookie=username<span class="token punctuation">,</span>hp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-ä¸å¸¦cookie-curlæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-ä¸å¸¦cookie-curlæµ‹è¯•" aria-hidden="true">#</a> 2. ä¸å¸¦cookie ==curlæµ‹è¯•==</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>curl http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>9527/payment/lb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155533.png" alt=""></p><h5 id="_3-å¸¦cookie" tabindex="-1"><a class="header-anchor" href="#_3-å¸¦cookie" aria-hidden="true">#</a> 3. å¸¦cookie</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>curl http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>9527/payment/lb <span class="token punctuation">-</span><span class="token punctuation">-</span>cookie &quot;username=hp&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155546.png" alt=""></p><h4 id="_5-header" tabindex="-1"><a class="header-anchor" href="#_5-header" aria-hidden="true">#</a> 5. Header</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155549.png" alt=""></p><p>ä¸¤ä¸ªå‚æ•°: ==(å±æ€§å,æ­£åˆ™è¡¨è¾¾å¼)== è¿™ä¸ªå±æ€§å’Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ™æ‰§è¡Œ</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>             <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token punctuation">-</span> After=2020<span class="token punctuation">-</span>04<span class="token punctuation">-</span>02T10<span class="token punctuation">:</span>32<span class="token punctuation">:</span>44.384+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>
<span class="token comment">#            - Cookie=username,hp</span>
            <span class="token punctuation">-</span> Header=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>Id<span class="token punctuation">,</span> \d+ <span class="token comment"># è¯·æ±‚å¤´è¦æœ‰&quot;X-Request-Id&quot;å±æ€§,å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_1-æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_1-æµ‹è¯•" aria-hidden="true">#</a> 1. æµ‹è¯•</h5><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">curl http://localhost:9527/payment/lb -H &quot;X-Request-Id</span><span class="token punctuation">:</span> 1234&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155554.png" alt=""></p><ul><li>è´Ÿæ•°æŠ¥é”™.</li></ul><h4 id="_6-host" tabindex="-1"><a class="header-anchor" href="#_6-host" aria-hidden="true">#</a> 6. Host</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155606.png" alt=""></p><h4 id="_7-method" tabindex="-1"><a class="header-anchor" href="#_7-method" aria-hidden="true">#</a> 7. Method</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155613.png" alt=""></p><h4 id="_8-path" tabindex="-1"><a class="header-anchor" href="#_8-path" aria-hidden="true">#</a> 8. Path</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155624.png" alt=""></p><h4 id="_9-query" tabindex="-1"><a class="header-anchor" href="#_9-query" aria-hidden="true">#</a> 9. Query</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155630.png" alt=""></p><h4 id="_10-remoteaddr" tabindex="-1"><a class="header-anchor" href="#_10-remoteaddr" aria-hidden="true">#</a> 10. RemoteAddr</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155644.png" alt=""></p><h4 id="_11-weight" tabindex="-1"><a class="header-anchor" href="#_11-weight" aria-hidden="true">#</a> 11. Weight</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155654.png" alt=""></p><h3 id="_7-filter" tabindex="-1"><a class="header-anchor" href="#_7-filter" aria-hidden="true">#</a> 7. Filter</h3><p><a href="https://blog.csdn.net/qq_41211642/article/details/104881451" target="_blank" rel="noopener noreferrer">å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li><p>è·¯ç”±è¿‡æ»¤å™¨å¯ç”¨äºä¿®æ”¹è¿›å…¥çš„HTTPè¯·æ±‚å’Œè¿”å›çš„HTTPå“åº”ï¼Œè·¯ç”±è¿‡æ»¤å™¨åªèƒ½æŒ‡å®šè·¯ç”±è¿›è¡Œä½¿ç”¨</p></li><li><p>SpringCloud Gatewayå†…ç½®äº†å¤šç§è·¯ç”±è¿‡æ»¤å™¨ï¼Œä»–ä»¬éƒ½ç”±GatewayFilterçš„å·¥å‚ç±»æ¥ç”Ÿæˆ</p></li><li><p>SpringCloud Gatewayçš„ Filterï¼Œç”Ÿå‘½å‘¨æœŸæœ‰ pro å’Œ postï¼Œ ç§ç±»æœ‰GatewayFilter å’Œ GlobalFilter</p></li><li><p>å¸¸ç”¨çš„GatewayFilter æœ‰31ç§ä¹‹å¤š.GlobalFilter æœ‰10ä¸ª.<a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gatewayfilter-factories" target="_blank" rel="noopener noreferrer">å®˜ç½‘å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><p>è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹==<strong>è‡ªå®šä¹‰å…¨å±€GlobalFilter</strong>==</p><h4 id="_1-è‡ªå®šä¹‰æ¥å£" tabindex="-1"><a class="header-anchor" href="#_1-è‡ªå®šä¹‰æ¥å£" aria-hidden="true">#</a> 1. è‡ªå®šä¹‰æ¥å£</h4><h5 id="_1-ä¸»è¦æ¥å£" tabindex="-1"><a class="header-anchor" href="#_1-ä¸»è¦æ¥å£" aria-hidden="true">#</a> 1. ä¸»è¦æ¥å£</h5><p><strong>==GlobalFilter,Ordered==</strong></p><h5 id="_2-èƒ½å¹²å•¥" tabindex="-1"><a class="header-anchor" href="#_2-èƒ½å¹²å•¥" aria-hidden="true">#</a> 2. èƒ½å¹²å•¥?</h5><ul><li>å…¨å±€æ—¥å¿—è®°å½•</li><li>ç»Ÿä¸€ç½‘å…³é‰´æƒ</li><li>......</li></ul><h5 id="_3-ç¼–ç -2" tabindex="-1"><a class="header-anchor" href="#_3-ç¼–ç -2" aria-hidden="true">#</a> 3. ç¼–ç </h5><ul><li>é…ç½®</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_routh   #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œç®€æ˜“é…åˆæœåŠ¡å</span>
            <span class="token comment">#          uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service   <span class="token comment"># åŒ¹é…ååŠ¨æ€æä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> AddRequestParameter=X<span class="token punctuation">-</span>Requesr<span class="token punctuation">-</span>Id<span class="token punctuation">,</span><span class="token number">1024</span> <span class="token comment"># è¿‡æ»¤å™¨å·¥å‚,ä¼šåœ¨åŒ¹é…çš„è¯·æ±‚å¤´,åŠ ä¸Šä¸€å¯¹è¯·æ±‚å¤´,åç§°ä¸ºX-Request-Idå€¼ä¸º1024</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>             <span class="token comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token punctuation">-</span> After=2020<span class="token punctuation">-</span>04<span class="token punctuation">-</span>02T10<span class="token punctuation">:</span>32<span class="token punctuation">:</span>44.384+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>
<span class="token comment">#            - Cookie=username,hp</span>
            <span class="token punctuation">-</span> Header=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>Id<span class="token punctuation">,</span> \d+ <span class="token comment"># è¯·æ±‚å¤´è¦æœ‰&quot;X-Request-Id&quot;å±æ€§,å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä»£ç </li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLogGatewayFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;******come in MyLogGatewayFilter: &quot;</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å‚æ•°</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;******ç”¨æˆ·åä¸ºnull,éæ³•ç”¨æˆ·,o(â•¥ï¹â•¥)o&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ä¸è¢«æ¥å—</span>
            exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStatusCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">NOT_ACCEPTABLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * åŠ è½½è¿‡æ»¤å™¨çš„é¡ºåº
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•:</p><p>ä¸å¸¦å‚æ•°</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155706.png" alt=""></p><p>å¸¦å‚æ•°</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155714.png" alt=""></p><hr><h2 id="_8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 8åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ ğŸ˜„</h2><h3 id="_1-config-1" tabindex="-1"><a class="header-anchor" href="#_1-config-1" aria-hidden="true">#</a> 1. config</h3><h4 id="_1-æ¦‚è¿°-6" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-6" aria-hidden="true">#</a> 1. æ¦‚è¿°</h4><h5 id="_1-åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜â€”â€”é…ç½®é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜â€”â€”é…ç½®é—®é¢˜" aria-hidden="true">#</a> 1. åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜â€”â€”é…ç½®é—®é¢˜</h5><p>å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ã€‚ç”±äºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦æœ‰é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€å¥—é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚SpringCloudæä¾›äº†ConfigServeræ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><a href="https://www.springcloud.cc/spring-cloud-config.html" target="_blank" rel="noopener noreferrer">å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155721.png" alt=""></p><p>SpringCloud Configä¸ºå¾®æœåŠ¡æ¶æ„ä¸­çš„å¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒï¼Œé…ç½®æœåŠ¡å™¨ä¸º==å„ä¸ªä¸åŒå¾®æœåŠ¡åº”ç”¨==çš„æ‰€æœ‰ç¯å¢ƒæä¾›äº†ä¸€ä¸ª==ä¸­å¿ƒåŒ–çš„å¤–éƒ¨é…ç½®==ã€‚</p><ul><li>å®ç°ä¸€å¤„ä¿®æ”¹,å¤„å¤„ä½¿ç”¨</li></ul><h5 id="_2-æ€ä¹ˆç©" tabindex="-1"><a class="header-anchor" href="#_2-æ€ä¹ˆç©" aria-hidden="true">#</a> 2. æ€ä¹ˆç©?</h5><p>SpringCloud Configåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†</p><p>æœåŠ¡ç«¯ä¹Ÿç§°ä¸ºåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¾®æœåŠ¡åº”ç”¨ï¼Œç”¨æ¥è¿æ¥é…ç½®æœåŠ¡å™¨å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯ï¼ŒåŠ å¯†/è§£å¯†ä¿¡æ¯ç­‰è®¿é—®æ¥å£</p><p>å®¢æˆ·ç«¯åˆ™æ˜¯é€šè¿‡æŒ‡å®šçš„é…ç½®ä¸­å¿ƒæ¥ç®¡ç†åº”ç”¨èµ„æºï¼Œä»¥åŠä¸ä¸šåŠ¡ç›¸å…³çš„é…ç½®å†…å®¹ï¼Œå¹¶åœ¨å¯åŠ¨çš„æ—¶å€™ä»é…ç½®ä¸­å¿ƒè·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯ï¼Œé…ç½®æœåŠ¡å™¨é»˜è®¤é‡‡ç”¨gitæ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œè¿™æ ·å°±æœ‰åŠ©äºå¯¹ç¯å¢ƒé…ç½®è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡gitå®¢æˆ·ç«¯å·¥å…·æ¥æ–¹ä¾¿çš„ç®¡ç†å’Œè®¿é—®é…ç½®å†…å®¹ã€‚</p><h5 id="_3-èƒ½å¹²å˜›" tabindex="-1"><a class="header-anchor" href="#_3-èƒ½å¹²å˜›" aria-hidden="true">#</a> 3. èƒ½å¹²å˜›ï¼Ÿ</h5><ul><li>é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶</li><li>ä¸åŒç¯å¢ƒä¸åŒé…ç½®ï¼ŒåŠ¨æ€åŒ–çš„é…ç½®æ›´æ–°ï¼Œåˆ†ç¯å¢ƒéƒ¨ç½²,æ¯”å¦‚:dev/test/prod/beta/release</li><li>è¿è¡ŒæœŸé—´åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œä¸å†éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡éƒ¨ç½²çš„æœºå™¨ä¸Šç¼–å†™é…ç½®æ–‡ä»¶ï¼ŒæœåŠ¡ä¼šå‘é…ç½®ä¸­å¿ƒç»Ÿä¸€æ‹‰å–é…ç½®è‡ªå·±çš„ä¿¡æ¯</li><li>å½“é…ç½®å‘ç”Ÿå˜åŠ¨æ—¶ï¼ŒæœåŠ¡ä¸éœ€è¦é‡å¯å³å¯æ„ŸçŸ¥åˆ°é…ç½®çš„å˜åŒ–å¹¶åº”ç”¨æ–°çš„é…ç½®</li><li>å°†é…ç½®ä¿¡æ¯ä»¥RESTæ¥å£çš„å½¢å¼æš´éœ²ï¼Œpost/curlè®¿é—®åˆ·æ–°å³å¯</li></ul><h4 id="_2-config-serverä¸clienté…ç½®ä¸æµ‹è¯•åŠåŠ¨æ€åˆ·æ–°" tabindex="-1"><a class="header-anchor" href="#_2-config-serverä¸clienté…ç½®ä¸æµ‹è¯•åŠåŠ¨æ€åˆ·æ–°" aria-hidden="true">#</a> 2. Config serverä¸clienté…ç½®ä¸æµ‹è¯•åŠåŠ¨æ€åˆ·æ–°</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155734.png" alt=""></p><p>gitå‘½ä»¤</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code>git add .

git commit -m â€œå†…å®¹â€

git  push origin master
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>configæœåŠ¡ç«¯é€šè¿‡gitåœ°å€è®¿é—®githubä¸Šçš„æ–‡ä»¶</p><p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¸Šä¼ åˆ°githubï¼Œæ¨¡æ‹Ÿè¿ç»´äººå‘˜è¿›è¡Œæ“ä½œï¼Œå®ç°è¿œç¨‹ä¸æœ¬åœ°çš„æ•´ä½“ä¸€è‡´æ€§ã€‚ æˆ‘çš„ä¾‹å­æ˜¯å»ºä¸€ä¸ªcloud-configä»“åº“ï¼ŒåŒ…å«ä¸‰ä¸ªymlæ–‡ä»¶ï¼Œä¸‹é¢ä¼šè¯»å–æ–‡ç« æ–‡ä»¶ä¸­çš„ä¿¡æ¯</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155737.png" alt=""></p><h5 id="_1-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_1-ç¼–ç " aria-hidden="true">#</a> 1. ç¼–ç </h5><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-config-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®æ–‡ä»¶</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3344</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>config<span class="token punctuation">-</span>center
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">server</span><span class="token punctuation">:</span>
        <span class="token key atrule">git</span><span class="token punctuation">:</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>ABirdFree/springcloud<span class="token punctuation">-</span>config.git <span class="token comment">#githubä»“åº“ä¸Šé¢çš„gitä»“åº“åå­—</span>
          <span class="token comment">##æœç´¢ç›®å½•</span>
          <span class="token key atrule">search-paths</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> cloud<span class="token punctuation">-</span>config
      <span class="token comment">#è¯»å–åˆ†æ”¯</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka <span class="token comment">#æ³¨å†Œè¿›eureka</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯åŠ¨ç±»</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableConfigServer</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigCenterMain3344</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConfigCenterMain3344</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¿®æ”¹hostæ–‡ä»¶</li></ul><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">127.0.0.1</span> <span class="token value attr-value">config-3344.com</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¿é—®: http://config-3344.com:3344/master/config-dev.yml</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155744.png" alt=""></p><h5 id="_2-é…ç½®è¯»å–è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_2-é…ç½®è¯»å–è§„åˆ™" aria-hidden="true">#</a> 2.é…ç½®è¯»å–è§„åˆ™</h5><h6 id="_1-æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_1-æ–¹å¼" aria-hidden="true">#</a> 1.æ–¹å¼</h6><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>/<span class="token punctuation">{</span>application<span class="token punctuation">}</span>/<span class="token punctuation">{</span>profile<span class="token punctuation">}</span><span class="token punctuation">[</span>/<span class="token punctuation">{</span>label<span class="token punctuation">}</span><span class="token punctuation">]</span>
/<span class="token punctuation">{</span>application<span class="token punctuation">}</span><span class="token punctuation">-</span><span class="token punctuation">{</span>profile<span class="token punctuation">}</span>.yml
/<span class="token punctuation">{</span>label<span class="token punctuation">}</span>/<span class="token punctuation">{</span>application<span class="token punctuation">}</span><span class="token punctuation">-</span><span class="token punctuation">{</span>profile<span class="token punctuation">}</span>.yml
/<span class="token punctuation">{</span>application<span class="token punctuation">}</span><span class="token punctuation">-</span><span class="token punctuation">{</span>profile<span class="token punctuation">}</span>.properties
/<span class="token punctuation">{</span>label<span class="token punctuation">}</span>/<span class="token punctuation">{</span>application<span class="token punctuation">}</span><span class="token punctuation">-</span><span class="token punctuation">{</span>profile<span class="token punctuation">}</span>.properties
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-label-application-profile-yml-æ¨è" tabindex="-1"><a class="header-anchor" href="#_2-label-application-profile-yml-æ¨è" aria-hidden="true">#</a> 2. /{label}/{application}-{profile}.yml <sup>æ¨è</sup></h6><p><strong>masteråˆ†æ”¯</strong></p><p>http://config-3344.com:3344/master/config-dev.yml</p><p>http://config-3344.com:3344/master/config-prod.yml</p><p><strong>devåˆ†æ”¯</strong></p><p>http://config-3344.com:3344/dev/config-dev.yml</p><p>http://config-3344.com:3344/dev/config-prod.yml</p><h6 id="_3-application-profile-yml" tabindex="-1"><a class="header-anchor" href="#_3-application-profile-yml" aria-hidden="true">#</a> 3. /{application}-{profile}.yml</h6><p>http://config-3344.com:3344/config-dev.yml</p><p>http://config-3344.com:3344/config-prod.yml</p><h5 id="_3-å®¢æˆ·ç«¯é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-å®¢æˆ·ç«¯é…ç½®" aria-hidden="true">#</a> 3. å®¢æˆ·ç«¯é…ç½®</h5><p>å®¢æˆ·ç«¯ä¸ç›´æ¥è®¿é—®githubï¼Œè€Œæ˜¯é€šè¿‡æœåŠ¡ç«¯è®¿é—®ã€‚</p><ul><li>ä¾èµ–</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®æ–‡ä»¶ bootstrap.yml</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155750.png" alt=""></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#Configå®¢æˆ·ç«¯é…ç½®</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment"># åˆ†æ”¯åç§°</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> config <span class="token comment"># é…ç½®æ–‡ä»¶åç§°</span>
      <span class="token key atrule">profile</span><span class="token punctuation">:</span> dev <span class="token comment"># è¯»å–åç¼€åç§° ä¸Šè¿°3ä¸ªç»¼åˆï¼šmasteråˆ†æ”¯ä¸Šconfig-dev.ymlçš„é…ç½®æ–‡ä»¶è¢«è¯»å– http://config-3344.com:3344/master/config-dev.yml</span>
      <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment"># é…ç½®ä¸­å¿ƒåœ°å€ è¡¨ç¤ºé€šè¿‡è¿™ä¸ªæœåŠ¡ç«¯è®¿é—®</span>


<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001.com/eureka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯åŠ¨ç±»</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientMain3355</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConfigClientMain3355</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>controller 3344ä»¥resté£æ ¼æš´éœ²æ¥å£</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token comment">//@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è¦è®¿é—®çš„3344ä¸Šçš„ä¿¡æ¯
     *  config:
     *   info: &quot;master branch,springcloud-config-test.yml version=1&quot;
     */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${config.info}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/configInfo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ•ˆæœ</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155801.png" alt=""></p><h5 id="_4-åˆ†å¸ƒå¼-åŠ¨æ€åˆ·æ–°é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_4-åˆ†å¸ƒå¼-åŠ¨æ€åˆ·æ–°é—®é¢˜" aria-hidden="true">#</a> 4. åˆ†å¸ƒå¼==åŠ¨æ€åˆ·æ–°é—®é¢˜==</h5><h6 id="_1-é—®é¢˜-2" tabindex="-1"><a class="header-anchor" href="#_1-é—®é¢˜-2" aria-hidden="true">#</a> 1. é—®é¢˜</h6><ul><li>linuxè¿ç»´ä¿®æ”¹GitHubä¸Šçš„é…ç½®æ–‡ä»¶å†…å®¹åšè°ƒæ•´</li><li>åˆ·æ–°3344,å‘ç°ConfigServeré…ç½®ä¸­å¿ƒç«‹å³å“åº”</li><li>åˆ·æ–°3355,å‘ç°ConfigClientå®¢æˆ·ç«¯æ²¡æœ‰ä»»ä½•å“åº”</li><li>3355æ²¡æœ‰å˜åŒ–,é™¤éè‡ªå·±é‡å¯æˆ–è€…é‡æ–°åŠ è½½</li><li>å®¢æˆ·ç«¯,æ¯æ¬¡éœ€è¦é‡å¯.......</li></ul><h6 id="_2-è§£å†³-2" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³-2" aria-hidden="true">#</a> 2.è§£å†³</h6><ul><li>ä¾èµ–</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>// ç›‘æ§: é™¤äº†ç½‘å…³æ²¡,å…¶ä½™éƒ½è¦åŠ 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æš´éœ²ç›‘æ§ç«¯ç‚¹</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#æ·»åŠ é…ç½®ï¼Œæš´éœ²ç›‘æ§ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ·»åŠ æ³¨è§£(åœ¨ä¸šåŠ¡ä¸Š) @RefreshScope</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è¦è®¿é—®çš„3344ä¸Šçš„ä¿¡æ¯
     *  config:
     *   info: &quot;master branch,springcloud-config-test.yml version=1&quot;
     */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${config.info}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/configInfo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>==éœ€è¦è¿ç»´äººå‘˜å‘é€POSTè¯·æ±‚,åˆ·æ–°3355==</p><ol><li><p>å¿…ä¿®ä¸º ==&quot;POST&quot;== è¯·æ±‚</p></li><li><p>cmd è¿›å…¥æ§åˆ¶å° curl -X POST &quot;http://localhost:3355/actuator/refresh&quot; ==æ¿€æ´»3355,åˆ·æ–°æ•°æ®===</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155812.png" alt=""></p></li></ol></li><li><p>æ•ˆæœ</p></li><li><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155817.png" alt=""></p></li></ul><ol><li>æœåŠ¡ç«¯ http://config-3344.com:3344/master/config-dev.yml</li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155826.png" alt=""></p><ol start="2"><li>å®¢æˆ·ç«¯ http://localhost:3355/configInfo</li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155833.png" alt=""></p><p>==é¿å…äº†æœåŠ¡é‡å¯==</p><p>å‡è®¾æœ‰å¤šä¸ªå¾®æœåŠ¡å®¢æˆ·ç«¯3355/3366/3377ã€‚ã€‚ã€‚æ¯ä¸ªå¾®æœåŠ¡éƒ½éœ€è¦æ‰§è¡Œä¸€æ¬¡postè¯·æ±‚ï¼Œå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œæ‰¹é‡æ‰§è¡Œã€‚ä½†æ˜¯è¿˜æœ‰æ²¡æœ‰æ›´ä¼˜åŒ–çš„æ–¹æ³•ï¼Ÿ</p><p>æˆ‘ä»¬æƒ³å¤§èŒƒå›´çš„è‡ªåŠ¨åˆ·æ–°ï¼Œå¯å¦å¹¿æ’­ï¼Ÿä¸€æ¬¡é€šçŸ¥ï¼Œå¤„å¤„ç”Ÿæ•ˆï¼Ÿ æ‰€ä»¥å¼•å…¥äº†==<strong>SpringCloud Bus</strong>æ¶ˆæ¯æ€»çº¿==ï¼Œ</p><hr><h2 id="_9-springcloud-busæ¶ˆæ¯æ€»çº¿" tabindex="-1"><a class="header-anchor" href="#_9-springcloud-busæ¶ˆæ¯æ€»çº¿" aria-hidden="true">#</a> 9. <strong>SpringCloud Bus</strong>æ¶ˆæ¯æ€»çº¿ ğŸ˜„</h2><h3 id="_1-æ¦‚è¿°-7" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-7" aria-hidden="true">#</a> 1.æ¦‚è¿°</h3><h4 id="_1-è§£å†³é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-è§£å†³é—®é¢˜" aria-hidden="true">#</a> 1 .è§£å†³é—®é¢˜</h4><ul><li>==å®ç°åˆ†å¸ƒå¼è‡ªåŠ¨åˆ·æ–°é…ç½®åŠŸèƒ½==</li><li><strong>SpringCloud Bus</strong> é…åˆ <strong>SpringCloud Config</strong> ä½¿ç”¨,å¯ä»¥å®ç°==é…ç½®çš„åŠ¨æ€è§£æ==</li></ul><h4 id="_2-æ˜¯ä»€ä¹ˆ-èƒ½å¹²å˜›" tabindex="-1"><a class="header-anchor" href="#_2-æ˜¯ä»€ä¹ˆ-èƒ½å¹²å˜›" aria-hidden="true">#</a> 2. æ˜¯ä»€ä¹ˆ? èƒ½å¹²å˜›?</h4><p>Bus: æ”¯æŒä¸¤ç§æ¶ˆæ¯ä»£ç†: RabbitMQå’ŒKafka</p><h5 id="_1-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯-bus-refresh-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯-bus-refresh-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®" aria-hidden="true">#</a> 1. åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯/bus/refreshï¼Œè€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155847.png" alt=""></p><ul><li>é€šçŸ¥ä¸€ä¸ª==å®¢æˆ·ç«¯==</li></ul><h5 id="_2-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯configserverçš„-bus-refreshç«¯ç‚¹-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯configserverçš„-bus-refreshç«¯ç‚¹-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®" aria-hidden="true">#</a> 2. åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯ConfigServerçš„/bus/refreshç«¯ç‚¹ï¼Œè€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155854.png" alt=""></p><ul><li>å…¨éƒ¨æ‹‰å–,==å…¨éƒ¨é€šçŸ¥==</li></ul><p>SpringCloud Bus èƒ½ç®¡ç†å’Œä¼ æ’­åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„æ¶ˆæ¯,å°±åƒä¸€ä¸ªåˆ†å¸ƒå¼æ‰§è¡Œå™¨</p><p>,å¯ç”¨äºå¹¿æ’­çŠ¶æ€æ›´æ”¹.æ—¶é—´æ¨é€ç­‰,ä¹Ÿå¯ä»¥å½“åšå¾®æœåŠ¡é—´çš„é€šä¿¡é€šé“</p><h4 id="_3-ä»€ä¹ˆæ˜¯æ€»çº¿" tabindex="-1"><a class="header-anchor" href="#_3-ä»€ä¹ˆæ˜¯æ€»çº¿" aria-hidden="true">#</a> 3. ä»€ä¹ˆæ˜¯æ€»çº¿ï¼Ÿ</h4><p>åœ¨å¾®æœåŠ¡æ¶æ„çš„ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†æ¥æ„å»ºä¸€ä¸ªå…±ç”¨çš„æ¶ˆæ¯ä¸»é¢˜ï¼Œå¹¶è®©ç³»ç»Ÿä¸­æ‰€æœ‰å¾®æœåŠ¡å®ä¾‹éƒ½è¿æ¥ä¸Šæ¥ã€‚ç”±äº<strong>è¯¥ä¸»é¢˜ä¸­äº§ç”Ÿçš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰å®ä¾‹ç›‘å¬å’Œæ¶ˆè´¹ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºæ¶ˆæ¯æ€»çº¿</strong>ã€‚åœ¨æ€»çº¿ä¸Šçš„å„ä¸ªå®ä¾‹ï¼Œéƒ½å¯ä»¥æ–¹ä¾¿çš„å¹¿æ’­ä¸€äº›éœ€è¦è®©å…¶ä»–è¿æ¥åœ¨è¯¥ä¸»é¢˜ä¸Šçš„å®ä¾‹éƒ½çŸ¥é“çš„æ¶ˆæ¯ã€‚</p><h4 id="_4-åŸºæœ¬åŸç†" tabindex="-1"><a class="header-anchor" href="#_4-åŸºæœ¬åŸç†" aria-hidden="true">#</a> 4. åŸºæœ¬åŸç†</h4><p>ConfigClient å®ä¾‹éƒ½ç›‘å¬MQä¸­åŒä¸€ä¸ªtopicï¼ˆé»˜è®¤æ˜¯springcloubusï¼‰ï¼Œå½“ä¸€ä¸ªæœåŠ¡åˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè¿™ä¸ªä¿¡æ¯æ”¾å…¥åˆ°Topicä¸­ï¼Œè¿™æ ·å…¶ä»–ç›‘å¬ç»Ÿä¸€topicçš„æœåŠ¡å°±èƒ½å¾—åˆ°é€šçŸ¥ï¼Œç„¶åå»æ›´æ–°è‡ªèº«çš„é…ç½®ã€‚</p><h3 id="_2-rabbitmqé…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-rabbitmqé…ç½®" aria-hidden="true">#</a> 2. RabbitMQé…ç½®</h3><p>åŸºäºerlangè¯­è¨€</p><h3 id="_3-springcloud-bus-åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" tabindex="-1"><a class="header-anchor" href="#_3-springcloud-bus-åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" aria-hidden="true">#</a> 3. SpringCloud Bus==åŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­==</h3><ul><li>å…ˆå…·å¤‡è‰¯å¥½çš„ RabbitMQ ç¯å¢ƒ</li></ul><h4 id="_1-é…ç½®-1" tabindex="-1"><a class="header-anchor" href="#_1-é…ç½®-1" aria-hidden="true">#</a> 1. é…ç½®</h4><ul><li>ä¾èµ–(æœåŠ¡ç«¯.å®¢æˆ·ç«¯)</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--æ·»åŠ æ¶ˆæ¯æ€»çº¿RbbitMQæ”¯æŒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bus-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æœåŠ¡ç«¯3344é…ç½®</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token comment">#rabbitç›¸å…³é…ç½®</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 116.196.118.167
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest

<span class="token comment">#rabbitmqç›¸å…³é…ç½®ï¼Œæš´éœ²busåˆ·æ–°é…ç½®çš„ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>  <span class="token comment">#æš´éœ²busåˆ·æ–°é…ç½®çš„ç«¯ç‚¹</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;bus-refresh&#39;</span>  <span class="token comment">#å‡¡æ˜¯æš´éœ²ç›‘æ§ã€åˆ·æ–°çš„éƒ½è¦æœ‰actuatorä¾èµ–ï¼Œbus-refreshå°±æ˜¯actuatorçš„åˆ·æ–°æ“ä½œ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å®¢æˆ·ç«¯ 3355,3366</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token comment">#rabbitç›¸å…³é…ç½®</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 116.196.118.167
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>==éœ€è¦è¿ç»´äººå‘˜å‘é€POSTè¯·æ±‚,åˆ·æ–°3344æœåŠ¡ç«¯==</p><ol><li><p>å¿…ä¿®ä¸º ==&quot;POST&quot;== è¯·æ±‚</p></li><li><p>cmd è¿›å…¥æ§åˆ¶å° curl -X POST &quot;http://localhost:3344/actuator/bus-refresh&quot; ==æ¿€æ´»3344,åˆ·æ–°æ•°æ®,ä¸€æ¬¡åˆ·æ–°,å¤„å¤„ç”Ÿæ•ˆ==</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155901.png" alt=""></p></li></ol></li><li><p>æ•ˆæœ</p></li><li><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155905.png" alt=""></p></li></ul><ol><li>æœåŠ¡ç«¯: http://config-3344.com:3344/master/config-dev.yml</li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155910.png" alt=""></p><ol start="2"><li>å®¢æˆ·ç«¯1: http://localhost:3355/configInfo</li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155917.png" alt=""></p><ol start="3"><li>å®¢æˆ·ç«¯2: http://localhost:3366/configInfo</li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155921.png" alt=""></p><p>==é¿å…äº†æœåŠ¡é‡å¯==</p><ul><li>eureka</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155928.png" alt=""></p><ul><li>rabbitMQ</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155935.png" alt=""><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155942.png" alt=""></p><p>==ä¸€å¤„ä¿®æ”¹,å¤„å¤„ç”Ÿæ•ˆ===</p><h4 id="_2-è®¾è®¡æ€æƒ³" tabindex="-1"><a class="header-anchor" href="#_2-è®¾è®¡æ€æƒ³" aria-hidden="true">#</a> 2. è®¾è®¡æ€æƒ³</h4><h5 id="_1-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯-bus-refresh-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®-1" tabindex="-1"><a class="header-anchor" href="#_1-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯-bus-refresh-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®-1" aria-hidden="true">#</a> 1. åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯/bus/refreshï¼Œè€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223155955.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160001.png" alt=""></p><h5 id="_2-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯configserverçš„-bus-refreshç«¯ç‚¹-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®-1" tabindex="-1"><a class="header-anchor" href="#_2-åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯configserverçš„-bus-refreshç«¯ç‚¹-è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®-1" aria-hidden="true">#</a> 2. åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯ConfigServerçš„/bus/refreshç«¯ç‚¹ï¼Œè€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160005.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160010.png" alt=""></p><p>å›¾äºŒçš„æ¶æ„æ˜¾ç„¶æ›´åŠ åˆé€‚ï¼Œå›¾ä¸€ä¸åˆé€‚çš„åŸå› å¦‚ä¸‹ï¼š</p><ul><li>æ‰“ç ´äº†å¾®æœåŠ¡çš„èŒè´£å•ä¸€æ€§ï¼Œå› ä¸ºå¾®æœåŠ¡æœ¬èº«æ˜¯ä¸šåŠ¡æ¨¡å—ï¼Œå®ƒæœ¬ä¸åº”è¯¥æ‰¿æ‹…é…ç½®åˆ·æ–°çš„èŒè´£</li><li>ç ´åäº†å¾®æœåŠ¡å„èŠ‚ç‚¹çš„å¯¹ç­‰æ€§</li><li>æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå¾®æœåŠ¡åœ¨è¿ç§»æ—¶ï¼Œå®ƒçš„ç½‘ç»œåœ°å€å¸¸å¸¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶å¦‚æœæƒ³è¦åšåˆ°è‡ªåŠ¨åˆ·æ–°ï¼Œé‚£å°±å¥½å¢åŠ æ›´å¤šçš„ä¿®æ”¹</li></ul><h3 id="_4-springcloud-busåŠ¨æ€åˆ·æ–°-å®šç‚¹é€šçŸ¥" tabindex="-1"><a class="header-anchor" href="#_4-springcloud-busåŠ¨æ€åˆ·æ–°-å®šç‚¹é€šçŸ¥" aria-hidden="true">#</a> 4. SpringCloud BusåŠ¨æ€åˆ·æ–°==å®šç‚¹é€šçŸ¥==</h3><h4 id="_1-å®šç‚¹é€šçŸ¥" tabindex="-1"><a class="header-anchor" href="#_1-å®šç‚¹é€šçŸ¥" aria-hidden="true">#</a> 1. ==å®šç‚¹é€šçŸ¥==</h4><ul><li>å¦‚æœç°åœ¨ä¸æƒ³å…¨éƒ¨é€šçŸ¥ï¼Œåªå®šå‘é€šçŸ¥,åªé€šçŸ¥ä¸€ä¸ª,å…¶ä½™ä¸é€šçŸ¥</li></ul><h4 id="_2-è§£å†³-3" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³-3" aria-hidden="true">#</a> <strong>2. è§£å†³</strong>ï¼š</h4><ol><li>æŒ‡å®šå…·ä½“æŸä¸€ä¸ªå®ä¾‹ç”Ÿæ•ˆè€Œä¸æ˜¯å…¨éƒ¨</li><li>å…¬å¼ï¼šhttp://localhost:é…ç½®ä¸­å¿ƒç«¯å£å·/actuator/bus-refresh/{destination}</li><li>/bus/refreshè¯·æ±‚ä¸å†å‘é€åˆ°å…·ä½“çš„æœåŠ¡å®ä¾‹ä¸Šï¼Œè€Œæ˜¯å‘ç»™ config serverå¹¶é€šè¿‡destinationå‚æ•°ç±»æŒ‡å®šéœ€è¦æ›´æ–°é…ç½®çš„æœåŠ¡æˆ–å®ä¾‹</li></ol><h4 id="_3-æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_3-æ¡ˆä¾‹" aria-hidden="true">#</a> 3. æ¡ˆä¾‹</h4><ol><li><p>åˆ·æ–°è¿è¡Œåœ¨3355ç«¯å£ä¸Šçš„config-clientä¸ºä¾‹ï¼Œåªé€šçŸ¥3355ï¼Œä¸é€šçŸ¥3366?</p></li><li><p>å¤„ç†</p><ul><li><p>ç°åœ¨å†æ¥ä¿®æ”¹githubé…ç½®æ–‡ä»¶çš„versionï¼Œæ”¹ä¸º3</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160019.png" alt=""></p><p>3344å¯ä»¥è·å–æ•°æ®,3355/3366ä¸èƒ½è·å–å¤„ç†?</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160023.png" alt=""></p></li><li><p>æ‰§è¡Œ: curl -X POST &quot;http://localhost:3344/actuator/bus-refresh/config-client:3355&quot; 3355æ¥æ”¶æ•°æ®</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160028.png" alt=""></p></li><li><p>ç»“æœ</p><p>3355</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160035.png" alt=""></p></li></ul></li></ol><p>â€‹ 3366</p><p>â€‹ <img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160043.png" alt=""></p><h3 id="_5-busæ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_5-busæ€»ç»“" aria-hidden="true">#</a> 5 busæ€»ç»“</h3><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160049.png" alt=""></p><hr><h2 id="_10-springcloud-streamæ¶ˆæ¯é©±åŠ¨" tabindex="-1"><a class="header-anchor" href="#_10-springcloud-streamæ¶ˆæ¯é©±åŠ¨" aria-hidden="true">#</a> 10. SpringCloud Streamæ¶ˆæ¯é©±åŠ¨</h2><h3 id="_1-æ¦‚è¿°-8" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°-8" aria-hidden="true">#</a> 1. æ¦‚è¿°</h3><h4 id="_1-ç®€ä»‹-å®˜ç½‘" tabindex="-1"><a class="header-anchor" href="#_1-ç®€ä»‹-å®˜ç½‘" aria-hidden="true">#</a> 1. ç®€ä»‹ <a href="https://spring.io/projects/spring-cloud-stream#overview" target="_blank" rel="noopener noreferrer">å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h4><ul><li>å¦‚æœç³»ç»Ÿé‡ŒåŒæ—¶å­˜åœ¨å¤šç§MQï¼Œå¯ä»¥ä½¿ç”¨ä½¿ç”¨Cloud Streamï¼Œåªéœ€è¦å’ŒStreamäº¤äº’å°±å¯ä»¥è¿›è¡Œç®¡ç†ã€‚</li><li>ä¸€å¥è¯ï¼Œ==<strong>å±è”½åº•å±‚æ¶ˆæ¯ä¸­é—´ä»¶çš„å·®å¼‚</strong>ï¼Œ<strong>é™ä½åˆ‡æ¢æˆæœ¬</strong>ï¼Œç»Ÿä¸€æ¶ˆæ¯çš„ç¼–ç¨‹æ¨¡å‹==</li></ul><h4 id="_2-ä¸­æ–‡æ‰‹å†Œ" tabindex="-1"><a class="header-anchor" href="#_2-ä¸­æ–‡æ‰‹å†Œ" aria-hidden="true">#</a> 2. ä¸­æ–‡æ‰‹å†Œï¼š</h4><p>å®˜æ–¹å®šä¹‰SpringCloud Streamæ˜¯ä¸€ä¸ªæ„å»º<strong>æ¶ˆæ¯é©±åŠ¨å¾®æœåŠ¡çš„æ¡†æ¶</strong></p><p>åº”ç”¨ç¨‹åºé€šè¿‡inputs æˆ–è€… outputs æ¥ä¸SpringCloud Streamä¸­binderå¯¹è±¡äº¤äº’ã€‚é€šè¿‡æˆ‘ä»¬é…ç½®æ¥<strong>bindingï¼ˆç»‘å®šï¼‰</strong>ï¼Œè€ŒSpringCloud Streamçš„==<strong>binderå¯¹è±¡</strong>==è´Ÿè´£ä¸æ¶ˆæ¯ä¸­é—´ä»¶äº¤äº’ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦ææ¸…æ¥šå¦‚ä½•ä¸SpringCloud Streamäº¤äº’å°±å¯ä»¥æ–¹ä¾¿ä½¿ç”¨æ¶ˆæ¯é©±åŠ¨çš„æ–¹å¼ã€‚</p><p>é€šè¿‡ä½¿ç”¨Spring Integrationæ¥è¿æ¥æ¶ˆæ¯ä»£ç†ä¸­é—´ä»¶ä»¥å®ç°æ¶ˆæ¯æ—¶é—´é©±åŠ¨ SpringCloud Stream ä¸ºä¸€äº›ä¾›åº”å•†çš„æ¶ˆæ¯ä¸­é—´ä»¶äº§å“æä¾›äº†ä¸ªæ€§åŒ–çš„è‡ªåŠ¨åŒ–é…ç½®å®ç°ï¼Œå¼•ç”¨äº†å‘å¸ƒ-è®¢é˜…ã€æ¶ˆè´¹ç»„ã€åˆ†åŒºçš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚</p><p>==ç›®å‰åªæ”¯æŒRabbitMQã€Kafka==</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160056.png" alt=""></p><h3 id="_2-è®¾è®¡æ€æƒ³åŠç†å¿µ" tabindex="-1"><a class="header-anchor" href="#_2-è®¾è®¡æ€æƒ³åŠç†å¿µ" aria-hidden="true">#</a> 2.è®¾è®¡æ€æƒ³åŠç†å¿µ</h3><h4 id="_1-mq" tabindex="-1"><a class="header-anchor" href="#_1-mq" aria-hidden="true">#</a> 1 MQ</h4><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160100.png" alt=""></p><ol><li>ç”Ÿäº§è€…/æ¶ˆè´¹è€…ä¹‹é—´é ==æ¶ˆæ¯==åª’ä»‹ä¼ é€’ä¿¡æ¯ ------ Message</li><li>æ¶ˆæ¯å¿…é¡»èµ°ç‰¹å®šçš„==é€šé“== ------ æ¶ˆæ¯é€šé“ MessageChannel</li><li>æ¶ˆæ¯é€šé“é‡Œçš„æ¶ˆæ¯å¦‚ä½•è¢«æ¶ˆè´¹å‘¢?è°è´Ÿè´£æ”¶å‘==å¤„ç†== ----- æ¶ˆæ¯é€šé“ MessageChannel çš„è‡ªå·±æ‰£ SubScribableChannel,æœ‰ MessageChannel æ¶ˆæ¯å¤„ç†å™¨æ‰€è®¢é˜….</li></ol><p>æ¯”æ–¹è¯´æˆ‘ä»¬ç”¨åˆ°äº†RabbitMQå’ŒKafkaï¼Œç”±äºè¿™ä¸¤ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶çš„æ¶æ„ä¸Šçš„ä¸åŒï¼ŒåƒRabbitMQæœ‰exchangeï¼ŒKafkaæœ‰Topicå’ŒPartitionåˆ†åŒº</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160111.png" alt=""></p><p>è¿™äº›æ¶ˆæ¯ä¸­é—´ä»¶çš„å·®å¼‚æ€§å¯¼è‡´æˆ‘ä»¬å®é™…é¡¹ç›®å¼€å‘ç»™æˆ‘ä»¬é€ æˆäº†ä¸€å®šçš„å›°æ‰°ï¼Œæˆ‘ä»¬å¦‚æœç”¨äº†ä¸¤ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ä¸€ç§ï¼Œåé¢çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬æƒ³å¾€å¦ä¸€ç§æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè¿ç§»ï¼Œè¿™æ—¶å€™æ— ç–‘å°±æ˜¯ç¾éš¾æ€§çš„ï¼Œä¸€å¤§å †ä¸œè¥¿éƒ½è¦é‡æ–°æ¨å€’é‡æ–°åšï¼Œå› ä¸ºå®ƒè·Ÿæˆ‘ä»¬çš„ç³»ç»Ÿè€¦åˆäº†ï¼Œè¿™æ—¶å€™<strong>SpringCloud Streamç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§è§£è€¦åˆçš„æ–¹å¼</strong></p><h4 id="_2-å¦‚ä½•å®ç°" tabindex="-1"><a class="header-anchor" href="#_2-å¦‚ä½•å®ç°" aria-hidden="true">#</a> 2. å¦‚ä½•å®ç°?</h4><p>åœ¨æ²¡æœ‰ç»‘å®šå™¨è¿™ä¸ªæ¦‚å¿µçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„SpringBootåº”ç”¨è¦ç›´æ¥ä¸æ¶ˆæ¯ä¸­é—´ä»¶è¿›è¡Œä¿¡æ¯äº¤äº’çš„æ—¶å€™ï¼Œç”±äºå„æ¶ˆæ¯ä¸­é—´ä»¶æ„å»ºçš„åˆè¡·ä¸åŒï¼Œå®ƒä»¬çš„å®ç°ç»†èŠ‚ä¸Šä¼šæœ‰è¾ƒå¤§çš„å·®å¼‚æ€§ï¼Œé€šè¿‡å®šä¹‰ç»‘å®šå™¨ä½œä¸ºä¸­é—´å±‚ï¼Œå®Œç¾çš„å®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚é€šè¿‡å‘åº”ç”¨ç¨‹åºæš´éœ²ç»Ÿä¸€çš„channelé€šé“ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºä¸éœ€è¦å†è€ƒè™‘å„ç§ä¸åŒçš„æ¶ˆæ¯ä¸­é—´ä»¶å®ç°ã€‚</p><p>==é€šè¿‡å®šä¹‰ç»‘å®šå™¨Bindeä½œä¸ºä¸­é—´å±‚ï¼Œå®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚==</p><p>==Binderï¼šINPUTå¯¹åº”äºæ¶ˆè´¹è€…ï¼ŒOUTPUTå¯¹åº”äºç”Ÿäº§è€…==</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160124.png" alt=""></p><p>==Streamä¸­çš„æ¶ˆæ¯é€šä¿¡æ–¹å¼éµå¾ªäº†å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ŒTopicä¸»é¢˜è¿›è¡Œå¹¿æ’­ï¼ˆåœ¨RabbitMQå°±æ˜¯Exchangeï¼Œåœ¨Kafkaæ˜¯Topic)==</p><h3 id="_3-æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-æµç¨‹" aria-hidden="true">#</a> 3. æµç¨‹</h3><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160129.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160134.png" alt=""></p><ul><li><strong>Binder</strong>ï¼šå¾ˆæ–¹ä¾¿çš„è¿æ¥ä¸­é—´ä»¶ï¼Œå±è”½å·®å¼‚</li><li><strong>Channel</strong>ï¼šé€šé“ï¼Œæ˜¯é˜Ÿåˆ—Queueçš„ä¸€ç§æŠ½è±¡ï¼Œåœ¨æ¶ˆæ¯é€šè®¯ç³»ç»Ÿä¸­å°±æ˜¯å®ç°å­˜å‚¨å’Œè½¬å‘çš„åª’ä»‹ï¼Œé€šè¿‡Channelå¯¹é˜Ÿåˆ—è¿›è¡Œé…ç½®</li><li><strong>Sourceå’ŒSink</strong>ï¼šç®€å•çš„å¯ä»¥ç†è§£ä¸ºå‚ç…§å¯¹è±¡æ˜¯SpringCloud Streamè‡ªèº«ï¼Œä»Streamå‘å¸ƒæ¶ˆæ¯å°±æ˜¯è¾“å‡ºï¼Œæ¥æ”¶æ¶ˆæ¯å°±æ˜¯è¾“å…¥</li></ul><p><strong>ç¼–ç APIå’Œå¸¸ç”¨æ³¨è§£</strong></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160139.png" alt=""></p><h3 id="_4-æ¡ˆä¾‹-å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#_4-æ¡ˆä¾‹-å‚è€ƒ" aria-hidden="true">#</a> 4. æ¡ˆä¾‹ <a href="https://blog.csdn.net/qq_41211642/article/details/104921758" target="_blank" rel="noopener noreferrer">å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h3><h4 id="_1-ç”Ÿäº§è€…" tabindex="-1"><a class="header-anchor" href="#_1-ç”Ÿäº§è€…" aria-hidden="true">#</a> 1. ç”Ÿäº§è€…</h4><ul><li>ä¾èµ–</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--stream-rabbit--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-stream-rabbit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®æ–‡ä»¶</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8801</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>stream<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
      <span class="token key atrule">binders</span><span class="token punctuation">:</span>  <span class="token comment">#åœ¨æ­¤é…ç½®è¦ç»‘å®šçš„rabbitmqçš„æœåŠ¡ä¿¡æ¯</span>
        <span class="token key atrule">defaultRabbit</span><span class="token punctuation">:</span>  <span class="token comment">#è¡¨ç¤ºå®šä¹‰çš„åç§°ï¼Œç”¨äºbindingçš„æ•´åˆ</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> rabbit  <span class="token comment">#æ¶ˆæ¯ç»„ä»¶ç±»å‹</span>
          <span class="token key atrule">environment</span><span class="token punctuation">:</span>  <span class="token comment">#è®¾ç½®rabbitmqçš„ç›¸å…³ç¯å¢ƒé…ç½®</span>
            <span class="token key atrule">spring</span><span class="token punctuation">:</span>
              <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
                <span class="token key atrule">host</span><span class="token punctuation">:</span> 116.196.118.167
                <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
                <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
                <span class="token key atrule">password</span><span class="token punctuation">:</span> guest
      <span class="token key atrule">bindings</span><span class="token punctuation">:</span> <span class="token comment">#æœåŠ¡çš„æ•´åˆå¤„ç†</span>
        <span class="token key atrule">output</span><span class="token punctuation">:</span> <span class="token comment">#è¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªé€šé“çš„åç§°</span>
          <span class="token key atrule">destination</span><span class="token punctuation">:</span> studyExchange  <span class="token comment">#è¡¨ç¤ºè¦ä½¿ç”¨çš„Exchangeåç§°å®šä¹‰</span>
          <span class="token key atrule">content-type</span><span class="token punctuation">:</span> application/json  <span class="token comment">#è®¾ç½®æ¶ˆæ¯ç±»å‹ï¼Œæœ¬æ¬¡ä¸ºjsonï¼Œæ–‡æœ¬åˆ™è®¾ç½®â€œtext/plainâ€</span>
            <span class="token key atrule">binder</span><span class="token punctuation">:</span> defaultRabbit <span class="token comment">#è®¾ç½®è¦ç»‘å®šçš„æ¶ˆæ¯æœåŠ¡çš„å…·ä½“è®¾ç½®</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment">#å®¢æˆ·ç«¯è¿›è¡Œeurekaæ³¨å†Œçš„é…ç½®</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka/
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">2</span>  <span class="token comment">#è®¾ç½®å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼ˆé»˜è®¤æ˜¯30ç§’ï¼‰</span>
    <span class="token key atrule">lease-expiration-duration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment">#å¦‚æœç°åœ¨è¶…è¿‡äº†5ç§’çš„é—´éš”ï¼ˆé»˜è®¤æ˜¯90ç§’ï¼‰</span>
    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> send<span class="token punctuation">-</span>8801.com  <span class="token comment">#åœ¨ä¿¡æ¯åˆ—è¡¨æ—¶æ˜¾ç¤ºä¸»æœºåç§°</span>
    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>     <span class="token comment">#è®¿é—®çš„è·¯å¾„å˜ä¸ºIPåœ°å€</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¸šåŠ¡(å‘é€æ¶ˆæ¯)</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IMessageProvider</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * å‘é€æ¶ˆæ¯
     * <span class="token keyword">@return</span> message
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//è¿™ä¸æ˜¯ä¼ ç»Ÿçš„service,è¿™æ˜¯å’Œrabbitmqæ‰“äº¤é“çš„ï¼Œä¸éœ€è¦åŠ æ³¨è§£@Service</span>
<span class="token comment">//è¿™é‡Œä¸æ‰daoï¼Œå»æ‰æ¶ˆæ¯ä¸­é—´ä»¶çš„service</span>
<span class="token comment">//ä¿¡é“channelå’Œexchangeç»‘å®šåœ¨ä¸€èµ·</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">Source</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageProviderImpl</span> <span class="token keyword">implements</span> <span class="token class-name">IMessageProvider</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ¶ˆæ¯å‘é€ç®¡é“
     */</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">MessageChannel</span> output<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å‘é€æ¶ˆæ¯
     *
     * <span class="token keyword">@return</span> message
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> serial <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        output<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withPayload</span><span class="token punctuation">(</span>serial<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;******serial: &quot;</span> <span class="token operator">+</span> serial<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>controller</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SendMessageController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">IMessageProvider</span> iMessageProvider<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/sendMessage&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;*******sendMessage: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> iMessageProvider<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æµ‹è¯•</li></ul><p>http://localhost:8801/sendMessage</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160151.png" alt=""></p><h4 id="_2-æ¶ˆè´¹è€…-1" tabindex="-1"><a class="header-anchor" href="#_2-æ¶ˆè´¹è€…-1" aria-hidden="true">#</a> 2. æ¶ˆè´¹è€…</h4><ul><li>é…ç½®</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8802</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>stream<span class="token punctuation">-</span>consumer
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
      <span class="token key atrule">binders</span><span class="token punctuation">:</span> <span class="token comment"># åœ¨æ­¤å¤„é…ç½®è¦ç»‘å®šçš„rabbitMQçš„æœåŠ¡ä¿¡æ¯</span>
        <span class="token key atrule">defaultRabbit</span><span class="token punctuation">:</span> <span class="token comment"># è¡¨ç¤ºå®šä¹‰çš„åç§°ï¼Œç”¨äºbindingçš„æ•´åˆ</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> rabbit <span class="token comment"># æ¶ˆæ¯ä¸­é—´ä»¶ç±»å‹</span>
          <span class="token key atrule">environment</span><span class="token punctuation">:</span> <span class="token comment"># è®¾ç½®rabbitMQçš„ç›¸å…³ç¯å¢ƒé…ç½®</span>
            <span class="token key atrule">spring</span><span class="token punctuation">:</span>
              <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
                <span class="token key atrule">host</span><span class="token punctuation">:</span> 116.196.118.167
                <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
                <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
                <span class="token key atrule">password</span><span class="token punctuation">:</span> guest
      <span class="token key atrule">bindings</span><span class="token punctuation">:</span> <span class="token comment"># æœåŠ¡çš„æ•´åˆå¤„ç†</span>
        <span class="token key atrule">input</span><span class="token punctuation">:</span> <span class="token comment"># è¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªé€šé“çš„åç§°</span>
          <span class="token key atrule">destination</span><span class="token punctuation">:</span> studyExchange <span class="token comment"># è¡¨ç¤ºè¦ä½¿ç”¨çš„exchangeåç§°å®šä¹‰</span>
          <span class="token key atrule">content-type</span><span class="token punctuation">:</span> application/json <span class="token comment"># è®¾ç½®æ¶ˆæ¯ç±»å‹ï¼Œæœ¬æ¬¡ä¸ºjsonï¼Œæ–‡æœ¬åˆ™è®¾ä¸ºtext/plain</span>
          <span class="token key atrule">binder</span><span class="token punctuation">:</span> defaultRabbit <span class="token comment"># è®¾ç½®è¦ç»‘å®šçš„æ¶ˆæ¯æœåŠ¡çš„å…·ä½“è®¾ç½®</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment"># è®¾ç½®å¿ƒè·³çš„é—´éš”æ—¶é—´ï¼Œé»˜è®¤30</span>
    <span class="token key atrule">lease-expiration-duration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment"># è¶…è¿‡5ç§’é—´éš”ï¼Œé»˜è®¤90</span>
    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> receive<span class="token punctuation">-</span>8802.com <span class="token comment">#ä¸»æœºå</span>
    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># æ˜¾ç¤ºip</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>controller(æ¥å—æ¶ˆæ¯)</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiveMessageListenerController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${server.port}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ç›‘å¬ç”Ÿäº§è€…
     */</span>
    <span class="token annotation punctuation">@StreamListener</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span><span class="token constant">INPUT</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">input</span><span class="token punctuation">(</span><span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ¶ˆè´¹è€…1å·ï¼Œ-------&gt;æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t port: &quot;</span> <span class="token operator">+</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æµ‹è¯•</li></ul><p>http://localhost:8801/sendMessage 3æ¡</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160156.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160200.png" alt=""></p><h3 id="_5-åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#_5-åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–" aria-hidden="true">#</a> 5. åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–</h3><h4 id="_1-åˆ†ç»„æ¶ˆè´¹" tabindex="-1"><a class="header-anchor" href="#_1-åˆ†ç»„æ¶ˆè´¹" aria-hidden="true">#</a> 1. åˆ†ç»„æ¶ˆè´¹</h4><h5 id="_1-é—®é¢˜-3" tabindex="-1"><a class="header-anchor" href="#_1-é—®é¢˜-3" aria-hidden="true">#</a> 1. é—®é¢˜</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160206.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160210.png" alt=""></p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160215.png" alt=""></p><p>æ¯”å¦‚åœ¨å¦‚ä¸‹åœºæ™¯ä¸­ï¼Œè®¢å•ç³»ç»Ÿæˆ‘ä»¬åšé›†ç¾¤éƒ¨ç½²ï¼Œéƒ½ä¼šä»RabbitMQä¸­è·å–è®¢å•ä¿¡æ¯ï¼Œé‚£å¦‚æœ==ä¸€ä¸ªè®¢å•åŒæ—¶è¢«ä¸¤ä¸ªæœåŠ¡è·å–åˆ°==ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ•°æ®é”™è¯¯ï¼Œæˆ‘ä»¬å¾—é¿å…è¿™ç§æƒ…å†µï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨==<strong>Streamä¸­çš„æ¶ˆæ¯åˆ†ç»„</strong>==æ¥è§£å†³ã€‚</p><ul><li>æ³¨æ„åœ¨Streamä¸­å¤„äºåŒä¸€ä¸ªgroupä¸­çš„å¤šä¸ªæ¶ˆè´¹è€…æ˜¯ç«äº‰å…³ç³»ï¼Œå°±èƒ½å¤Ÿä¿è¯æ¶ˆæ¯åªä¼šè¢«å…¶ä¸­ä¸€ä¸ªåº”ç”¨æ¶ˆè´¹ä¸€æ¬¡ã€‚</li><li>==ä¸åŒç»„æ˜¯å¯ä»¥å…¨é¢æ¶ˆè´¹çš„ï¼ˆé‡å¤æ¶ˆè´¹ï¼‰ï¼ŒåŒä¸€ç»„å†…ä¼šå‘é€ç«äº‰å…³ç³»ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªå¯ä»¥æ¶ˆè´¹ã€‚==</li></ul><h5 id="_2-åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_2-åˆ†ç»„" aria-hidden="true">#</a> 2. åˆ†ç»„</h5><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160223.png" alt=""></p><h6 id="_1-åŸç†-1" tabindex="-1"><a class="header-anchor" href="#_1-åŸç†-1" aria-hidden="true">#</a> 1. åŸç†</h6><p>å¾®æœåŠ¡åº”ç”¨æ”¾ç½®äºåŒä¸€ä¸ªgroupä¸­,å°±èƒ½ä¿è¯æ¶ˆæ¯åªä¼šè¢«å…¶ä¸­ä¸€ä¸ªåº”ç”¨æ¶ˆè´¹ä¸€æ¬¡.==ä¸åŒçš„ç»„æ˜¯å¯ä»¥æ¶ˆè´¹çš„,åŒä¸€ä¸ªç»„å†…ä¼šå‘ç”Ÿç«äº‰å…³ç³»,åªæœ‰å…¶ä¸­ä¸€ä¸ªå¯ä»¥æ¶ˆè´¹.==</p><h6 id="_2-è§£å†³-4" tabindex="-1"><a class="header-anchor" href="#_2-è§£å†³-4" aria-hidden="true">#</a> 2. è§£å†³</h6><ol><li><p>8802/8803éƒ½å˜æˆ==ä¸åŒç»„==</p><p>8802: group: chggxA # åˆ†ç»„è§£å†³é‡å¤æ¶ˆè´¹</p><p>8803: group: chggxB # åˆ†ç»„è§£å†³é‡å¤æ¶ˆè´¹</p></li></ol><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160228.png" alt=""></p><ol start="2"><li>==ç›¸åŒç»„==</li></ol><ul><li>8803</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160235.png" alt=""></p><ul><li>8802</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160240.png" alt=""></p><ul><li><p>ç»“æœ</p><p>ç”Ÿäº§è€…</p></li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160246.png" alt=""></p><p>â€‹ æ¶ˆè´¹è€… 8802</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160250.png" alt=""></p><pre><code>	æ¶ˆè´¹è€… 8803
</code></pre><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160254.png" alt=""></p><h5 id="_3-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_3-æ€»ç»“" aria-hidden="true">#</a> 3. æ€»ç»“</h5><p>==åŒä¸€ä¸ªç»„ä¼šç«äº‰èµ„æºï¼Œè½®è¯¢ã€‚ä¸åŒç»„ä¼šé‡å¤æ¶ˆè´¹ã€‚==</p><h4 id="_1-æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-æŒä¹…åŒ–" aria-hidden="true">#</a> 1. æŒä¹…åŒ–</h4><p>å…³äºè‡ªå®šä¹‰åˆ†ç»„</p><p>å¦‚æœ8802å»æ‰åˆ†ç»„ï¼Œè€Œ8803ä¸å»æ‰ï¼Œå½“8802/8803éƒ½å…³é—­æœåŠ¡ï¼Œ8801è¿™æ—¶å€™å‘é€æ¶ˆæ¯ï¼Œ8802å†å¯åŠ¨çš„æ—¶å€™ä¸ä¼šé‡æ–°è·å¾—æœªæ›¾è·å¾—çš„æ¶ˆæ¯å¹¶æ¶ˆè´¹ï¼Œè€Œ8803é‡å¯åä¼šè·å¾—8801ä¹‹å‰å‘é€çš„æ¶ˆæ¯å¹¶æ¶ˆè´¹ã€‚</p><p>æ‰€ä»¥==groupåˆ†ç»„å±æ€§åœ¨æ¶ˆæ¯é‡å¤æ¶ˆè´¹å’Œæ¶ˆæ¯æŒä¹…åŒ–æ¶ˆè´¹ é¿å…æ¶ˆæ¯ä¸¢å¤±æ˜¯éå¸¸é‡è¦çš„å±æ€§==</p><p>å°±æ˜¯é»˜è®¤çš„åˆ†ç»„ä¸ä¼šä¿ç•™æœªæ›¾è·å¾—çš„æ¶ˆæ¯ï¼Œè‡ªå®šä¹‰çš„åˆ†ç»„ä¼šä¿ç•™</p><hr><h2 id="_11-springcloud-sleuth-åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" tabindex="-1"><a class="header-anchor" href="#_11-springcloud-sleuth-åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" aria-hidden="true">#</a> 11. SpringCloud Sleuth åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª</h2><h3 id="_1-æ¦‚å¿µ-å®˜ç½‘" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚å¿µ-å®˜ç½‘" aria-hidden="true">#</a> 1. æ¦‚å¿µ <a href="https://cloud.spring.io/spring-cloud-sleuth/reference/html/" target="_blank" rel="noopener noreferrer">å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h3><h4 id="_1-ä¸ºä»€ä¹ˆå‡ºç°-è§£å†³äº†" tabindex="-1"><a class="header-anchor" href="#_1-ä¸ºä»€ä¹ˆå‡ºç°-è§£å†³äº†" aria-hidden="true">#</a> 1. ä¸ºä»€ä¹ˆå‡ºç°? è§£å†³äº†?</h4><ul><li>é—®é¢˜</li></ul><p>åœ¨å¾®æœåŠ¡æ¡†æ¶ä¸­ï¼Œä¸€ä¸ªç”±å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚åœ¨åç«¯ç³»ç»Ÿä¸­ä¼šç»è¿‡å¤šä¸ªä¸åŒçš„æœåŠ¡èŠ‚ç‚¹è°ƒç”¨æ¥åè°ƒäº§ç”Ÿæœ€åçš„è¯·æ±‚ç»“æœï¼Œæ¯ä¸€ä¸ªå‰æ®µè¯·æ±‚éƒ½ä¼šå½¢æˆä¸€æ¡å¤æ‚çš„åˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨é“¾è·¯ï¼Œé“¾è·¯ä¸­çš„ä»»ä½•ä¸€ç¯å‡ºç°<strong>é«˜å»¶è¿Ÿ</strong>æˆ–<strong>é”™è¯¯</strong>éƒ½ä¼šå¼•èµ·æ•´ä¸ªè¯·æ±‚æœ€åçš„å¤±è´¥ã€‚</p><h4 id="_2-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 2. æ˜¯ä»€ä¹ˆ?</h4><ul><li><strong>SpringCloud Sleuth</strong>æä¾›äº†ä¸€å¥—å®Œæ•´çš„<strong>æœåŠ¡è·Ÿè¸ª</strong>çš„è§£å†³æ–¹æ¡ˆ</li><li>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æä¾›è¿½è¸ªè§£å†³æ–¹æ¡ˆå¹¶ä¸”å…¼å®¹æ”¯æŒäº†zipkin</li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160302.png" alt=""></p><ul><li>Sleuth è´Ÿè´£æ”¶é›†æ•´ç†ï¼ŒZipkinè´Ÿè´£å±•ç°ã€‚</li></ul><h3 id="_2-ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-ç¯å¢ƒæ­å»º" aria-hidden="true">#</a> 2. ç¯å¢ƒæ­å»º</h3><h4 id="_1-zipkin-ä¸‹è½½åœ°å€" tabindex="-1"><a class="header-anchor" href="#_1-zipkin-ä¸‹è½½åœ°å€" aria-hidden="true">#</a> 1. zipkin <a href="https://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/" target="_blank" rel="noopener noreferrer">ä¸‹è½½åœ°å€<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h4><p>SpringCloudä»Fç‰ˆèµ·å·²ä¸éœ€è¦è‡ªå·±æ„å»ºZipkin Serveräº†ï¼Œåªéœ€è°ƒç”¨jaråŒ…</p><p>å®‰è£…: java -jar zipkin-server-2.12.9-exec.jar</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160306.png" alt=""></p><p>è®¿é—®: http://localhost:9411/zipkin/</p><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160311.png" alt=""></p><h4 id="_2-æœåŠ¡æ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-æœåŠ¡æ­å»º" aria-hidden="true">#</a> 2. æœåŠ¡æ­å»º</h4><ul><li>ä¾èµ–</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--åŒ…å«äº†sleuth+zipkin åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ª--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zipkin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">zipkin</span><span class="token punctuation">:</span> <span class="token comment"># é…ç½®zipkin</span>
    <span class="token key atrule">base-url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">9411</span>
    <span class="token key atrule">sleuth</span><span class="token punctuation">:</span>
      <span class="token key atrule">simple</span><span class="token punctuation">:</span>
        <span class="token comment"># é‡‡æ ·ç‡ä»‹äº0~1ä¹‹é—´,1è¡¨ç¤ºå…¨éƒ¨é‡‡é›†</span>
        <span class="token key atrule">probability</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>controller</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * sleuthåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªæµ‹è¯•
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/zipkin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentZipkin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;hi, i am paymentZipkin server fall back.,welcome to chggx, O(âˆ©_âˆ©)Oå“ˆå“ˆ~&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>æµ‹è¯•</p><ol><li><p>è®¿é—®ä¸Šé¢åœ°å€</p><p>http://localhost/consumer/payment/zipkin</p></li><li><p>æŸ¥çœ‹<a href="http://localhost:9411/zipkin/" target="_blank" rel="noopener noreferrer">zipkin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ol></li></ul><p><img src="https://chggx-typora.oss-cn-beijing.aliyuncs.com/typora/20210223160317.png" alt=""></p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/chggx-knowlodge-vuepress/java/framework/springcloud/2.SpringCloud%20Alibaba%E4%BB%8B%E7%BB%8D.html" class="" aria-label="SpringCloud Alibaba å®˜ç½‘"><!--[--><!--]--> SpringCloud Alibaba å®˜ç½‘ <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/chggx-knowlodge-vuepress/assets/app.099ebd34.js" defer></script>
  </body>
</html>
